# -*- coding: UTF-8 -*-
####################################################################################################################
# Generated by Warband Module Decompiler
# All rights of the module belong to their respective owners
####################################################################################################################

from header_common import *
from header_music import *
from header_items import *
from header_presentations import *
from header_mission_templates import *
from ID_meshes import *
from header_operations import *
from header_triggers import *
from module_constants import *
import string

#COOP BEGIN#######################################
from module_coop_presentations import *
#COOP END###############################################

####################################################################################################################
#  Each presentation record contains the following fields:
#  1) Presentation id: used for referencing presentations in other files. The prefix prsnt_ is automatically added before each presentation id.
#  2) Presentation flags. See header_presentations.py for a list of available flags
#  3) Presentation background mesh: See module_meshes.py for a list of available background meshes
#  4) Triggers: Simple triggers that are associated with the presentation
####################################################################################################################

presentations = [
  ("game_credits", prsntf_read_only, mesh_load_window,
  [
    (ti_on_presentation_load,
    [
      (assign, "$g_presentation_credits_obj_1", -1),
      (assign, "$g_presentation_credits_obj_2", -1),
      (assign, "$g_presentation_credits_obj_3", -1),
      (assign, "$g_presentation_credits_obj_4", -1),
      (assign, "$g_presentation_credits_obj_5", -1),
      (assign, "$g_presentation_credits_obj_6", -1),
      (assign, "$g_presentation_credits_obj_7", -1),
      (assign, "$g_presentation_credits_obj_8", -1),
      (assign, "$g_presentation_credits_obj_9", -1),
      (assign, "$g_presentation_credits_obj_10", -1),
      (assign, "$g_presentation_credits_obj_11", -1),
      (assign, "$g_presentation_credits_obj_12", -1),
      (assign, "$g_presentation_credits_obj_1_alpha", 0),
      (assign, "$g_presentation_credits_obj_2_alpha", 0),
      (assign, "$g_presentation_credits_obj_3_alpha", 0),
      (assign, "$g_presentation_credits_obj_4_alpha", 0),
      (assign, "$g_presentation_credits_obj_5_alpha", 0),
      (assign, "$g_presentation_credits_obj_6_alpha", 0),
      (assign, "$g_presentation_credits_obj_7_alpha", 0),
      (assign, "$g_presentation_credits_obj_8_alpha", 0),
      (assign, "$g_presentation_credits_obj_9_alpha", 0),
    ]),
    (ti_on_presentation_run,
    [
      (store_trigger_param_1, ":var0"),
      (set_fixed_point_multiplier, 1000),
      (presentation_set_duration, 1000000),
      (music_set_situation, mtf_sit_fight),
      (play_track, "track_02_Elven_Oratory_Valar_Glory", 2),
      (try_begin),
        (this_or_next|key_clicked, key_space),
        (this_or_next|key_clicked, key_enter),
        (this_or_next|key_clicked, key_escape),
        (this_or_next|key_clicked, key_back_space),
        (this_or_next|key_clicked, key_left_mouse_button),
        (key_clicked, key_right_mouse_button),
        (presentation_set_duration, 0),
      (try_end),
      (try_begin),
        (lt, "$g_presentation_credits_obj_1", 0),
        (str_store_string, s1, "str_credits_1"),
        (create_text_overlay, "$g_presentation_credits_obj_1", s1, 6160),
        (overlay_set_color, "$g_presentation_credits_obj_1", 3224325),
        (overlay_set_alpha, "$g_presentation_credits_obj_1", 0x00),
        (position_set_x, pos1, 1500),
        (position_set_y, pos1, 1500),
        (overlay_set_size, "$g_presentation_credits_obj_1", pos1),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, 375),
        (overlay_set_position, "$g_presentation_credits_obj_1", pos1),
        (overlay_animate_to_alpha, "$g_presentation_credits_obj_1", 1000, 255),
      (else_try),
        (gt, ":var0", 10000),
        (eq, "$g_presentation_credits_obj_1_alpha", 0),
        (assign, "$g_presentation_credits_obj_1_alpha", 1),
        (overlay_animate_to_alpha, "$g_presentation_credits_obj_1", 1000, 0),
      (else_try),
        (gt, ":var0", 12000),
        (lt, "$g_presentation_credits_obj_2", 0),
        (str_store_string, s1, "str_credits_2"),
        (create_text_overlay, "$g_presentation_credits_obj_2", s1, 6160),
        (overlay_set_color, "$g_presentation_credits_obj_2", 1848095),
        (overlay_set_alpha, "$g_presentation_credits_obj_2", 0x00),
        (position_set_x, pos1, 1050),
        (position_set_y, pos1, 1050),
        (overlay_set_size, "$g_presentation_credits_obj_2", pos1),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, 375),
        (overlay_set_position, "$g_presentation_credits_obj_2", pos1),
        (overlay_animate_to_alpha, "$g_presentation_credits_obj_2", 1000, 255),
      (else_try),
        (gt, ":var0", 22000),
        (eq, "$g_presentation_credits_obj_2_alpha", 0),
        (assign, "$g_presentation_credits_obj_2_alpha", 1),
        (overlay_animate_to_alpha, "$g_presentation_credits_obj_2", 1000, 0),
      (else_try),
        (gt, ":var0", 24000),
        (lt, "$g_presentation_credits_obj_3", 0),
        (str_store_string, s1, "str_credits_3"),
        (create_text_overlay, "$g_presentation_credits_obj_3", s1, 6160),
        (overlay_set_color, "$g_presentation_credits_obj_3", 1451545),
        (overlay_set_alpha, "$g_presentation_credits_obj_3", 0x00),
        (position_set_x, pos1, 1050),
        (position_set_y, pos1, 1050),
        (overlay_set_size, "$g_presentation_credits_obj_3", pos1),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, 375),
        (overlay_set_position, "$g_presentation_credits_obj_3", pos1),
        (overlay_animate_to_alpha, "$g_presentation_credits_obj_3", 1000, 255),
      (else_try),
        (gt, ":var0", 34000),
        (eq, "$g_presentation_credits_obj_3_alpha", 0),
        (assign, "$g_presentation_credits_obj_3_alpha", 1),
        (overlay_animate_to_alpha, "$g_presentation_credits_obj_3", 1000, 0),
      (else_try),
        (gt, ":var0", 36000),
        (lt, "$g_presentation_credits_obj_4", 0),
        (str_store_string, s1, "str_credits_4"),
        (create_text_overlay, "$g_presentation_credits_obj_4", s1, 6160),
        (overlay_set_color, "$g_presentation_credits_obj_4", 0),
        (overlay_set_alpha, "$g_presentation_credits_obj_4", 0x00),
        (position_set_x, pos1, 1050),
        (position_set_y, pos1, 1050),
        (overlay_set_size, "$g_presentation_credits_obj_4", pos1),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, 375),
        (overlay_set_position, "$g_presentation_credits_obj_4", pos1),
        (overlay_animate_to_alpha, "$g_presentation_credits_obj_4", 1000, 255),
      (else_try),
        (gt, ":var0", 46000),
        (eq, "$g_presentation_credits_obj_4_alpha", 0),
        (assign, "$g_presentation_credits_obj_4_alpha", 1),
        (overlay_animate_to_alpha, "$g_presentation_credits_obj_4", 1000, 0),
      (else_try),
        (gt, ":var0", 48000),
        (lt, "$g_presentation_credits_obj_5", 0),
        (str_store_string, s1, "str_credits_5"),
        (create_text_overlay, "$g_presentation_credits_obj_5", s1, 6160),
        (overlay_set_color, "$g_presentation_credits_obj_5", 0),
        (overlay_set_alpha, "$g_presentation_credits_obj_5", 0x00),
        (position_set_x, pos1, 1050),
        (position_set_y, pos1, 1050),
        (overlay_set_size, "$g_presentation_credits_obj_5", pos1),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, 375),
        (overlay_set_position, "$g_presentation_credits_obj_5", pos1),
        (overlay_animate_to_alpha, "$g_presentation_credits_obj_5", 1000, 255),
      (else_try),
        (gt, ":var0", 58000),
        (eq, "$g_presentation_credits_obj_5_alpha", 0),
        (assign, "$g_presentation_credits_obj_5_alpha", 1),
        (overlay_animate_to_alpha, "$g_presentation_credits_obj_5", 1000, 0),
      (else_try),
        (gt, ":var0", 60000),
        (lt, "$g_presentation_credits_obj_6", 0),
        (str_store_string, s1, "str_credits_6"),
        (create_text_overlay, "$g_presentation_credits_obj_6", s1, 6160),
        (overlay_set_color, "$g_presentation_credits_obj_6", 0),
        (overlay_set_alpha, "$g_presentation_credits_obj_6", 0x00),
        (position_set_x, pos1, 1050),
        (position_set_y, pos1, 1050),
        (overlay_set_size, "$g_presentation_credits_obj_6", pos1),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, 375),
        (overlay_set_position, "$g_presentation_credits_obj_6", pos1),
        (overlay_animate_to_alpha, "$g_presentation_credits_obj_6", 1000, 255),
      (else_try),
        (gt, ":var0", 70000),
        (eq, "$g_presentation_credits_obj_6_alpha", 0),
        (assign, "$g_presentation_credits_obj_6_alpha", 1),
        (overlay_animate_to_alpha, "$g_presentation_credits_obj_6", 1000, 0),
      (else_try),
        (gt, ":var0", 72000),
        (lt, "$g_presentation_credits_obj_7", 0),
        (str_store_string, s1, "str_credits_7"),
        (create_text_overlay, "$g_presentation_credits_obj_7", s1, 6160),
        (overlay_set_color, "$g_presentation_credits_obj_7", 1848095),
        (overlay_set_alpha, "$g_presentation_credits_obj_7", 0x00),
        (position_set_x, pos1, 1050),
        (position_set_y, pos1, 1050),
        (overlay_set_size, "$g_presentation_credits_obj_7", pos1),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, 375),
        (overlay_set_position, "$g_presentation_credits_obj_7", pos1),
        (overlay_animate_to_alpha, "$g_presentation_credits_obj_7", 1000, 255),
      (else_try),
        (gt, ":var0", 82000),
        (eq, "$g_presentation_credits_obj_7_alpha", 0),
        (assign, "$g_presentation_credits_obj_7_alpha", 1),
        (overlay_animate_to_alpha, "$g_presentation_credits_obj_7", 1000, 0),
      (else_try),
        (gt, ":var0", 84000),
        (lt, "$g_presentation_credits_obj_8", 0),
        (str_store_string, s1, "str_credits_8"),
        (create_text_overlay, "$g_presentation_credits_obj_8", s1, 6160),
        (overlay_set_color, "$g_presentation_credits_obj_8", 0),
        (overlay_set_alpha, "$g_presentation_credits_obj_8", 0x00),
        (position_set_x, pos1, 1050),
        (position_set_y, pos1, 1050),
        (overlay_set_size, "$g_presentation_credits_obj_8", pos1),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, 375),
        (overlay_set_position, "$g_presentation_credits_obj_8", pos1),
        (overlay_animate_to_alpha, "$g_presentation_credits_obj_8", 1000, 255),
      (else_try),
        (gt, ":var0", 94000),
        (eq, "$g_presentation_credits_obj_8_alpha", 0),
        (assign, "$g_presentation_credits_obj_8_alpha", 1),
        (overlay_animate_to_alpha, "$g_presentation_credits_obj_8", 1000, 0),
      (else_try),
        (gt, ":var0", 96000),
        (lt, "$g_presentation_credits_obj_9", 0),
        (str_store_string, s1, "str_credits_10"),
        (create_text_overlay, "$g_presentation_credits_obj_9", s1, 6160),
        (overlay_set_color, "$g_presentation_credits_obj_9", 0),
        (overlay_set_alpha, "$g_presentation_credits_obj_9", 0x00),
        (position_set_x, pos1, 750),
        (position_set_y, pos1, 750),
        (overlay_set_size, "$g_presentation_credits_obj_9", pos1),
        (position_set_x, pos1, 250),
        (position_set_y, pos1, 485),
        (overlay_set_position, "$g_presentation_credits_obj_9", pos1),
        (overlay_animate_to_alpha, "$g_presentation_credits_obj_9", 1000, 255),
        (str_store_string, s1, "str_credits_11"),
        (create_text_overlay, "$g_presentation_credits_obj_10", s1, 6160),
        (overlay_set_color, "$g_presentation_credits_obj_10", 0),
        (overlay_set_alpha, "$g_presentation_credits_obj_10", 0x00),
        (position_set_x, pos1, 750),
        (position_set_y, pos1, 750),
        (overlay_set_size, "$g_presentation_credits_obj_10", pos1),
        (position_set_x, pos1, 750),
        (position_set_y, pos1, 470),
        (overlay_set_position, "$g_presentation_credits_obj_10", pos1),
        (overlay_animate_to_alpha, "$g_presentation_credits_obj_10", 1000, 255),
        (str_store_string, s1, "str_credits_12"),
        (create_text_overlay, "$g_presentation_credits_obj_11", s1, 6160),
        (overlay_set_color, "$g_presentation_credits_obj_11", 0),
        (overlay_set_alpha, "$g_presentation_credits_obj_11", 0x00),
        (position_set_x, pos1, 750),
        (position_set_y, pos1, 750),
        (overlay_set_size, "$g_presentation_credits_obj_11", pos1),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, 105),
        (overlay_set_position, "$g_presentation_credits_obj_11", pos1),
        (overlay_animate_to_alpha, "$g_presentation_credits_obj_11", 1000, 255),
      (else_try),
        (gt, ":var0", 106000),
        (eq, "$g_presentation_credits_obj_9_alpha", 0),
        (assign, "$g_presentation_credits_obj_9_alpha", 1),
        (overlay_animate_to_alpha, "$g_presentation_credits_obj_9", 1000, 0),
        (overlay_animate_to_alpha, "$g_presentation_credits_obj_10", 1000, 0),
        (overlay_animate_to_alpha, "$g_presentation_credits_obj_11", 1000, 0),
      (else_try),
        (gt, ":var0", 107000),
        (lt, "$g_presentation_credits_obj_12", 0),
        (str_store_string, s1, "str_credits_9"),
        (create_text_overlay, "$g_presentation_credits_obj_12", s1, 2064),
        (overlay_set_color, "$g_presentation_credits_obj_12", 0),
        (overlay_set_alpha, "$g_presentation_credits_obj_12", 0xFF),
        (position_set_x, pos1, 950),
        (position_set_y, pos1, 950),
        (overlay_set_size, "$g_presentation_credits_obj_12", pos1),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, -4800),
        (overlay_set_position, "$g_presentation_credits_obj_12", pos1),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, 760),
        (overlay_animate_to_position, "$g_presentation_credits_obj_12", 70000, pos1),
      (else_try),
        (gt, ":var0", 262500),
        (presentation_set_duration, 0),
      (try_end),
    ]),
  ]),

  ("game_profile_banner_selection", 0, mesh_load_window,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (str_store_string, s1, "str_profile_banner_selection_text"),
      (create_text_overlay, reg1, s1, 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 600),
      (overlay_set_position, reg1, pos1),
      (overlay_set_text, reg1, s1),
      (create_button_overlay, "$g_presentation_obj_profile_banner_selection_1", "@Next Page", 16),
      (position_set_x, pos1, 700),
      (position_set_y, pos1, 50),
      (overlay_set_position, "$g_presentation_obj_profile_banner_selection_1", pos1),
      (create_button_overlay, "$g_presentation_obj_profile_banner_selection_2", "str_use_default_banner", 16),
      (position_set_x, pos1, 300),
      (position_set_y, pos1, 50),
      (overlay_set_position, "$g_presentation_obj_profile_banner_selection_2", pos1),
      (assign, ":var0", 150),
      (assign, ":var1", 575),
      (store_mul, ":var2", 16, "$g_presentation_page_no"),
      (store_add, ":var3", ":var2", 16),
      (store_add, "$g_presentation_banner_start", "$g_presentation_obj_profile_banner_selection_2", 1),
      (assign, ":var4", 0),
      (try_for_range, ":var5", "mesh_banner_a01", "mesh_banner_f21"),
        (assign, ":var6", 0),
        (try_for_range, ":var7", "fac_kingdom_1", "fac_kingdoms_end"),
          (faction_slot_eq, ":var7", 15, ":var5"),
          (assign, ":var6", 1),
        (try_end),
        (eq, ":var6", 0),
        (val_add, ":var4", 1),
        (gt, ":var4", ":var2"),
        (le, ":var4", ":var3"),
        (create_image_button_overlay, reg1, ":var5", ":var5"),
        (position_set_x, pos1, ":var0"),
        (position_set_y, pos1, ":var1"),
        (overlay_set_position, reg1, pos1),
        (position_set_x, pos1, 100),
        (position_set_y, pos1, 100),
        (overlay_set_size, reg1, pos1),
        (val_add, ":var0", 100),
        (ge, ":var0", 900),
        (assign, ":var0", 150),
        (val_sub, ":var1", 250),
      (try_end),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (try_begin),
        (eq, ":var0", "$g_presentation_obj_profile_banner_selection_1"),
        (val_add, "$g_presentation_page_no", 1),
        (val_mod, "$g_presentation_page_no", 8),
        (presentation_set_duration, 0),
        (start_presentation, "prsnt_game_profile_banner_selection"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_profile_banner_selection_2"),
        (351, -1),
        (presentation_set_duration, 0),
      (else_try),
        (store_sub, ":var1", ":var0", "$g_presentation_banner_start"),
        (store_mul, ":var2", 16, "$g_presentation_page_no"),
        (val_add, ":var1", ":var2"),
        (assign, ":var3", 0),
        (assign, ":var4", "mesh_banner_f21"),
        (try_for_range, ":var5", "mesh_banner_a01", ":var4"),
          (assign, ":var6", 0),
          (try_for_range, ":var7", "fac_kingdom_1", "fac_kingdoms_end"),
            (faction_slot_eq, ":var7", 15, ":var5"),
            (assign, ":var6", 1),
          (try_end),
          (eq, ":var6", 0),
          (try_begin),
            (eq, ":var1", ":var3"),
            (store_sub, ":var8", ":var5", "mesh_banner_a01"),
            (351, ":var8"),
            (assign, ":var4", 0),
          (try_end),
          (val_add, ":var3", 1),
        (try_end),
        (presentation_set_duration, 0),
      (try_end),
    ]),
  ]),

  ("game_custom_battle_designer", prsntf_manual_end_only, mesh_cb_ui_main,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (create_text_overlay, reg0, "str_player", 98320),
      (overlay_set_color, reg0, 4294967295),
      (position_set_x, pos1, 1500),
      (position_set_y, pos1, 1500),
      (overlay_set_size, reg0, pos1),
      (position_set_x, pos1, 175),
      (position_set_y, pos1, 700),
      (overlay_set_position, reg0, pos1),
      (create_text_overlay, reg0, "str_enemy", 98320),
      (overlay_set_color, reg0, 4294967295),
      (position_set_x, pos1, 1500),
      (position_set_y, pos1, 1500),
      (overlay_set_size, reg0, pos1),
      (position_set_x, pos1, 820),
      (position_set_y, pos1, 700),
      (overlay_set_position, reg0, pos1),
      (create_text_overlay, reg0, "str_character", 16),
      (position_set_x, pos1, 175),
      (position_set_y, pos1, 670),
      (overlay_set_position, reg0, pos1),
      (948, "$g_presentation_obj_custom_battle_designer_18"),
      (position_set_x, pos1, 800),
      (position_set_y, pos1, 800),
      (overlay_set_size, "$g_presentation_obj_custom_battle_designer_18", pos1),
      (position_set_x, pos1, 175),
      (position_set_y, pos1, 635),
      (overlay_set_position, "$g_presentation_obj_custom_battle_designer_18", pos1),
      (try_for_range, ":var0", "trp_quick_battle_troop_1", "trp_quick_battle_troops_end"),
        (str_store_troop_name, s0, ":var0"),
        (overlay_add_item, "$g_presentation_obj_custom_battle_designer_18", s0),
      (try_end),
      (store_sub, ":var0", "$g_quick_battle_troop", "trp_quick_battle_troop_1"),
      (overlay_set_val, "$g_presentation_obj_custom_battle_designer_18", ":var0"),
      (store_mul, ":var0", "$g_quick_battle_troop", 2),
      (create_mesh_overlay_with_tableau_material, reg0, -1, "tableau_game_party_window", ":var0"),
      (position_set_x, pos1, 25),
      (position_set_y, pos1, 370),
      (overlay_set_position, reg0, pos1),
      (try_begin),
        (eq, "$g_quick_battle_team_2_faction", "fac_kingdom_1"),
        (assign, ":var0", "trp_sarleon_knight"),
      (else_try),
        (eq, "$g_quick_battle_team_2_faction", "fac_kingdom_2"),
        (assign, ":var0", "trp_rav_knight"),
      (else_try),
        (eq, "$g_quick_battle_team_2_faction", "fac_kingdom_3"),
        (assign, ":var0", "trp_dshar_noble_cavalry"),
      (else_try),
        (eq, "$g_quick_battle_team_2_faction", "fac_kingdom_4"),
        (assign, ":var0", "trp_fierd_huscarl"),
      (else_try),
        (eq, "$g_quick_battle_team_2_faction", "fac_kingdom_5"),
        (assign, ":var0", "trp_empire_knight"),
      (else_try),
        (assign, ":var0", "trp_vanskerry_marauder"),
      (try_end),
      (val_mul, ":var0", 2),
      (create_mesh_overlay_with_tableau_material, reg0, -1, "tableau_game_party_window", ":var0"),
      (position_set_x, pos1, 670),
      (position_set_y, pos1, 370),
      (overlay_set_position, reg0, pos1),
      (create_text_overlay, reg0, "str_biography", 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 700),
      (overlay_set_position, reg0, pos1),
      (store_sub, ":var1", "$g_quick_battle_troop", "trp_quick_battle_troop_1"),
      (val_add, ":var1", "str_quick_battle_troop_1"),
      (create_text_overlay, reg0, ":var1", 8192),
      (position_set_x, pos1, 850),
      (position_set_y, pos1, 850),
      (overlay_set_size, reg0, pos1),
      (position_set_x, pos1, 320),
      (position_set_y, pos1, 560),
      (overlay_set_position, reg0, pos1),
      (position_set_x, pos1, 360),
      (position_set_y, pos1, 130),
      (overlay_set_area_size, reg0, pos1),
      (create_text_overlay, reg0, "str_map_basic", 16),
      (overlay_set_color, reg0, 16777215),
      (position_set_x, pos1, 1500),
      (position_set_y, pos1, 1500),
      (overlay_set_size, reg0, pos1),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 450),
      (overlay_set_position, reg0, pos1),
      (948, "$g_presentation_obj_custom_battle_designer_1"),
      (position_set_x, pos1, 700),
      (position_set_y, pos1, 700),
      (overlay_set_size, "$g_presentation_obj_custom_battle_designer_1", pos1),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 415),
      (overlay_set_position, "$g_presentation_obj_custom_battle_designer_1", pos1),
      (try_begin),
        (eq, "$g_quick_battle_game_type", 0),
        (try_for_range, ":var2", "scn_quick_battle_scene_1", "scn_quick_battle_scene_4"),
          (store_sub, ":var3", ":var2", "scn_quick_battle_scene_1"),
          (val_add, ":var3", "str_quick_battle_scene_1"),
          (overlay_add_item, "$g_presentation_obj_custom_battle_designer_1", ":var3"),
        (try_end),
        (try_begin),
          (is_between, "$g_quick_battle_map", "scn_quick_battle_scene_1", "scn_quick_battle_scene_4"),
          (store_sub, ":var4", "$g_quick_battle_map", "scn_quick_battle_scene_1"),
          (overlay_set_val, "$g_presentation_obj_custom_battle_designer_1", ":var4"),
        (else_try),
          (overlay_set_val, "$g_presentation_obj_custom_battle_designer_1", 0),
          (assign, "$g_quick_battle_map", "scn_quick_battle_scene_1"),
        (try_end),
      (else_try),
        (try_for_range, ":var2", "scn_quick_battle_scene_4", "scn_quick_battle_maps_end"),
          (store_sub, ":var3", ":var2", "scn_quick_battle_scene_1"),
          (val_add, ":var3", "str_quick_battle_scene_1"),
          (overlay_add_item, "$g_presentation_obj_custom_battle_designer_1", ":var3"),
        (try_end),
        (try_begin),
          (is_between, "$g_quick_battle_map", "scn_quick_battle_scene_4", "scn_quick_battle_maps_end"),
          (store_sub, ":var4", "$g_quick_battle_map", "scn_quick_battle_scene_4"),
          (overlay_set_val, "$g_presentation_obj_custom_battle_designer_1", ":var4"),
        (else_try),
          (overlay_set_val, "$g_presentation_obj_custom_battle_designer_1", 0),
          (assign, "$g_quick_battle_map", "scn_quick_battle_scene_4"),
        (try_end),
      (try_end),
      (store_sub, ":var5", "$g_quick_battle_map", "scn_quick_battle_scene_1"),
      (val_add, ":var5", "mesh_cb_ui_maps_scene_01"),
      (create_mesh_overlay, reg0, ":var5"),
      (position_set_x, pos1, 700),
      (position_set_y, pos1, 700),
      (overlay_set_size, reg0, pos1),
      (position_set_x, pos1, 380),
      (position_set_y, pos1, 220),
      (overlay_set_position, reg0, pos1),
      (create_text_overlay, reg0, "str_game_type_basic", 16),
      (overlay_set_color, reg0, 16777215),
      (position_set_x, pos1, 1500),
      (position_set_y, pos1, 1500),
      (overlay_set_size, reg0, pos1),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 180),
      (overlay_set_position, reg0, pos1),
      (948, "$g_presentation_obj_custom_battle_designer_23"),
      (position_set_x, pos1, 700),
      (position_set_y, pos1, 700),
      (overlay_set_size, "$g_presentation_obj_custom_battle_designer_23", pos1),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 150),
      (overlay_set_position, "$g_presentation_obj_custom_battle_designer_23", pos1),
      (overlay_add_item, "$g_presentation_obj_custom_battle_designer_23", "str_battle"),
      (overlay_add_item, "$g_presentation_obj_custom_battle_designer_23", "str_siege_offense"),
      (overlay_add_item, "$g_presentation_obj_custom_battle_designer_23", "str_siege_defense"),
      (overlay_set_val, "$g_presentation_obj_custom_battle_designer_23", "$g_quick_battle_game_type"),
      (create_game_button_overlay, "$g_presentation_obj_custom_battle_designer_24", "str_randomize"),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 60),
      (overlay_set_position, "$g_presentation_obj_custom_battle_designer_24", pos1),
      (assign, ":var6", 330),
      (assign, ":var6", 350),
      (assign, ":var7", 40),
      (create_text_overlay, reg0, "str_faction", 16),
      (position_set_x, pos1, 175),
      (position_set_y, pos1, ":var6"),
      (overlay_set_position, reg0, pos1),
      (create_text_overlay, reg0, "str_faction", 16),
      (position_set_x, pos1, 820),
      (position_set_y, pos1, ":var6"),
      (overlay_set_position, reg0, pos1),
      (val_sub, ":var6", ":var7"),
      (948, "$g_presentation_obj_custom_battle_designer_4"),
      (position_set_x, pos1, 175),
      (position_set_y, pos1, ":var6"),
      (overlay_set_position, "$g_presentation_obj_custom_battle_designer_4", pos1),
      (try_begin),
        (250),
        (str_store_faction_name, s0, "fac_kingdom_1"),
        (overlay_add_item, "$g_presentation_obj_custom_battle_designer_4", s0),
        (store_add, ":var8", "fac_kingdom_1", 1),
        (str_store_faction_name, s0, ":var8"),
        (overlay_add_item, "$g_presentation_obj_custom_battle_designer_4", s0),
      (else_try),
        (try_for_range, ":var8", "fac_kingdom_1", "fac_kingdoms_end"),
          (str_store_faction_name, s0, ":var8"),
          (overlay_add_item, "$g_presentation_obj_custom_battle_designer_4", s0),
        (try_end),
        (str_store_faction_name, s0, "fac_outlaws"),
        (overlay_add_item, "$g_presentation_obj_custom_battle_designer_4", s0),
      (try_end),
      (try_begin),
        (eq, "$g_quick_battle_team_1_faction", "fac_outlaws"),
        (store_sub, ":var9", "fac_kingdoms_end", "fac_kingdom_1"),
        (overlay_set_val, "$g_presentation_obj_custom_battle_designer_4", ":var9"),
      (else_try),
        (store_sub, ":var10", "$g_quick_battle_team_1_faction", "fac_kingdom_1"),
        (overlay_set_val, "$g_presentation_obj_custom_battle_designer_4", ":var10"),
      (try_end),
      (948, "$g_presentation_obj_custom_battle_designer_5"),
      (position_set_x, pos1, 820),
      (position_set_y, pos1, ":var6"),
      (overlay_set_position, "$g_presentation_obj_custom_battle_designer_5", pos1),
      (try_begin),
        (250),
        (str_store_faction_name, s0, "fac_kingdom_1"),
        (overlay_add_item, "$g_presentation_obj_custom_battle_designer_5", s0),
        (store_add, ":var8", "fac_kingdom_1", 1),
        (str_store_faction_name, s0, ":var8"),
        (overlay_add_item, "$g_presentation_obj_custom_battle_designer_5", s0),
      (else_try),
        (try_for_range, ":var8", "fac_kingdom_1", "fac_kingdoms_end"),
          (str_store_faction_name, s0, ":var8"),
          (overlay_add_item, "$g_presentation_obj_custom_battle_designer_5", s0),
        (try_end),
        (str_store_faction_name, s0, "fac_outlaws"),
        (overlay_add_item, "$g_presentation_obj_custom_battle_designer_5", s0),
      (try_end),
      (try_begin),
        (eq, "$g_quick_battle_team_2_faction", "fac_outlaws"),
        (store_sub, ":var9", "fac_kingdoms_end", "fac_kingdom_1"),
        (overlay_set_val, "$g_presentation_obj_custom_battle_designer_5", ":var9"),
      (else_try),
        (store_sub, ":var11", "$g_quick_battle_team_2_faction", "fac_kingdom_1"),
        (overlay_set_val, "$g_presentation_obj_custom_battle_designer_5", ":var11"),
      (try_end),
      (val_sub, ":var6", ":var7"),
      (create_text_overlay, reg0, "str_army_composition", 16),
      (position_set_x, pos1, 175),
      (position_set_y, pos1, ":var6"),
      (overlay_set_position, reg0, pos1),
      (create_text_overlay, reg0, "str_army_composition", 16),
      (position_set_x, pos1, 820),
      (position_set_y, pos1, ":var6"),
      (overlay_set_position, reg0, pos1),
      (val_sub, ":var6", ":var7"),
      (try_begin),
        (eq, "$g_presentation_obj_custom_battle_designer_6_last_value", 0),
        (eq, "$g_presentation_obj_custom_battle_designer_7_last_value", 0),
        (eq, "$g_presentation_obj_custom_battle_designer_8_last_value", 0),
        (eq, "$g_presentation_obj_custom_battle_designer_9_last_value", 0),
        (eq, "$g_presentation_obj_custom_battle_designer_10_last_value", 0),
        (eq, "$g_presentation_obj_custom_battle_designer_11_last_value", 0),
        (assign, "$g_presentation_obj_custom_battle_designer_6_last_value", 34),
        (assign, "$g_presentation_obj_custom_battle_designer_7_last_value", 33),
        (assign, "$g_presentation_obj_custom_battle_designer_8_last_value", 33),
        (assign, "$g_presentation_obj_custom_battle_designer_9_last_value", 34),
        (assign, "$g_presentation_obj_custom_battle_designer_10_last_value", 33),
        (assign, "$g_presentation_obj_custom_battle_designer_11_last_value", 33),
        (assign, "$g_presentation_obj_custom_battle_designer_6_locked", 0),
        (assign, "$g_presentation_obj_custom_battle_designer_7_locked", 0),
        (assign, "$g_presentation_obj_custom_battle_designer_8_locked", 0),
        (assign, "$g_presentation_obj_custom_battle_designer_9_locked", 0),
        (assign, "$g_presentation_obj_custom_battle_designer_10_locked", 0),
        (assign, "$g_presentation_obj_custom_battle_designer_11_locked", 0),
      (try_end),
      (create_mesh_overlay, reg0, "mesh_cb_ui_icon_infantry"),
      (position_set_x, pos1, 5),
      (position_set_y, pos1, ":var6"),
      (overlay_set_position, reg0, pos1),
      (position_set_x, pos1, 400),
      (position_set_y, pos1, 400),
      (overlay_set_size, reg0, pos1),
      (create_mesh_overlay, reg0, "mesh_cb_ui_icon_infantry"),
      (position_set_x, pos1, 650),
      (position_set_y, pos1, ":var6"),
      (overlay_set_position, reg0, pos1),
      (position_set_x, pos1, 400),
      (position_set_y, pos1, 400),
      (overlay_set_size, reg0, pos1),
      (create_slider_overlay, "$g_presentation_obj_custom_battle_designer_6", 0, 100),
      (overlay_set_val, "$g_presentation_obj_custom_battle_designer_6", "$g_presentation_obj_custom_battle_designer_6_last_value"),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 1000),
      (overlay_set_size, "$g_presentation_obj_custom_battle_designer_6", pos1),
      (position_set_x, pos1, 175),
      (position_set_y, pos1, ":var6"),
      (overlay_set_position, "$g_presentation_obj_custom_battle_designer_6", pos1),
      (assign, reg0, "$g_presentation_obj_custom_battle_designer_6_last_value"),
      (create_text_overlay, "$g_presentation_obj_custom_battle_designer_12", "str_reg0_percent", 0),
      (position_set_x, pos1, 295),
      (position_set_y, pos1, ":var6"),
      (overlay_set_position, "$g_presentation_obj_custom_battle_designer_12", pos1),
      (create_slider_overlay, "$g_presentation_obj_custom_battle_designer_9", 0, 100),
      (overlay_set_val, "$g_presentation_obj_custom_battle_designer_9", "$g_presentation_obj_custom_battle_designer_9_last_value"),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 1000),
      (overlay_set_size, "$g_presentation_obj_custom_battle_designer_9", pos1),
      (position_set_x, pos1, 820),
      (position_set_y, pos1, ":var6"),
      (overlay_set_position, "$g_presentation_obj_custom_battle_designer_9", pos1),
      (assign, reg0, "$g_presentation_obj_custom_battle_designer_9_last_value"),
      (create_text_overlay, "$g_presentation_obj_custom_battle_designer_15", "str_reg0_percent", 0),
      (position_set_x, pos1, 940),
      (position_set_y, pos1, ":var6"),
      (overlay_set_position, "$g_presentation_obj_custom_battle_designer_15", pos1),
      (val_sub, ":var6", ":var7"),
      (create_mesh_overlay, reg0, "mesh_cb_ui_icon_archer"),
      (position_set_x, pos1, 15),
      (position_set_y, pos1, ":var6"),
      (overlay_set_position, reg0, pos1),
      (position_set_x, pos1, 400),
      (position_set_y, pos1, 400),
      (overlay_set_size, reg0, pos1),
      (create_mesh_overlay, reg0, "mesh_cb_ui_icon_archer"),
      (position_set_x, pos1, 660),
      (position_set_y, pos1, ":var6"),
      (overlay_set_position, reg0, pos1),
      (position_set_x, pos1, 400),
      (position_set_y, pos1, 400),
      (overlay_set_size, reg0, pos1),
      (create_slider_overlay, "$g_presentation_obj_custom_battle_designer_7", 0, 100),
      (overlay_set_val, "$g_presentation_obj_custom_battle_designer_7", "$g_presentation_obj_custom_battle_designer_7_last_value"),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 1000),
      (overlay_set_size, "$g_presentation_obj_custom_battle_designer_7", pos1),
      (position_set_x, pos1, 175),
      (position_set_y, pos1, ":var6"),
      (overlay_set_position, "$g_presentation_obj_custom_battle_designer_7", pos1),
      (assign, reg0, "$g_presentation_obj_custom_battle_designer_7_last_value"),
      (create_text_overlay, "$g_presentation_obj_custom_battle_designer_13", "str_reg0_percent", 0),
      (position_set_x, pos1, 295),
      (position_set_y, pos1, ":var6"),
      (overlay_set_position, "$g_presentation_obj_custom_battle_designer_13", pos1),
      (create_slider_overlay, "$g_presentation_obj_custom_battle_designer_10", 0, 100),
      (overlay_set_val, "$g_presentation_obj_custom_battle_designer_10", "$g_presentation_obj_custom_battle_designer_10_last_value"),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 1000),
      (overlay_set_size, "$g_presentation_obj_custom_battle_designer_10", pos1),
      (position_set_x, pos1, 820),
      (position_set_y, pos1, ":var6"),
      (overlay_set_position, "$g_presentation_obj_custom_battle_designer_10", pos1),
      (assign, reg0, "$g_presentation_obj_custom_battle_designer_10_last_value"),
      (create_text_overlay, "$g_presentation_obj_custom_battle_designer_16", "str_reg0_percent", 0),
      (position_set_x, pos1, 940),
      (position_set_y, pos1, ":var6"),
      (overlay_set_position, "$g_presentation_obj_custom_battle_designer_16", pos1),
      (val_sub, ":var6", ":var7"),
      (create_mesh_overlay, reg0, "mesh_cb_ui_icon_horseman"),
      (position_set_x, pos1, 10),
      (position_set_y, pos1, ":var6"),
      (overlay_set_position, reg0, pos1),
      (position_set_x, pos1, 400),
      (position_set_y, pos1, 400),
      (overlay_set_size, reg0, pos1),
      (create_mesh_overlay, reg0, "mesh_cb_ui_icon_horseman"),
      (position_set_x, pos1, 655),
      (position_set_y, pos1, ":var6"),
      (overlay_set_position, reg0, pos1),
      (position_set_x, pos1, 400),
      (position_set_y, pos1, 400),
      (overlay_set_size, reg0, pos1),
      (create_slider_overlay, "$g_presentation_obj_custom_battle_designer_8", 0, 100),
      (overlay_set_val, "$g_presentation_obj_custom_battle_designer_8", "$g_presentation_obj_custom_battle_designer_8_last_value"),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 1000),
      (overlay_set_size, "$g_presentation_obj_custom_battle_designer_8", pos1),
      (position_set_x, pos1, 175),
      (position_set_y, pos1, ":var6"),
      (overlay_set_position, "$g_presentation_obj_custom_battle_designer_8", pos1),
      (assign, reg0, "$g_presentation_obj_custom_battle_designer_8_last_value"),
      (create_text_overlay, "$g_presentation_obj_custom_battle_designer_14", "str_reg0_percent", 0),
      (position_set_x, pos1, 295),
      (position_set_y, pos1, ":var6"),
      (overlay_set_position, "$g_presentation_obj_custom_battle_designer_14", pos1),
      (create_slider_overlay, "$g_presentation_obj_custom_battle_designer_11", 0, 100),
      (overlay_set_val, "$g_presentation_obj_custom_battle_designer_11", "$g_presentation_obj_custom_battle_designer_11_last_value"),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 1000),
      (overlay_set_size, "$g_presentation_obj_custom_battle_designer_11", pos1),
      (position_set_x, pos1, 820),
      (position_set_y, pos1, ":var6"),
      (overlay_set_position, "$g_presentation_obj_custom_battle_designer_11", pos1),
      (assign, reg0, "$g_presentation_obj_custom_battle_designer_11_last_value"),
      (create_text_overlay, "$g_presentation_obj_custom_battle_designer_17", "str_reg0_percent", 0),
      (position_set_x, pos1, 940),
      (position_set_y, pos1, ":var6"),
      (overlay_set_position, "$g_presentation_obj_custom_battle_designer_17", pos1),
      (val_sub, ":var6", ":var7"),
      (create_text_overlay, reg0, "str_army_size", 16),
      (position_set_x, pos1, 175),
      (position_set_y, pos1, ":var6"),
      (overlay_set_position, reg0, pos1),
      (create_text_overlay, reg0, "str_army_size", 16),
      (position_set_x, pos1, 820),
      (position_set_y, pos1, ":var6"),
      (overlay_set_position, reg0, pos1),
      (val_sub, ":var6", ":var7"),
      (try_begin),
        (250),
        (val_min, "$g_quick_battle_army_1_size", 25),
        (val_min, "$g_quick_battle_army_2_size", 25),
      (try_end),
      (create_slider_overlay, "$g_presentation_obj_custom_battle_designer_2", 0, 100),
      (overlay_set_boundaries, "$g_presentation_obj_custom_battle_designer_2", 1000, 75000),
      (overlay_set_val, "$g_presentation_obj_custom_battle_designer_2", "$g_quick_battle_army_1_size"),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 1000),
      (overlay_set_size, "$g_presentation_obj_custom_battle_designer_2", pos1),
      (position_set_x, pos1, 135),
      (position_set_y, pos1, ":var6"),
      (overlay_set_position, "$g_presentation_obj_custom_battle_designer_2", pos1),
      (call_script, "script_get_army_size_from_slider_value", "$g_quick_battle_army_1_size"),
      (create_text_overlay, "$g_presentation_obj_custom_battle_designer_21", "str_reg0_men", 0),
      (position_set_x, pos1, 255),
      (position_set_y, pos1, ":var6"),
      (overlay_set_position, "$g_presentation_obj_custom_battle_designer_21", pos1),
      (create_slider_overlay, "$g_presentation_obj_custom_battle_designer_3", 200),
      (overlay_set_boundaries, "$g_presentation_obj_custom_battle_designer_3", 1000, 75000),
      (overlay_set_val, "$g_presentation_obj_custom_battle_designer_3", "$g_quick_battle_army_2_size"),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 1000),
      (overlay_set_size, "$g_presentation_obj_custom_battle_designer_3", pos1),
      (position_set_x, pos1, 780),
      (position_set_y, pos1, ":var6"),
      (overlay_set_position, "$g_presentation_obj_custom_battle_designer_3", pos1),
      (call_script, "script_get_army_size_from_slider_value", "$g_quick_battle_army_2_size"),
      (create_text_overlay, "$g_presentation_obj_custom_battle_designer_22", "str_reg0_men", 0),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, ":var6"),
      (overlay_set_position, "$g_presentation_obj_custom_battle_designer_22", pos1),
      (create_game_button_overlay, "$g_presentation_obj_custom_battle_designer_19", "str_start", 0),
      (position_set_x, pos1, 415),
      (position_set_y, pos1, 10),
      (overlay_set_position, "$g_presentation_obj_custom_battle_designer_19", pos1),
      (create_game_button_overlay, "$g_presentation_obj_custom_battle_designer_20", "str_back", 0),
      (position_set_x, pos1, 585),
      (position_set_y, pos1, 10),
      (overlay_set_position, "$g_presentation_obj_custom_battle_designer_20", pos1),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (store_trigger_param_2, ":var1"),
      (try_begin),
        (eq, ":var0", "$g_presentation_obj_custom_battle_designer_1"),
        (try_begin),
          (eq, "$g_quick_battle_game_type", 0),
          (store_add, "$g_quick_battle_map", ":var1", "scn_quick_battle_scene_1"),
        (else_try),
          (store_add, "$g_quick_battle_map", ":var1", "scn_quick_battle_scene_4"),
        (try_end),
        (presentation_set_duration, 0),
        (start_presentation, "prsnt_game_custom_battle_designer"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_custom_battle_designer_23"),
        (assign, "$g_quick_battle_game_type", ":var1"),
        (presentation_set_duration, 0),
        (start_presentation, "prsnt_game_custom_battle_designer"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_custom_battle_designer_24"),
        (store_random_in_range, "$g_quick_battle_game_type", 0, 3),
        (store_random_in_range, "$g_quick_battle_troop", "trp_quick_battle_troop_1", "trp_quick_battle_troops_end"),
        (try_begin),
          (250),
          (store_random_in_range, "$g_quick_battle_team_1_faction", 0, 2),
          (try_begin),
            (eq, "$g_quick_battle_team_1_faction", 0),
            (assign, "$g_quick_battle_team_2_faction", 1),
          (else_try),
            (assign, "$g_quick_battle_team_2_faction", 0),
          (try_end),
          (val_add, "$g_quick_battle_team_1_faction", "fac_kingdom_1"),
          (val_add, "$g_quick_battle_team_2_faction", "fac_kingdom_1"),
          (store_random_in_range, "$g_quick_battle_army_1_size", 10, 16),
          (store_random_in_range, ":var2", 0, 6),
          (val_add, "$g_quick_battle_army_1_size", ":var2"),
          (store_random_in_range, ":var2", 0, 6),
          (val_add, "$g_quick_battle_army_1_size", ":var2"),
        (else_try),
          (store_sub, ":var3", "fac_kingdoms_end", "fac_kingdom_1"),
          (val_add, ":var3", 1),
          (store_random_in_range, "$g_quick_battle_team_1_faction", 0, ":var3"),
          (try_begin),
            (eq, "$g_quick_battle_team_1_faction", 0),
            (assign, "$g_quick_battle_team_1_faction", "fac_outlaws"),
          (else_try),
            (val_add, "$g_quick_battle_team_1_faction", "fac_kingdom_1"),
            (val_sub, "$g_quick_battle_team_1_faction", 1),
          (try_end),
          (assign, ":var4", 1000),
          (try_for_range, ":var5", 0, ":var4"),
            (store_random_in_range, "$g_quick_battle_team_2_faction", 0, ":var3"),
            (try_begin),
              (eq, "$g_quick_battle_team_2_faction", 0),
              (assign, "$g_quick_battle_team_2_faction", "fac_outlaws"),
            (else_try),
              (val_add, "$g_quick_battle_team_2_faction", "fac_kingdom_1"),
              (val_sub, "$g_quick_battle_team_2_faction", 1),
            (try_end),
            (neq, "$g_quick_battle_team_1_faction", "$g_quick_battle_team_2_faction"),
            (assign, ":var4", 0),
          (try_end),
          (store_random_in_range, "$g_quick_battle_army_1_size", 10, 21),
          (store_random_in_range, ":var2", 0, 11),
          (val_add, "$g_quick_battle_army_1_size", ":var2"),
          (store_random_in_range, ":var2", 0, 11),
          (val_add, "$g_quick_battle_army_1_size", ":var2"),
        (try_end),
        (assign, "$g_quick_battle_army_2_size", "$g_quick_battle_army_1_size"),
        (try_begin),
          (eq, "$g_quick_battle_game_type", 0),
          (store_random_in_range, "$g_quick_battle_map", "scn_quick_battle_scene_1", "scn_quick_battle_scene_4"),
          (store_random_in_range, ":var6", 0, 3),
          (store_random_in_range, ":var7", 0, 2),
          (store_random_in_range, ":var8", 0, 100),
          (store_sub, ":var9", 100, ":var8"),
          (store_random_in_range, ":var10", 0, ":var9"),
          (store_sub, ":var11", ":var9", ":var10"),
          (try_begin),
            (eq, ":var6", 0),
            (assign, "$g_presentation_obj_custom_battle_designer_6_last_value", ":var8"),
            (try_begin),
              (eq, ":var7", 0),
              (assign, "$g_presentation_obj_custom_battle_designer_7_last_value", ":var10"),
              (assign, "$g_presentation_obj_custom_battle_designer_8_last_value", ":var11"),
            (else_try),
              (assign, "$g_presentation_obj_custom_battle_designer_8_last_value", ":var10"),
              (assign, "$g_presentation_obj_custom_battle_designer_7_last_value", ":var11"),
            (try_end),
          (else_try),
            (eq, ":var6", 1),
            (assign, "$g_presentation_obj_custom_battle_designer_7_last_value", ":var8"),
            (try_begin),
              (eq, ":var7", 0),
              (assign, "$g_presentation_obj_custom_battle_designer_6_last_value", ":var10"),
              (assign, "$g_presentation_obj_custom_battle_designer_8_last_value", ":var11"),
            (else_try),
              (assign, "$g_presentation_obj_custom_battle_designer_8_last_value", ":var10"),
              (assign, "$g_presentation_obj_custom_battle_designer_6_last_value", ":var11"),
            (try_end),
          (else_try),
            (assign, "$g_presentation_obj_custom_battle_designer_8_last_value", ":var8"),
            (try_begin),
              (eq, ":var7", 0),
              (assign, "$g_presentation_obj_custom_battle_designer_6_last_value", ":var10"),
              (assign, "$g_presentation_obj_custom_battle_designer_7_last_value", ":var11"),
            (else_try),
              (assign, "$g_presentation_obj_custom_battle_designer_7_last_value", ":var10"),
              (assign, "$g_presentation_obj_custom_battle_designer_6_last_value", ":var11"),
            (try_end),
          (try_end),
          (store_random_in_range, ":var6", 0, 3),
          (store_random_in_range, ":var7", 0, 2),
          (store_random_in_range, ":var8", 0, 100),
          (store_sub, ":var9", 100, ":var8"),
          (store_random_in_range, ":var10", 0, ":var9"),
          (store_sub, ":var11", ":var9", ":var10"),
          (try_begin),
            (eq, ":var6", 0),
            (assign, "$g_presentation_obj_custom_battle_designer_9_last_value", ":var8"),
            (try_begin),
              (eq, ":var7", 0),
              (assign, "$g_presentation_obj_custom_battle_designer_10_last_value", ":var10"),
              (assign, "$g_presentation_obj_custom_battle_designer_11_last_value", ":var11"),
            (else_try),
              (assign, "$g_presentation_obj_custom_battle_designer_11_last_value", ":var10"),
              (assign, "$g_presentation_obj_custom_battle_designer_10_last_value", ":var11"),
            (try_end),
          (else_try),
            (eq, ":var6", 1),
            (assign, "$g_presentation_obj_custom_battle_designer_10_last_value", ":var8"),
            (try_begin),
              (eq, ":var7", 0),
              (assign, "$g_presentation_obj_custom_battle_designer_9_last_value", ":var10"),
              (assign, "$g_presentation_obj_custom_battle_designer_11_last_value", ":var11"),
            (else_try),
              (assign, "$g_presentation_obj_custom_battle_designer_11_last_value", ":var10"),
              (assign, "$g_presentation_obj_custom_battle_designer_9_last_value", ":var11"),
            (try_end),
          (else_try),
            (assign, "$g_presentation_obj_custom_battle_designer_11_last_value", ":var8"),
            (try_begin),
              (eq, ":var7", 0),
              (assign, "$g_presentation_obj_custom_battle_designer_9_last_value", ":var10"),
              (assign, "$g_presentation_obj_custom_battle_designer_10_last_value", ":var11"),
            (else_try),
              (assign, "$g_presentation_obj_custom_battle_designer_10_last_value", ":var10"),
              (assign, "$g_presentation_obj_custom_battle_designer_9_last_value", ":var11"),
            (try_end),
          (try_end),
        (else_try),
          (eq, "$g_quick_battle_game_type", 1),
          (store_random_in_range, "$g_quick_battle_map", "scn_quick_battle_scene_4", "scn_quick_battle_maps_end"),
          (store_random_in_range, "$g_presentation_obj_custom_battle_designer_10_last_value", 30, 100),
          (store_sub, "$g_presentation_obj_custom_battle_designer_9_last_value", 100, "$g_presentation_obj_custom_battle_designer_10_last_value"),
          (assign, "$g_presentation_obj_custom_battle_designer_11_last_value", 0),
          (store_random_in_range, "$g_presentation_obj_custom_battle_designer_6_last_value", 20, 100),
          (store_sub, "$g_presentation_obj_custom_battle_designer_7_last_value", 100, "$g_presentation_obj_custom_battle_designer_6_last_value"),
          (assign, "$g_presentation_obj_custom_battle_designer_8_last_value", 0),
        (else_try),
          (store_random_in_range, "$g_quick_battle_map", "scn_quick_battle_scene_4", "scn_quick_battle_maps_end"),
          (store_random_in_range, "$g_presentation_obj_custom_battle_designer_7_last_value", 30, 100),
          (store_sub, "$g_presentation_obj_custom_battle_designer_6_last_value", 100, "$g_presentation_obj_custom_battle_designer_7_last_value"),
          (assign, "$g_presentation_obj_custom_battle_designer_8_last_value", 0),
          (store_random_in_range, "$g_presentation_obj_custom_battle_designer_9_last_value", 20, 100),
          (store_sub, "$g_presentation_obj_custom_battle_designer_10_last_value", 100, "$g_presentation_obj_custom_battle_designer_9_last_value"),
          (assign, "$g_presentation_obj_custom_battle_designer_11_last_value", 0),
        (try_end),
        (presentation_set_duration, 0),
        (start_presentation, "prsnt_game_custom_battle_designer"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_custom_battle_designer_2"),
        (assign, "$g_quick_battle_army_1_size", ":var1"),
        (try_begin),
          (250),
          (gt, "$g_quick_battle_army_1_size", 25),
          (assign, "$g_quick_battle_army_1_size", 25),
          (overlay_set_val, "$g_presentation_obj_custom_battle_designer_2", 25),
        (try_end),
        (call_script, "script_get_army_size_from_slider_value", "$g_quick_battle_army_1_size"),
        (overlay_set_text, "$g_presentation_obj_custom_battle_designer_21", "str_reg0_men"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_custom_battle_designer_3"),
        (assign, "$g_quick_battle_army_2_size", ":var1"),
        (try_begin),
          (250),
          (gt, "$g_quick_battle_army_2_size", 25),
          (assign, "$g_quick_battle_army_2_size", 25),
          (overlay_set_val, "$g_presentation_obj_custom_battle_designer_3", 25),
        (try_end),
        (call_script, "script_get_army_size_from_slider_value", "$g_quick_battle_army_2_size"),
        (overlay_set_text, "$g_presentation_obj_custom_battle_designer_22", "str_reg0_men"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_custom_battle_designer_4"),
        (try_begin),
          (store_sub, ":var12", "fac_kingdoms_end", "fac_kingdom_1"),
          (eq, ":var1", ":var12"),
          (assign, "$g_quick_battle_team_1_faction", "fac_outlaws"),
        (else_try),
          (store_add, "$g_quick_battle_team_1_faction", ":var1", "fac_kingdom_1"),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_custom_battle_designer_5"),
        (try_begin),
          (store_sub, ":var12", "fac_kingdoms_end", "fac_kingdom_1"),
          (eq, ":var1", ":var12"),
          (assign, "$g_quick_battle_team_2_faction", "fac_outlaws"),
        (else_try),
          (store_add, "$g_quick_battle_team_2_faction", ":var1", "fac_kingdom_1"),
        (try_end),
        (presentation_set_duration, 0),
        (start_presentation, "prsnt_game_custom_battle_designer"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_custom_battle_designer_18"),
        (store_add, "$g_quick_battle_troop", ":var1", "trp_quick_battle_troop_1"),
        (presentation_set_duration, 0),
        (start_presentation, "prsnt_game_custom_battle_designer"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_custom_battle_designer_6"),
        (try_begin),
          (eq, "$g_presentation_obj_custom_battle_designer_6_locked", 1),
          (neq, ":var1", "$g_presentation_obj_custom_battle_designer_6_last_value"),
          (overlay_set_val, "$g_presentation_obj_custom_battle_designer_6", "$g_presentation_obj_custom_battle_designer_6_last_value"),
        (else_try),
          (try_begin),
            (lt, ":var1", "$g_presentation_obj_custom_battle_designer_6_last_value"),
            (store_sub, ":var13", "$g_presentation_obj_custom_battle_designer_6_last_value", ":var1"),
            (try_begin),
              (eq, "$g_presentation_obj_custom_battle_designer_7_locked", 1),
              (assign, ":var14", 0),
              (assign, ":var15", ":var13"),
            (else_try),
              (eq, "$g_presentation_obj_custom_battle_designer_8_locked", 1),
              (assign, ":var14", ":var13"),
              (assign, ":var15", 0),
            (else_try),
              (store_div, ":var14", ":var13", 2),
              (store_sub, ":var15", ":var13", ":var14"),
              (try_begin),
                (neq, ":var14", ":var15"),
                (store_random_in_range, ":var16", 0, 2),
                (eq, ":var16", 0),
                (val_sub, ":var15", 1),
                (val_add, ":var14", 1),
              (try_end),
            (try_end),
            (assign, "$g_presentation_obj_custom_battle_designer_6_last_value", ":var1"),
            (val_add, "$g_presentation_obj_custom_battle_designer_7_last_value", ":var14"),
            (val_add, "$g_presentation_obj_custom_battle_designer_8_last_value", ":var15"),
            (try_begin),
              (gt, "$g_presentation_obj_custom_battle_designer_7_last_value", 100),
              (store_sub, ":var13", "$g_presentation_obj_custom_battle_designer_7_last_value", 100),
              (val_add, "$g_presentation_obj_custom_battle_designer_8_last_value", ":var13"),
              (assign, "$g_presentation_obj_custom_battle_designer_7_last_value", 100),
            (else_try),
              (gt, "$g_presentation_obj_custom_battle_designer_8_last_value", 100),
              (store_sub, ":var13", "$g_presentation_obj_custom_battle_designer_8_last_value", 100),
              (val_add, "$g_presentation_obj_custom_battle_designer_7_last_value", ":var13"),
              (assign, "$g_presentation_obj_custom_battle_designer_8_last_value", 100),
            (try_end),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_7", "$g_presentation_obj_custom_battle_designer_7_last_value"),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_8", "$g_presentation_obj_custom_battle_designer_8_last_value"),
          (else_try),
            (gt, ":var1", "$g_presentation_obj_custom_battle_designer_6_last_value"),
            (store_sub, ":var13", ":var1", "$g_presentation_obj_custom_battle_designer_6_last_value"),
            (try_begin),
              (eq, "$g_presentation_obj_custom_battle_designer_7_locked", 1),
              (assign, ":var14", 0),
              (assign, ":var15", ":var13"),
            (else_try),
              (eq, "$g_presentation_obj_custom_battle_designer_8_locked", 1),
              (assign, ":var14", ":var13"),
              (assign, ":var15", 0),
            (else_try),
              (store_div, ":var14", ":var13", 2),
              (store_sub, ":var15", ":var13", ":var14"),
              (try_begin),
                (neq, ":var14", ":var15"),
                (store_random_in_range, ":var16", 0, 2),
                (eq, ":var16", 0),
                (val_sub, ":var15", 1),
                (val_add, ":var14", 1),
              (try_end),
            (try_end),
            (assign, "$g_presentation_obj_custom_battle_designer_6_last_value", ":var1"),
            (val_sub, "$g_presentation_obj_custom_battle_designer_7_last_value", ":var14"),
            (val_sub, "$g_presentation_obj_custom_battle_designer_8_last_value", ":var15"),
            (try_begin),
              (lt, "$g_presentation_obj_custom_battle_designer_7_last_value", 0),
              (val_add, "$g_presentation_obj_custom_battle_designer_8_last_value", "$g_presentation_obj_custom_battle_designer_7_last_value"),
              (assign, "$g_presentation_obj_custom_battle_designer_7_last_value", 0),
            (else_try),
              (lt, "$g_presentation_obj_custom_battle_designer_8_last_value", 0),
              (val_add, "$g_presentation_obj_custom_battle_designer_7_last_value", "$g_presentation_obj_custom_battle_designer_8_last_value"),
              (assign, "$g_presentation_obj_custom_battle_designer_8_last_value", 0),
            (try_end),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_7", "$g_presentation_obj_custom_battle_designer_7_last_value"),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_8", "$g_presentation_obj_custom_battle_designer_8_last_value"),
          (try_end),
          (assign, reg0, "$g_presentation_obj_custom_battle_designer_6_last_value"),
          (overlay_set_text, "$g_presentation_obj_custom_battle_designer_12", "str_reg0_percent"),
          (assign, reg0, "$g_presentation_obj_custom_battle_designer_7_last_value"),
          (overlay_set_text, "$g_presentation_obj_custom_battle_designer_13", "str_reg0_percent"),
          (assign, reg0, "$g_presentation_obj_custom_battle_designer_8_last_value"),
          (overlay_set_text, "$g_presentation_obj_custom_battle_designer_14", "str_reg0_percent"),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_custom_battle_designer_7"),
        (try_begin),
          (eq, "$g_presentation_obj_custom_battle_designer_7_locked", 1),
          (neq, ":var1", "$g_presentation_obj_custom_battle_designer_7_last_value"),
          (overlay_set_val, "$g_presentation_obj_custom_battle_designer_7", "$g_presentation_obj_custom_battle_designer_7_last_value"),
        (else_try),
          (try_begin),
            (lt, ":var1", "$g_presentation_obj_custom_battle_designer_7_last_value"),
            (store_sub, ":var13", "$g_presentation_obj_custom_battle_designer_7_last_value", ":var1"),
            (try_begin),
              (eq, "$g_presentation_obj_custom_battle_designer_6_locked", 1),
              (assign, ":var14", 0),
              (assign, ":var15", ":var13"),
            (else_try),
              (eq, "$g_presentation_obj_custom_battle_designer_8_locked", 1),
              (assign, ":var14", ":var13"),
              (assign, ":var15", 0),
            (else_try),
              (store_div, ":var14", ":var13", 2),
              (store_sub, ":var15", ":var13", ":var14"),
              (try_begin),
                (neq, ":var14", ":var15"),
                (store_random_in_range, ":var16", 0, 2),
                (eq, ":var16", 0),
                (val_sub, ":var15", 1),
                (val_add, ":var14", 1),
              (try_end),
            (try_end),
            (assign, "$g_presentation_obj_custom_battle_designer_7_last_value", ":var1"),
            (val_add, "$g_presentation_obj_custom_battle_designer_6_last_value", ":var14"),
            (val_add, "$g_presentation_obj_custom_battle_designer_8_last_value", ":var15"),
            (try_begin),
              (gt, "$g_presentation_obj_custom_battle_designer_6_last_value", 100),
              (store_sub, ":var13", "$g_presentation_obj_custom_battle_designer_6_last_value", 100),
              (val_add, "$g_presentation_obj_custom_battle_designer_8_last_value", ":var13"),
              (assign, "$g_presentation_obj_custom_battle_designer_6_last_value", 100),
            (else_try),
              (gt, "$g_presentation_obj_custom_battle_designer_8_last_value", 100),
              (store_sub, ":var13", "$g_presentation_obj_custom_battle_designer_8_last_value", 100),
              (val_add, "$g_presentation_obj_custom_battle_designer_6_last_value", ":var13"),
              (assign, "$g_presentation_obj_custom_battle_designer_8_last_value", 100),
            (try_end),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_6", "$g_presentation_obj_custom_battle_designer_6_last_value"),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_8", "$g_presentation_obj_custom_battle_designer_8_last_value"),
          (else_try),
            (gt, ":var1", "$g_presentation_obj_custom_battle_designer_7_last_value"),
            (store_sub, ":var13", ":var1", "$g_presentation_obj_custom_battle_designer_7_last_value"),
            (try_begin),
              (eq, "$g_presentation_obj_custom_battle_designer_6_locked", 1),
              (assign, ":var14", 0),
              (assign, ":var15", ":var13"),
            (else_try),
              (eq, "$g_presentation_obj_custom_battle_designer_8_locked", 1),
              (assign, ":var14", ":var13"),
              (assign, ":var15", 0),
            (else_try),
              (store_div, ":var14", ":var13", 2),
              (store_sub, ":var15", ":var13", ":var14"),
              (try_begin),
                (neq, ":var14", ":var15"),
                (store_random_in_range, ":var16", 0, 2),
                (eq, ":var16", 0),
                (val_sub, ":var15", 1),
                (val_add, ":var14", 1),
              (try_end),
            (try_end),
            (assign, "$g_presentation_obj_custom_battle_designer_7_last_value", ":var1"),
            (val_sub, "$g_presentation_obj_custom_battle_designer_6_last_value", ":var14"),
            (val_sub, "$g_presentation_obj_custom_battle_designer_8_last_value", ":var15"),
            (try_begin),
              (lt, "$g_presentation_obj_custom_battle_designer_6_last_value", 0),
              (val_add, "$g_presentation_obj_custom_battle_designer_8_last_value", "$g_presentation_obj_custom_battle_designer_6_last_value"),
              (assign, "$g_presentation_obj_custom_battle_designer_6_last_value", 0),
            (else_try),
              (lt, "$g_presentation_obj_custom_battle_designer_8_last_value", 0),
              (val_add, "$g_presentation_obj_custom_battle_designer_6_last_value", "$g_presentation_obj_custom_battle_designer_8_last_value"),
              (assign, "$g_presentation_obj_custom_battle_designer_8_last_value", 0),
            (try_end),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_6", "$g_presentation_obj_custom_battle_designer_6_last_value"),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_8", "$g_presentation_obj_custom_battle_designer_8_last_value"),
          (try_end),
          (assign, reg0, "$g_presentation_obj_custom_battle_designer_6_last_value"),
          (overlay_set_text, "$g_presentation_obj_custom_battle_designer_12", "str_reg0_percent"),
          (assign, reg0, "$g_presentation_obj_custom_battle_designer_7_last_value"),
          (overlay_set_text, "$g_presentation_obj_custom_battle_designer_13", "str_reg0_percent"),
          (assign, reg0, "$g_presentation_obj_custom_battle_designer_8_last_value"),
          (overlay_set_text, "$g_presentation_obj_custom_battle_designer_14", "str_reg0_percent"),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_custom_battle_designer_8"),
        (try_begin),
          (eq, "$g_presentation_obj_custom_battle_designer_8_locked", 1),
          (neq, ":var1", "$g_presentation_obj_custom_battle_designer_8_last_value"),
          (overlay_set_val, "$g_presentation_obj_custom_battle_designer_8", "$g_presentation_obj_custom_battle_designer_8_last_value"),
        (else_try),
          (try_begin),
            (lt, ":var1", "$g_presentation_obj_custom_battle_designer_8_last_value"),
            (store_sub, ":var13", "$g_presentation_obj_custom_battle_designer_8_last_value", ":var1"),
            (try_begin),
              (eq, "$g_presentation_obj_custom_battle_designer_7_locked", 1),
              (assign, ":var14", 0),
              (assign, ":var15", ":var13"),
            (else_try),
              (eq, "$g_presentation_obj_custom_battle_designer_6_locked", 1),
              (assign, ":var14", ":var13"),
              (assign, ":var15", 0),
            (else_try),
              (store_div, ":var14", ":var13", 2),
              (store_sub, ":var15", ":var13", ":var14"),
              (try_begin),
                (neq, ":var14", ":var15"),
                (store_random_in_range, ":var16", 0, 2),
                (eq, ":var16", 0),
                (val_sub, ":var15", 1),
                (val_add, ":var14", 1),
              (try_end),
            (try_end),
            (assign, "$g_presentation_obj_custom_battle_designer_8_last_value", ":var1"),
            (val_add, "$g_presentation_obj_custom_battle_designer_7_last_value", ":var14"),
            (val_add, "$g_presentation_obj_custom_battle_designer_6_last_value", ":var15"),
            (try_begin),
              (gt, "$g_presentation_obj_custom_battle_designer_7_last_value", 100),
              (store_sub, ":var13", "$g_presentation_obj_custom_battle_designer_7_last_value", 100),
              (val_add, "$g_presentation_obj_custom_battle_designer_6_last_value", ":var13"),
              (assign, "$g_presentation_obj_custom_battle_designer_7_last_value", 100),
            (else_try),
              (gt, "$g_presentation_obj_custom_battle_designer_6_last_value", 100),
              (store_sub, ":var13", "$g_presentation_obj_custom_battle_designer_6_last_value", 100),
              (val_add, "$g_presentation_obj_custom_battle_designer_7_last_value", ":var13"),
              (assign, "$g_presentation_obj_custom_battle_designer_6_last_value", 100),
            (try_end),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_7", "$g_presentation_obj_custom_battle_designer_7_last_value"),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_6", "$g_presentation_obj_custom_battle_designer_6_last_value"),
          (else_try),
            (gt, ":var1", "$g_presentation_obj_custom_battle_designer_8_last_value"),
            (store_sub, ":var13", ":var1", "$g_presentation_obj_custom_battle_designer_8_last_value"),
            (try_begin),
              (eq, "$g_presentation_obj_custom_battle_designer_7_locked", 1),
              (assign, ":var14", 0),
              (assign, ":var15", ":var13"),
            (else_try),
              (eq, "$g_presentation_obj_custom_battle_designer_6_locked", 1),
              (assign, ":var14", ":var13"),
              (assign, ":var15", 0),
            (else_try),
              (store_div, ":var14", ":var13", 2),
              (store_sub, ":var15", ":var13", ":var14"),
              (try_begin),
                (neq, ":var14", ":var15"),
                (store_random_in_range, ":var16", 0, 2),
                (eq, ":var16", 0),
                (val_sub, ":var15", 1),
                (val_add, ":var14", 1),
              (try_end),
            (try_end),
            (assign, "$g_presentation_obj_custom_battle_designer_8_last_value", ":var1"),
            (val_sub, "$g_presentation_obj_custom_battle_designer_7_last_value", ":var14"),
            (val_sub, "$g_presentation_obj_custom_battle_designer_6_last_value", ":var15"),
            (try_begin),
              (lt, "$g_presentation_obj_custom_battle_designer_7_last_value", 0),
              (val_add, "$g_presentation_obj_custom_battle_designer_6_last_value", "$g_presentation_obj_custom_battle_designer_7_last_value"),
              (assign, "$g_presentation_obj_custom_battle_designer_7_last_value", 0),
            (else_try),
              (lt, "$g_presentation_obj_custom_battle_designer_6_last_value", 0),
              (val_add, "$g_presentation_obj_custom_battle_designer_7_last_value", "$g_presentation_obj_custom_battle_designer_6_last_value"),
              (assign, "$g_presentation_obj_custom_battle_designer_6_last_value", 0),
            (try_end),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_7", "$g_presentation_obj_custom_battle_designer_7_last_value"),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_6", "$g_presentation_obj_custom_battle_designer_6_last_value"),
          (try_end),
          (assign, reg0, "$g_presentation_obj_custom_battle_designer_6_last_value"),
          (overlay_set_text, "$g_presentation_obj_custom_battle_designer_12", "str_reg0_percent"),
          (assign, reg0, "$g_presentation_obj_custom_battle_designer_7_last_value"),
          (overlay_set_text, "$g_presentation_obj_custom_battle_designer_13", "str_reg0_percent"),
          (assign, reg0, "$g_presentation_obj_custom_battle_designer_8_last_value"),
          (overlay_set_text, "$g_presentation_obj_custom_battle_designer_14", "str_reg0_percent"),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_custom_battle_designer_9"),
        (try_begin),
          (eq, "$g_presentation_obj_custom_battle_designer_9_locked", 1),
          (neq, ":var1", "$g_presentation_obj_custom_battle_designer_9_last_value"),
          (overlay_set_val, "$g_presentation_obj_custom_battle_designer_9", "$g_presentation_obj_custom_battle_designer_9_last_value"),
        (else_try),
          (try_begin),
            (lt, ":var1", "$g_presentation_obj_custom_battle_designer_9_last_value"),
            (store_sub, ":var13", "$g_presentation_obj_custom_battle_designer_9_last_value", ":var1"),
            (try_begin),
              (eq, "$g_presentation_obj_custom_battle_designer_10_locked", 1),
              (assign, ":var14", 0),
              (assign, ":var15", ":var13"),
            (else_try),
              (eq, "$g_presentation_obj_custom_battle_designer_11_locked", 1),
              (assign, ":var14", ":var13"),
              (assign, ":var15", 0),
            (else_try),
              (store_div, ":var14", ":var13", 2),
              (store_sub, ":var15", ":var13", ":var14"),
              (try_begin),
                (neq, ":var14", ":var15"),
                (store_random_in_range, ":var16", 0, 2),
                (eq, ":var16", 0),
                (val_sub, ":var15", 1),
                (val_add, ":var14", 1),
              (try_end),
            (try_end),
            (assign, "$g_presentation_obj_custom_battle_designer_9_last_value", ":var1"),
            (val_add, "$g_presentation_obj_custom_battle_designer_10_last_value", ":var14"),
            (val_add, "$g_presentation_obj_custom_battle_designer_11_last_value", ":var15"),
            (try_begin),
              (gt, "$g_presentation_obj_custom_battle_designer_10_last_value", 100),
              (store_sub, ":var13", "$g_presentation_obj_custom_battle_designer_10_last_value", 100),
              (val_add, "$g_presentation_obj_custom_battle_designer_11_last_value", ":var13"),
              (assign, "$g_presentation_obj_custom_battle_designer_10_last_value", 100),
            (else_try),
              (gt, "$g_presentation_obj_custom_battle_designer_11_last_value", 100),
              (store_sub, ":var13", "$g_presentation_obj_custom_battle_designer_11_last_value", 100),
              (val_add, "$g_presentation_obj_custom_battle_designer_10_last_value", ":var13"),
              (assign, "$g_presentation_obj_custom_battle_designer_11_last_value", 100),
            (try_end),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_10", "$g_presentation_obj_custom_battle_designer_10_last_value"),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_11", "$g_presentation_obj_custom_battle_designer_11_last_value"),
          (else_try),
            (gt, ":var1", "$g_presentation_obj_custom_battle_designer_9_last_value"),
            (store_sub, ":var13", ":var1", "$g_presentation_obj_custom_battle_designer_9_last_value"),
            (try_begin),
              (eq, "$g_presentation_obj_custom_battle_designer_10_locked", 1),
              (assign, ":var14", 0),
              (assign, ":var15", ":var13"),
            (else_try),
              (eq, "$g_presentation_obj_custom_battle_designer_11_locked", 1),
              (assign, ":var14", ":var13"),
              (assign, ":var15", 0),
            (else_try),
              (store_div, ":var14", ":var13", 2),
              (store_sub, ":var15", ":var13", ":var14"),
              (try_begin),
                (neq, ":var14", ":var15"),
                (store_random_in_range, ":var16", 0, 2),
                (eq, ":var16", 0),
                (val_sub, ":var15", 1),
                (val_add, ":var14", 1),
              (try_end),
            (try_end),
            (assign, "$g_presentation_obj_custom_battle_designer_9_last_value", ":var1"),
            (val_sub, "$g_presentation_obj_custom_battle_designer_10_last_value", ":var14"),
            (val_sub, "$g_presentation_obj_custom_battle_designer_11_last_value", ":var15"),
            (try_begin),
              (lt, "$g_presentation_obj_custom_battle_designer_10_last_value", 0),
              (val_add, "$g_presentation_obj_custom_battle_designer_11_last_value", "$g_presentation_obj_custom_battle_designer_10_last_value"),
              (assign, "$g_presentation_obj_custom_battle_designer_10_last_value", 0),
            (else_try),
              (lt, "$g_presentation_obj_custom_battle_designer_11_last_value", 0),
              (val_add, "$g_presentation_obj_custom_battle_designer_10_last_value", "$g_presentation_obj_custom_battle_designer_11_last_value"),
              (assign, "$g_presentation_obj_custom_battle_designer_11_last_value", 0),
            (try_end),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_10", "$g_presentation_obj_custom_battle_designer_10_last_value"),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_11", "$g_presentation_obj_custom_battle_designer_11_last_value"),
          (try_end),
          (assign, reg0, "$g_presentation_obj_custom_battle_designer_9_last_value"),
          (overlay_set_text, "$g_presentation_obj_custom_battle_designer_15", "str_reg0_percent"),
          (assign, reg0, "$g_presentation_obj_custom_battle_designer_10_last_value"),
          (overlay_set_text, "$g_presentation_obj_custom_battle_designer_16", "str_reg0_percent"),
          (assign, reg0, "$g_presentation_obj_custom_battle_designer_11_last_value"),
          (overlay_set_text, "$g_presentation_obj_custom_battle_designer_17", "str_reg0_percent"),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_custom_battle_designer_10"),
        (try_begin),
          (eq, "$g_presentation_obj_custom_battle_designer_10_locked", 1),
          (neq, ":var1", "$g_presentation_obj_custom_battle_designer_10_last_value"),
          (overlay_set_val, "$g_presentation_obj_custom_battle_designer_10", "$g_presentation_obj_custom_battle_designer_10_last_value"),
        (else_try),
          (try_begin),
            (lt, ":var1", "$g_presentation_obj_custom_battle_designer_10_last_value"),
            (store_sub, ":var13", "$g_presentation_obj_custom_battle_designer_10_last_value", ":var1"),
            (try_begin),
              (eq, "$g_presentation_obj_custom_battle_designer_9_locked", 1),
              (assign, ":var14", 0),
              (assign, ":var15", ":var13"),
            (else_try),
              (eq, "$g_presentation_obj_custom_battle_designer_11_locked", 1),
              (assign, ":var14", ":var13"),
              (assign, ":var15", 0),
            (else_try),
              (store_div, ":var14", ":var13", 2),
              (store_sub, ":var15", ":var13", ":var14"),
              (try_begin),
                (neq, ":var14", ":var15"),
                (store_random_in_range, ":var16", 0, 2),
                (eq, ":var16", 0),
                (val_sub, ":var15", 1),
                (val_add, ":var14", 1),
              (try_end),
            (try_end),
            (assign, "$g_presentation_obj_custom_battle_designer_10_last_value", ":var1"),
            (val_add, "$g_presentation_obj_custom_battle_designer_9_last_value", ":var14"),
            (val_add, "$g_presentation_obj_custom_battle_designer_11_last_value", ":var15"),
            (try_begin),
              (gt, "$g_presentation_obj_custom_battle_designer_9_last_value", 100),
              (store_sub, ":var13", "$g_presentation_obj_custom_battle_designer_9_last_value", 100),
              (val_add, "$g_presentation_obj_custom_battle_designer_11_last_value", ":var13"),
              (assign, "$g_presentation_obj_custom_battle_designer_9_last_value", 100),
            (else_try),
              (gt, "$g_presentation_obj_custom_battle_designer_11_last_value", 100),
              (store_sub, ":var13", "$g_presentation_obj_custom_battle_designer_11_last_value", 100),
              (val_add, "$g_presentation_obj_custom_battle_designer_9_last_value", ":var13"),
              (assign, "$g_presentation_obj_custom_battle_designer_11_last_value", 100),
            (try_end),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_9", "$g_presentation_obj_custom_battle_designer_9_last_value"),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_11", "$g_presentation_obj_custom_battle_designer_11_last_value"),
          (else_try),
            (gt, ":var1", "$g_presentation_obj_custom_battle_designer_10_last_value"),
            (store_sub, ":var13", ":var1", "$g_presentation_obj_custom_battle_designer_10_last_value"),
            (try_begin),
              (eq, "$g_presentation_obj_custom_battle_designer_9_locked", 1),
              (assign, ":var14", 0),
              (assign, ":var15", ":var13"),
            (else_try),
              (eq, "$g_presentation_obj_custom_battle_designer_11_locked", 1),
              (assign, ":var14", ":var13"),
              (assign, ":var15", 0),
            (else_try),
              (store_div, ":var14", ":var13", 2),
              (store_sub, ":var15", ":var13", ":var14"),
              (try_begin),
                (neq, ":var14", ":var15"),
                (store_random_in_range, ":var16", 0, 2),
                (eq, ":var16", 0),
                (val_sub, ":var15", 1),
                (val_add, ":var14", 1),
              (try_end),
            (try_end),
            (assign, "$g_presentation_obj_custom_battle_designer_10_last_value", ":var1"),
            (val_sub, "$g_presentation_obj_custom_battle_designer_9_last_value", ":var14"),
            (val_sub, "$g_presentation_obj_custom_battle_designer_11_last_value", ":var15"),
            (try_begin),
              (lt, "$g_presentation_obj_custom_battle_designer_9_last_value", 0),
              (val_add, "$g_presentation_obj_custom_battle_designer_11_last_value", "$g_presentation_obj_custom_battle_designer_9_last_value"),
              (assign, "$g_presentation_obj_custom_battle_designer_9_last_value", 0),
            (else_try),
              (lt, "$g_presentation_obj_custom_battle_designer_11_last_value", 0),
              (val_add, "$g_presentation_obj_custom_battle_designer_9_last_value", "$g_presentation_obj_custom_battle_designer_11_last_value"),
              (assign, "$g_presentation_obj_custom_battle_designer_11_last_value", 0),
            (try_end),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_9", "$g_presentation_obj_custom_battle_designer_9_last_value"),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_11", "$g_presentation_obj_custom_battle_designer_11_last_value"),
          (try_end),
          (assign, reg0, "$g_presentation_obj_custom_battle_designer_9_last_value"),
          (overlay_set_text, "$g_presentation_obj_custom_battle_designer_15", "str_reg0_percent"),
          (assign, reg0, "$g_presentation_obj_custom_battle_designer_10_last_value"),
          (overlay_set_text, "$g_presentation_obj_custom_battle_designer_16", "str_reg0_percent"),
          (assign, reg0, "$g_presentation_obj_custom_battle_designer_11_last_value"),
          (overlay_set_text, "$g_presentation_obj_custom_battle_designer_17", "str_reg0_percent"),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_custom_battle_designer_11"),
        (try_begin),
          (eq, "$g_presentation_obj_custom_battle_designer_11_locked", 1),
          (neq, ":var1", "$g_presentation_obj_custom_battle_designer_11_last_value"),
          (overlay_set_val, "$g_presentation_obj_custom_battle_designer_11", "$g_presentation_obj_custom_battle_designer_11_last_value"),
        (else_try),
          (try_begin),
            (lt, ":var1", "$g_presentation_obj_custom_battle_designer_11_last_value"),
            (store_sub, ":var13", "$g_presentation_obj_custom_battle_designer_11_last_value", ":var1"),
            (try_begin),
              (eq, "$g_presentation_obj_custom_battle_designer_10_locked", 1),
              (assign, ":var14", 0),
              (assign, ":var15", ":var13"),
            (else_try),
              (eq, "$g_presentation_obj_custom_battle_designer_9_locked", 1),
              (assign, ":var14", ":var13"),
              (assign, ":var15", 0),
            (else_try),
              (store_div, ":var14", ":var13", 2),
              (store_sub, ":var15", ":var13", ":var14"),
              (try_begin),
                (neq, ":var14", ":var15"),
                (store_random_in_range, ":var16", 0, 2),
                (eq, ":var16", 0),
                (val_sub, ":var15", 1),
                (val_add, ":var14", 1),
              (try_end),
            (try_end),
            (assign, "$g_presentation_obj_custom_battle_designer_11_last_value", ":var1"),
            (val_add, "$g_presentation_obj_custom_battle_designer_10_last_value", ":var14"),
            (val_add, "$g_presentation_obj_custom_battle_designer_9_last_value", ":var15"),
            (try_begin),
              (gt, "$g_presentation_obj_custom_battle_designer_10_last_value", 100),
              (store_sub, ":var13", "$g_presentation_obj_custom_battle_designer_10_last_value", 100),
              (val_add, "$g_presentation_obj_custom_battle_designer_9_last_value", ":var13"),
              (assign, "$g_presentation_obj_custom_battle_designer_10_last_value", 100),
            (else_try),
              (gt, "$g_presentation_obj_custom_battle_designer_9_last_value", 100),
              (store_sub, ":var13", "$g_presentation_obj_custom_battle_designer_9_last_value", 100),
              (val_add, "$g_presentation_obj_custom_battle_designer_10_last_value", ":var13"),
              (assign, "$g_presentation_obj_custom_battle_designer_9_last_value", 100),
            (try_end),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_10", "$g_presentation_obj_custom_battle_designer_10_last_value"),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_9", "$g_presentation_obj_custom_battle_designer_9_last_value"),
          (else_try),
            (gt, ":var1", "$g_presentation_obj_custom_battle_designer_11_last_value"),
            (store_sub, ":var13", ":var1", "$g_presentation_obj_custom_battle_designer_11_last_value"),
            (try_begin),
              (eq, "$g_presentation_obj_custom_battle_designer_10_locked", 1),
              (assign, ":var14", 0),
              (assign, ":var15", ":var13"),
            (else_try),
              (eq, "$g_presentation_obj_custom_battle_designer_9_locked", 1),
              (assign, ":var14", ":var13"),
              (assign, ":var15", 0),
            (else_try),
              (store_div, ":var14", ":var13", 2),
              (store_sub, ":var15", ":var13", ":var14"),
              (try_begin),
                (neq, ":var14", ":var15"),
                (store_random_in_range, ":var16", 0, 2),
                (eq, ":var16", 0),
                (val_sub, ":var15", 1),
                (val_add, ":var14", 1),
              (try_end),
            (try_end),
            (assign, "$g_presentation_obj_custom_battle_designer_11_last_value", ":var1"),
            (val_sub, "$g_presentation_obj_custom_battle_designer_10_last_value", ":var14"),
            (val_sub, "$g_presentation_obj_custom_battle_designer_9_last_value", ":var15"),
            (try_begin),
              (lt, "$g_presentation_obj_custom_battle_designer_10_last_value", 0),
              (val_add, "$g_presentation_obj_custom_battle_designer_9_last_value", "$g_presentation_obj_custom_battle_designer_10_last_value"),
              (assign, "$g_presentation_obj_custom_battle_designer_10_last_value", 0),
            (else_try),
              (lt, "$g_presentation_obj_custom_battle_designer_9_last_value", 0),
              (val_add, "$g_presentation_obj_custom_battle_designer_10_last_value", "$g_presentation_obj_custom_battle_designer_9_last_value"),
              (assign, "$g_presentation_obj_custom_battle_designer_9_last_value", 0),
            (try_end),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_10", "$g_presentation_obj_custom_battle_designer_10_last_value"),
            (overlay_set_val, "$g_presentation_obj_custom_battle_designer_9", "$g_presentation_obj_custom_battle_designer_9_last_value"),
          (try_end),
          (assign, reg0, "$g_presentation_obj_custom_battle_designer_9_last_value"),
          (overlay_set_text, "$g_presentation_obj_custom_battle_designer_15", "str_reg0_percent"),
          (assign, reg0, "$g_presentation_obj_custom_battle_designer_10_last_value"),
          (overlay_set_text, "$g_presentation_obj_custom_battle_designer_16", "str_reg0_percent"),
          (assign, reg0, "$g_presentation_obj_custom_battle_designer_11_last_value"),
          (overlay_set_text, "$g_presentation_obj_custom_battle_designer_17", "str_reg0_percent"),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_custom_battle_designer_19"),
        (assign, "$g_is_quick_battle", 1),
        (assign, ":var17", "$g_quick_battle_map"),
        (try_begin),
          (eq, "$g_quick_battle_game_type", 0),
          (assign, ":var18", "mt_quick_battle_battle"),
          (modify_visitors_at_site, ":var17"),
          (call_script, "script_spawn_quick_battle_army", 0, "$g_quick_battle_team_1_faction", "$g_presentation_obj_custom_battle_designer_6_last_value", "$g_presentation_obj_custom_battle_designer_7_last_value", "$g_presentation_obj_custom_battle_designer_8_last_value", 0, 1),
          (call_script, "script_spawn_quick_battle_army", 16, "$g_quick_battle_team_2_faction", "$g_presentation_obj_custom_battle_designer_9_last_value", "$g_presentation_obj_custom_battle_designer_10_last_value", "$g_presentation_obj_custom_battle_designer_11_last_value", 0, 0),
        (else_try),
          (eq, "$g_quick_battle_game_type", 1),
          (assign, ":var18", "mt_quick_battle_siege"),
          (modify_visitors_at_site, ":var17"),
          (call_script, "script_spawn_quick_battle_army", 16, "$g_quick_battle_team_1_faction", "$g_presentation_obj_custom_battle_designer_6_last_value", "$g_presentation_obj_custom_battle_designer_7_last_value", "$g_presentation_obj_custom_battle_designer_8_last_value", 0, 1),
          (call_script, "script_spawn_quick_battle_army", 0, "$g_quick_battle_team_2_faction", "$g_presentation_obj_custom_battle_designer_9_last_value", "$g_presentation_obj_custom_battle_designer_10_last_value", "$g_presentation_obj_custom_battle_designer_11_last_value", 1, 0),
        (else_try),
          (assign, ":var18", "mt_quick_battle_siege"),
          (modify_visitors_at_site, ":var17"),
          (call_script, "script_spawn_quick_battle_army", 0, "$g_quick_battle_team_1_faction", "$g_presentation_obj_custom_battle_designer_6_last_value", "$g_presentation_obj_custom_battle_designer_7_last_value", "$g_presentation_obj_custom_battle_designer_8_last_value", 1, 1),
          (call_script, "script_spawn_quick_battle_army", 16, "$g_quick_battle_team_2_faction", "$g_presentation_obj_custom_battle_designer_9_last_value", "$g_presentation_obj_custom_battle_designer_10_last_value", "$g_presentation_obj_custom_battle_designer_11_last_value", 0, 0),
        (try_end),
        (set_jump_mission, ":var18"),
        (jump_to_menu, "mnu_custom_battle_end"),
        (jump_to_scene, ":var17"),
        (change_screen_mission),
        (presentation_set_duration, 0),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_custom_battle_designer_20"),
        (presentation_set_duration, 0),
      (try_end),
    ]),
    (ti_on_presentation_mouse_enter_leave,
    [
      (store_trigger_param_1, ":var0"),
      (store_trigger_param_2, ":var1"),
      (this_or_next|eq, ":var0", "$g_presentation_obj_custom_battle_designer_6"),
      (this_or_next|eq, ":var0", "$g_presentation_obj_custom_battle_designer_7"),
      (this_or_next|eq, ":var0", "$g_presentation_obj_custom_battle_designer_8"),
      (this_or_next|eq, ":var0", "$g_presentation_obj_custom_battle_designer_9"),
      (this_or_next|eq, ":var0", "$g_presentation_obj_custom_battle_designer_10"),
      (eq, ":var0", "$g_presentation_obj_custom_battle_designer_11"),
      (try_begin),
        (eq, ":var1", 1),
        (try_begin),
          (eq, ":var0", "$g_presentation_obj_custom_battle_last_mouse_over_object"),
          (assign, "$g_presentation_obj_custom_battle_last_mouse_over_object", -1),
        (try_end),
      (else_try),
        (assign, "$g_presentation_obj_custom_battle_last_mouse_over_object", ":var0"),
      (try_end),
    ]),
    (ti_on_presentation_run,
    [
      (try_begin),
        (key_clicked, key_escape),
        (presentation_set_duration, 0),
      (else_try),
        (key_clicked, key_right_mouse_button),
        (neq, "$g_presentation_obj_custom_battle_last_mouse_over_object", -1),
        (try_begin),
          (eq, "$g_presentation_obj_custom_battle_last_mouse_over_object", "$g_presentation_obj_custom_battle_designer_6"),
          (try_begin),
            (eq, "$g_presentation_obj_custom_battle_designer_6_locked", 0),
            (assign, "$g_presentation_obj_custom_battle_designer_6_locked", 1),
            (assign, "$g_presentation_obj_custom_battle_designer_7_locked", 0),
            (assign, "$g_presentation_obj_custom_battle_designer_8_locked", 0),
          (else_try),
            (assign, "$g_presentation_obj_custom_battle_designer_6_locked", 0),
          (try_end),
        (else_try),
          (eq, "$g_presentation_obj_custom_battle_last_mouse_over_object", "$g_presentation_obj_custom_battle_designer_7"),
          (try_begin),
            (eq, "$g_presentation_obj_custom_battle_designer_7_locked", 0),
            (assign, "$g_presentation_obj_custom_battle_designer_6_locked", 0),
            (assign, "$g_presentation_obj_custom_battle_designer_7_locked", 1),
            (assign, "$g_presentation_obj_custom_battle_designer_8_locked", 0),
          (else_try),
            (assign, "$g_presentation_obj_custom_battle_designer_7_locked", 0),
          (try_end),
        (else_try),
          (eq, "$g_presentation_obj_custom_battle_last_mouse_over_object", "$g_presentation_obj_custom_battle_designer_8"),
          (try_begin),
            (eq, "$g_presentation_obj_custom_battle_designer_8_locked", 0),
            (assign, "$g_presentation_obj_custom_battle_designer_6_locked", 0),
            (assign, "$g_presentation_obj_custom_battle_designer_7_locked", 0),
            (assign, "$g_presentation_obj_custom_battle_designer_8_locked", 1),
          (else_try),
            (assign, "$g_presentation_obj_custom_battle_designer_8_locked", 0),
          (try_end),
        (else_try),
          (eq, "$g_presentation_obj_custom_battle_last_mouse_over_object", "$g_presentation_obj_custom_battle_designer_9"),
          (try_begin),
            (eq, "$g_presentation_obj_custom_battle_designer_9_locked", 0),
            (assign, "$g_presentation_obj_custom_battle_designer_9_locked", 1),
            (assign, "$g_presentation_obj_custom_battle_designer_10_locked", 0),
            (assign, "$g_presentation_obj_custom_battle_designer_11_locked", 0),
          (else_try),
            (assign, "$g_presentation_obj_custom_battle_designer_9_locked", 0),
          (try_end),
        (else_try),
          (eq, "$g_presentation_obj_custom_battle_last_mouse_over_object", "$g_presentation_obj_custom_battle_designer_10"),
          (try_begin),
            (eq, "$g_presentation_obj_custom_battle_designer_10_locked", 0),
            (assign, "$g_presentation_obj_custom_battle_designer_9_locked", 0),
            (assign, "$g_presentation_obj_custom_battle_designer_10_locked", 1),
            (assign, "$g_presentation_obj_custom_battle_designer_11_locked", 0),
          (else_try),
            (assign, "$g_presentation_obj_custom_battle_designer_10_locked", 0),
          (try_end),
        (else_try),
          (eq, "$g_presentation_obj_custom_battle_last_mouse_over_object", "$g_presentation_obj_custom_battle_designer_11"),
          (try_begin),
            (eq, "$g_presentation_obj_custom_battle_designer_11_locked", 0),
            (assign, "$g_presentation_obj_custom_battle_designer_9_locked", 0),
            (assign, "$g_presentation_obj_custom_battle_designer_10_locked", 0),
            (assign, "$g_presentation_obj_custom_battle_designer_11_locked", 1),
          (else_try),
            (assign, "$g_presentation_obj_custom_battle_designer_11_locked", 0),
          (try_end),
        (try_end),
      (try_end),
    ]),
  ]),

  ("game_multiplayer_admin_panel", prsntf_manual_end_only, mesh_null,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (try_begin),
        (eq, "$g_multiplayer_selected_map", "scn_multi_scene_1"),
        (assign, ":var0", "mesh_mp_ui_host_maps_1"),
      (else_try),
        (eq, "$g_multiplayer_selected_map", "scn_multi_scene_2"),
        (assign, ":var0", "mesh_mp_ui_host_maps_2"),
      (else_try),
        (eq, "$g_multiplayer_selected_map", "scn_multi_scene_3"),
        (assign, ":var0", "mesh_mp_ui_host_maps_3"),
      (else_try),
        (eq, "$g_multiplayer_selected_map", "scn_multi_scene_4"),
        (assign, ":var0", "mesh_mp_ui_host_maps_4"),
      (else_try),
        (eq, "$g_multiplayer_selected_map", "scn_multi_scene_5"),
        (assign, ":var0", "mesh_mp_ui_host_maps_5"),
      (else_try),
        (eq, "$g_multiplayer_selected_map", "scn_multi_scene_6"),
        (assign, ":var0", "mesh_mp_ui_host_maps_6"),
      (else_try),
        (eq, "$g_multiplayer_selected_map", "scn_multi_scene_7"),
        (assign, ":var0", "mesh_mp_ui_host_maps_7"),
      (else_try),
        (eq, "$g_multiplayer_selected_map", "scn_multi_scene_8"),
        (assign, ":var0", "mesh_mp_ui_host_maps_8"),
      (else_try),
        (eq, "$g_multiplayer_selected_map", "scn_multi_scene_9"),
        (assign, ":var0", "mesh_mp_ui_host_maps_9"),
      (else_try),
        (eq, "$g_multiplayer_selected_map", "scn_multi_scene_10"),
        (assign, ":var0", "mesh_mp_ui_host_maps_10"),
      (else_try),
        (eq, "$g_multiplayer_selected_map", "scn_multi_scene_11"),
        (assign, ":var0", "mesh_mp_ui_host_maps_11"),
      (else_try),
        (eq, "$g_multiplayer_selected_map", "scn_multi_scene_12"),
        (assign, ":var0", "mesh_mp_ui_host_maps_12"),
      (else_try),
        (eq, "$g_multiplayer_selected_map", "scn_multi_scene_13"),
        (assign, ":var0", "mesh_mp_ui_host_maps_13"),
      (else_try),
        (eq, "$g_multiplayer_selected_map", "scn_multi_scene_14"),
        (assign, ":var0", "mesh_mp_ui_host_maps_14"),
      (else_try),
        (eq, "$g_multiplayer_selected_map", "scn_multi_scene_15"),
        (assign, ":var0", "mesh_mp_ui_host_maps_15"),
      (else_try),
        (eq, "$g_multiplayer_selected_map", "scn_multi_scene_16"),
        (assign, ":var0", "mesh_mp_ui_host_maps_16"),
      (else_try),
        (eq, "$g_multiplayer_selected_map", "scn_multi_scene_17"),
        (assign, ":var0", "mesh_mp_ui_host_maps_17"),
      (else_try),
        (eq, "$g_multiplayer_selected_map", "scn_multi_scene_18"),
        (assign, ":var0", "mesh_mp_ui_host_maps_18"),
      (else_try),
        (this_or_next|eq, "$g_multiplayer_selected_map", "scn_random_multi_plain_medium"),
        (eq, "$g_multiplayer_selected_map", "scn_random_multi_plain_large"),
        (assign, ":var0", "mesh_mp_ui_host_maps_randomp"),
      (else_try),
        (this_or_next|eq, "$g_multiplayer_selected_map", "scn_random_multi_steppe_medium"),
        (eq, "$g_multiplayer_selected_map", "scn_random_multi_steppe_large"),
        (assign, ":var0", "mesh_mp_ui_host_maps_randoms"),
      (else_try),
        (assign, ":var0", "mesh_mp_ui_host_maps_randomp"),
      (try_end),
      (create_mesh_overlay, reg0, ":var0"),
      (position_set_x, pos1, -1),
      (position_set_y, pos1, 550),
      (overlay_set_position, reg0, pos1),
      (position_set_x, pos1, 1002),
      (position_set_y, pos1, 1002),
      (overlay_set_size, reg0, pos1),
      (create_mesh_overlay, reg0, "mesh_mp_ui_host_main"),
      (position_set_x, pos1, -1),
      (position_set_y, pos1, -1),
      (overlay_set_position, reg0, pos1),
      (position_set_x, pos1, 1002),
      (position_set_y, pos1, 1002),
      (overlay_set_size, reg0, pos1),
      (assign, ":var1", 1240),
      (assign, ":var2", 40),
      (try_begin),
        (this_or_next|eq, "$g_multiplayer_game_type", 1),
        (this_or_next|eq, "$g_multiplayer_game_type", 2),
        (this_or_next|eq, "$g_multiplayer_game_type", 3),
        (this_or_next|eq, "$g_multiplayer_game_type", 4),
        (this_or_next|eq, "$g_multiplayer_game_type", 5),
        (eq, "$g_multiplayer_game_type", 6),
        (val_add, ":var1", ":var2"),
        (val_add, ":var1", ":var2"),
        (this_or_next|eq, "$g_multiplayer_game_type", 4),
        (this_or_next|eq, "$g_multiplayer_game_type", 2),
        (this_or_next|eq, "$g_multiplayer_game_type", 3),
        (eq, "$g_multiplayer_game_type", 6),
        (val_add, ":var1", ":var2"),
        (this_or_next|eq, "$g_multiplayer_game_type", 2),
        (this_or_next|eq, "$g_multiplayer_game_type", 3),
        (eq, "$g_multiplayer_game_type", 6),
        (val_add, ":var1", ":var2"),
        (this_or_next|eq, "$g_multiplayer_game_type", 2),
        (this_or_next|eq, "$g_multiplayer_game_type", 3),
        (eq, "$g_multiplayer_game_type", 6),
        (val_add, ":var1", ":var2"),
      (try_end),
      (str_clear, s0),
      (create_text_overlay, "$g_presentation_obj_admin_panel_container", s0, 8192),
      (position_set_x, pos1, 59),
      (position_set_y, pos1, 50),
      (overlay_set_position, "$g_presentation_obj_admin_panel_container", pos1),
      (position_set_x, pos1, 640),
      (position_set_y, pos1, 520),
      (overlay_set_area_size, "$g_presentation_obj_admin_panel_container", pos1),
      (945, "$g_presentation_obj_admin_panel_container"),
      (create_text_overlay, reg0, "str_add_to_official_game_servers_list", 0),
      (position_set_x, pos1, 30),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, reg0, pos1),
      (create_check_box_overlay, "$g_presentation_obj_admin_panel_14", "mesh_checkbox_off", "mesh_checkbox_on"),
      (position_set_x, pos1, 7),
      (store_add, ":var3", ":var1", 7),
      (position_set_y, pos1, ":var3"),
      (overlay_set_position, "$g_presentation_obj_admin_panel_14", pos1),
      (485, ":var4"),
      (overlay_set_val, "$g_presentation_obj_admin_panel_14", ":var4"),
      (val_sub, ":var1", ":var2"),
      (create_text_overlay, reg0, "str_enable_valve_anti_cheat", 0),
      (position_set_x, pos1, 30),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, reg0, pos1),
      (create_check_box_overlay, "$g_presentation_obj_admin_panel_41", "mesh_checkbox_off", "mesh_checkbox_on"),
      (position_set_x, pos1, 7),
      (store_add, ":var3", ":var1", 7),
      (position_set_y, pos1, ":var3"),
      (overlay_set_position, "$g_presentation_obj_admin_panel_41", pos1),
      (499, ":var5"),
      (overlay_set_val, "$g_presentation_obj_admin_panel_41", ":var5"),
      (val_sub, ":var1", ":var2"),
      (create_text_overlay, reg0, "str_server_name", 0),
      (position_set_x, pos1, 0),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, reg0, pos1),
      (2352, 0),
      (try_begin),
        (eq, "$g_multiplayer_renaming_server_allowed", 1),
        (919, "$g_presentation_obj_admin_panel_20"),
        (position_set_x, pos1, 390),
        (position_set_y, pos1, ":var1"),
        (overlay_set_position, "$g_presentation_obj_admin_panel_20", pos1),
        (overlay_set_text, "$g_presentation_obj_admin_panel_20", s0),
      (else_try),
        (assign, "$g_presentation_obj_admin_panel_20", -1),
        (create_text_overlay, reg0, s0, 0),
        (position_set_x, pos1, 385),
        (position_set_y, pos1, ":var1"),
        (overlay_set_position, reg0, pos1),
      (try_end),
      (val_sub, ":var1", ":var2"),
      (create_text_overlay, reg0, "str_game_password", 0),
      (position_set_x, pos1, 0),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, reg0, pos1),
      (919, "$g_presentation_obj_admin_panel_9"),
      (position_set_x, pos1, 390),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, "$g_presentation_obj_admin_panel_9", pos1),
      (2351, 0),
      (overlay_set_text, "$g_presentation_obj_admin_panel_9", s0),
      (val_sub, ":var1", ":var2"),
      (create_text_overlay, reg0, "str_welcome_message", 0),
      (position_set_x, pos1, 0),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, reg0, pos1),
      (919, "$g_presentation_obj_admin_panel_32"),
      (position_set_x, pos1, 390),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, "$g_presentation_obj_admin_panel_32", pos1),
      (2353, 0),
      (overlay_set_text, "$g_presentation_obj_admin_panel_32", s0),
      (val_sub, ":var1", ":var2"),
      (create_text_overlay, reg0, "str_map", 0),
      (position_set_x, pos1, 0),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, reg0, pos1),
      (call_script, "script_multiplayer_fill_map_game_types", "$g_multiplayer_game_type"),
      (assign, ":var6", reg0),
      (assign, ":var7", 0),
      (try_begin),
        (gt, ":var6", 12),
        (948, "$g_presentation_obj_admin_panel_1"),
      (else_try),
        (create_combo_button_overlay, "$g_presentation_obj_admin_panel_1"),
      (try_end),
      (position_set_x, pos1, 800),
      (position_set_y, pos1, 800),
      (overlay_set_size, "$g_presentation_obj_admin_panel_1", pos1),
      (try_begin),
        (gt, ":var6", 14),
        (position_set_x, pos1, 465),
      (else_try),
        (position_set_x, pos1, 490),
      (try_end),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, "$g_presentation_obj_admin_panel_1", pos1),
      (troop_get_slot, ":var8", "trp_multiplayer_data", 0),
      (assign, ":var9", 0),
      (try_for_range, ":var10", 0, ":var6"),
        (store_add, ":var11", ":var10", 0),
        (troop_get_slot, ":var12", "trp_multiplayer_data", ":var11"),
        (store_sub, ":var13", ":var12", "scn_multi_scene_1"),
        (val_add, ":var13", "str_multi_scene_1"),
        (str_store_string, s0, ":var13"),
        (overlay_add_item, "$g_presentation_obj_admin_panel_1", s0),
        (try_begin),
          (eq, ":var12", "$g_multiplayer_selected_map"),
          (assign, ":var7", ":var10"),
          (assign, ":var9", 1),
        (try_end),
      (try_end),
      (overlay_set_val, "$g_presentation_obj_admin_panel_1", ":var7"),
      (val_sub, ":var1", ":var2"),
      (create_text_overlay, reg0, "str_game_type", 0),
      (position_set_x, pos1, 0),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, reg0, pos1),
      (try_begin),
        (eq, "$g_multiplayer_changing_game_type_allowed", 1),
        (create_combo_button_overlay, "$g_presentation_obj_admin_panel_10"),
        (position_set_x, pos1, 800),
        (position_set_y, pos1, 800),
        (overlay_set_size, "$g_presentation_obj_admin_panel_10", pos1),
        (position_set_x, pos1, 490),
        (position_set_y, pos1, ":var1"),
        (overlay_set_position, "$g_presentation_obj_admin_panel_10", pos1),
        (try_for_range, ":var14", 0, 8),
          (store_add, ":var13", ":var14", "str_multi_game_type_1"),
          (str_store_string, s0, ":var13"),
          (overlay_add_item, "$g_presentation_obj_admin_panel_10", s0),
        (try_end),
        (overlay_set_val, "$g_presentation_obj_admin_panel_10", "$g_multiplayer_game_type"),
      (else_try),
        (assign, "$g_presentation_obj_admin_panel_10", -1),
        (store_add, ":var13", "$g_multiplayer_game_type", "str_multi_game_type_1"),
        (str_store_string, s0, ":var13"),
        (create_text_overlay, reg0, s0, 0),
        (position_set_x, pos1, 385),
        (position_set_y, pos1, ":var1"),
        (overlay_set_position, reg0, pos1),
      (try_end),
      (val_sub, ":var1", ":var2"),
      (assign, reg1, 1),
      (create_text_overlay, reg0, "str_team_reg1_faction", 0),
      (position_set_x, pos1, 0),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, reg0, pos1),
      (create_combo_button_overlay, "$g_presentation_obj_admin_panel_11"),
      (position_set_x, pos1, 800),
      (position_set_y, pos1, 800),
      (overlay_set_size, "$g_presentation_obj_admin_panel_11", pos1),
      (position_set_x, pos1, 490),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, "$g_presentation_obj_admin_panel_11", pos1),
      (call_script, "script_multiplayer_fill_available_factions_combo_button", "$g_presentation_obj_admin_panel_11", "$g_multiplayer_next_team_1_faction", "$g_multiplayer_next_team_2_faction"),
      (val_sub, ":var1", ":var2"),
      (assign, reg1, 2),
      (create_text_overlay, reg0, "str_team_reg1_faction", 0),
      (position_set_x, pos1, 0),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, reg0, pos1),
      (create_combo_button_overlay, "$g_presentation_obj_admin_panel_12"),
      (position_set_x, pos1, 800),
      (position_set_y, pos1, 800),
      (overlay_set_size, "$g_presentation_obj_admin_panel_12", pos1),
      (position_set_x, pos1, 490),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, "$g_presentation_obj_admin_panel_12", pos1),
      (call_script, "script_multiplayer_fill_available_factions_combo_button", "$g_presentation_obj_admin_panel_12", "$g_multiplayer_next_team_2_faction", "$g_multiplayer_next_team_1_faction"),
      (val_sub, ":var1", ":var2"),
      (assign, reg1, 1),
      (create_text_overlay, reg0, "str_max_number_of_players", 0),
      (position_set_x, pos1, 0),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, reg0, pos1),
      (942, "$g_presentation_obj_admin_panel_21", 2, 65),
      (position_set_x, pos1, 390),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, "$g_presentation_obj_admin_panel_21", pos1),
      (490, ":var15"),
      (overlay_set_val, "$g_presentation_obj_admin_panel_21", ":var15"),
      (val_sub, ":var1", ":var2"),
      (assign, reg1, 1),
      (create_text_overlay, reg0, "str_number_of_bots_in_team_reg1", 0),
      (position_set_x, pos1, 0),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, reg0, pos1),
      (942, "$g_presentation_obj_admin_panel_3", 0, "$g_multiplayer_max_num_bots"),
      (position_set_x, pos1, 390),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, "$g_presentation_obj_admin_panel_3", pos1),
      (overlay_set_val, "$g_presentation_obj_admin_panel_3", "$g_multiplayer_num_bots_team_1"),
      (val_sub, ":var1", ":var2"),
      (assign, reg1, 2),
      (create_text_overlay, reg0, "str_number_of_bots_in_team_reg1", 0),
      (position_set_x, pos1, 0),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, reg0, pos1),
      (942, "$g_presentation_obj_admin_panel_4", 0, "$g_multiplayer_max_num_bots"),
      (position_set_x, pos1, 390),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, "$g_presentation_obj_admin_panel_4", pos1),
      (overlay_set_val, "$g_presentation_obj_admin_panel_4", "$g_multiplayer_num_bots_team_2"),
      (try_begin),
        (neq, "$g_multiplayer_game_type", 0),
        (neq, "$g_multiplayer_game_type", 7),
        (val_sub, ":var1", ":var2"),
        (create_text_overlay, reg0, "str_allow_friendly_fire", 0),
        (position_set_x, pos1, 30),
        (position_set_y, pos1, ":var1"),
        (overlay_set_position, reg0, pos1),
        (create_check_box_overlay, "$g_presentation_obj_admin_panel_5", "mesh_checkbox_off", "mesh_checkbox_on"),
        (position_set_x, pos1, 7),
        (store_add, ":var3", ":var1", 7),
        (position_set_y, pos1, ":var3"),
        (overlay_set_position, "$g_presentation_obj_admin_panel_5", pos1),
        (480, ":var16"),
        (overlay_set_val, "$g_presentation_obj_admin_panel_5", ":var16"),
        (val_sub, ":var1", ":var2"),
        (create_text_overlay, reg0, "str_allow_melee_friendly_fire", 0),
        (position_set_x, pos1, 30),
        (position_set_y, pos1, ":var1"),
        (overlay_set_position, reg0, pos1),
        (create_check_box_overlay, "$g_presentation_obj_admin_panel_36", "mesh_checkbox_off", "mesh_checkbox_on"),
        (position_set_x, pos1, 7),
        (store_add, ":var3", ":var1", 7),
        (position_set_y, pos1, ":var3"),
        (overlay_set_position, "$g_presentation_obj_admin_panel_36", pos1),
        (493, ":var17"),
        (overlay_set_val, "$g_presentation_obj_admin_panel_36", ":var17"),
      (try_end),
      (val_sub, ":var1", ":var2"),
      (create_text_overlay, reg0, "str_friendly_fire_damage_self_ratio", 0),
      (position_set_x, pos1, 0),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, reg0, pos1),
      (942, "$g_presentation_obj_admin_panel_37", 0, 101),
      (position_set_x, pos1, 390),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, "$g_presentation_obj_admin_panel_37", pos1),
      (495, ":var18"),
      (overlay_set_val, "$g_presentation_obj_admin_panel_37", ":var18"),
      (val_sub, ":var1", ":var2"),
      (create_text_overlay, reg0, "str_friendly_fire_damage_friend_ratio", 0),
      (position_set_x, pos1, 0),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, reg0, pos1),
      (942, "$g_presentation_obj_admin_panel_38", 0, 101),
      (position_set_x, pos1, 390),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, "$g_presentation_obj_admin_panel_38", pos1),
      (497, ":var19"),
      (overlay_set_val, "$g_presentation_obj_admin_panel_38", ":var19"),
      (val_sub, ":var1", ":var2"),
      (create_text_overlay, reg0, "str_spectator_camera", 0),
      (position_set_x, pos1, 0),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, reg0, pos1),
      (create_combo_button_overlay, "$g_presentation_obj_admin_panel_19"),
      (position_set_x, pos1, 800),
      (position_set_y, pos1, 800),
      (overlay_set_size, "$g_presentation_obj_admin_panel_19", pos1),
      (position_set_x, pos1, 490),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, "$g_presentation_obj_admin_panel_19", pos1),
      (overlay_add_item, "$g_presentation_obj_admin_panel_19", "str_free"),
      (overlay_add_item, "$g_presentation_obj_admin_panel_19", "str_stick_to_any_player"),
      (overlay_add_item, "$g_presentation_obj_admin_panel_19", "str_stick_to_team_members"),
      (overlay_add_item, "$g_presentation_obj_admin_panel_19", "str_stick_to_team_members_view"),
      (487, ":var20"),
      (overlay_set_val, "$g_presentation_obj_admin_panel_19", ":var20"),
      (val_sub, ":var1", ":var2"),
      (create_text_overlay, reg0, "str_control_block_direction", 0),
      (position_set_x, pos1, 0),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, reg0, pos1),
      (create_combo_button_overlay, "$g_presentation_obj_admin_panel_15"),
      (position_set_x, pos1, 800),
      (position_set_y, pos1, 800),
      (overlay_set_size, "$g_presentation_obj_admin_panel_15", pos1),
      (position_set_x, pos1, 490),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, "$g_presentation_obj_admin_panel_15", pos1),
      (overlay_add_item, "$g_presentation_obj_admin_panel_15", "str_automatic"),
      (overlay_add_item, "$g_presentation_obj_admin_panel_15", "str_by_mouse_movement"),
      (482, ":var21"),
      (overlay_set_val, "$g_presentation_obj_admin_panel_15", ":var21"),
      (val_sub, ":var1", ":var2"),
      (create_text_overlay, reg0, "str_combat_speed", 0),
      (position_set_x, pos1, 0),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, reg0, pos1),
      (create_combo_button_overlay, "$g_presentation_obj_admin_panel_26"),
      (position_set_x, pos1, 800),
      (position_set_y, pos1, 800),
      (overlay_set_size, "$g_presentation_obj_admin_panel_26", pos1),
      (position_set_x, pos1, 490),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, "$g_presentation_obj_admin_panel_26", pos1),
      (overlay_add_item, "$g_presentation_obj_admin_panel_26", "str_combat_speed_0"),
      (overlay_add_item, "$g_presentation_obj_admin_panel_26", "str_combat_speed_1"),
      (overlay_add_item, "$g_presentation_obj_admin_panel_26", "str_combat_speed_2"),
      (overlay_add_item, "$g_presentation_obj_admin_panel_26", "str_combat_speed_3"),
      (overlay_add_item, "$g_presentation_obj_admin_panel_26", "str_combat_speed_4"),
      (478, ":var22"),
      (overlay_set_val, "$g_presentation_obj_admin_panel_26", ":var22"),
      (try_begin),
        (neq, "$g_multiplayer_game_type", 5),
        (val_sub, ":var1", ":var2"),
        (create_text_overlay, reg0, "str_map_time_limit", 0),
        (position_set_x, pos1, 0),
        (position_set_y, pos1, ":var1"),
        (overlay_set_position, reg0, pos1),
        (942, "$g_presentation_obj_admin_panel_7", 5, 121),
        (position_set_x, pos1, 390),
        (position_set_y, pos1, ":var1"),
        (overlay_set_position, "$g_presentation_obj_admin_panel_7", pos1),
        (overlay_set_val, "$g_presentation_obj_admin_panel_7", "$g_multiplayer_game_max_minutes"),
      (else_try),
        (assign, "$g_presentation_obj_admin_panel_7", -1),
      (try_end),
      (try_begin),
        (this_or_next|eq, "$g_multiplayer_game_type", 2),
        (this_or_next|eq, "$g_multiplayer_game_type", 3),
        (eq, "$g_multiplayer_game_type", 6),
        (val_sub, ":var1", ":var2"),
        (create_text_overlay, reg0, "str_round_time_limit", 0),
        (position_set_x, pos1, 0),
        (position_set_y, pos1, ":var1"),
        (overlay_set_position, reg0, pos1),
        (942, "$g_presentation_obj_admin_panel_16", 60, 901),
        (position_set_x, pos1, 390),
        (position_set_y, pos1, ":var1"),
        (overlay_set_position, "$g_presentation_obj_admin_panel_16", pos1),
        (overlay_set_val, "$g_presentation_obj_admin_panel_16", "$g_multiplayer_round_max_seconds"),
      (else_try),
        (assign, "$g_presentation_obj_admin_panel_16", -1),
      (try_end),
      (try_begin),
        (this_or_next|eq, "$g_multiplayer_game_type", 2),
        (eq, "$g_multiplayer_game_type", 3),
        (val_sub, ":var1", ":var2"),
        (create_text_overlay, reg0, "str_players_take_control_of_a_bot_after_death", 0),
        (position_set_x, pos1, 30),
        (position_set_y, pos1, ":var1"),
        (overlay_set_position, reg0, pos1),
        (create_check_box_overlay, "$g_presentation_obj_admin_panel_25", "mesh_checkbox_off", "mesh_checkbox_on"),
        (position_set_x, pos1, 7),
        (store_add, ":var3", ":var1", 7),
        (position_set_y, pos1, ":var3"),
        (overlay_set_position, "$g_presentation_obj_admin_panel_25", pos1),
        (overlay_set_val, "$g_presentation_obj_admin_panel_25", "$g_multiplayer_player_respawn_as_bot"),
      (else_try),
        (assign, "$g_presentation_obj_admin_panel_25", -1),
      (try_end),
      (try_begin),
        (eq, "$g_multiplayer_game_type", 6),
        (val_sub, ":var1", ":var2"),
        (create_text_overlay, reg0, "str_defender_spawn_count_limit", 0),
        (position_set_x, pos1, 0),
        (position_set_y, pos1, ":var1"),
        (overlay_set_position, reg0, pos1),
        (create_combo_button_overlay, "$g_presentation_obj_admin_panel_27"),
        (position_set_x, pos1, 800),
        (position_set_y, pos1, 800),
        (overlay_set_size, "$g_presentation_obj_admin_panel_27", pos1),
        (position_set_x, pos1, 490),
        (position_set_y, pos1, ":var1"),
        (overlay_set_position, "$g_presentation_obj_admin_panel_27", pos1),
        (assign, reg0, 5),
        (overlay_add_item, "$g_presentation_obj_admin_panel_27", "str_reg0"),
        (assign, reg0, 4),
        (overlay_add_item, "$g_presentation_obj_admin_panel_27", "str_reg0"),
        (assign, reg0, 3),
        (overlay_add_item, "$g_presentation_obj_admin_panel_27", "str_reg0"),
        (assign, reg0, 2),
        (overlay_add_item, "$g_presentation_obj_admin_panel_27", "str_reg0"),
        (assign, reg0, 1),
        (overlay_add_item, "$g_presentation_obj_admin_panel_27", "str_reg0"),
        (overlay_add_item, "$g_presentation_obj_admin_panel_27", "str_unlimited"),
        (store_sub, ":var23", 5, "$g_multiplayer_number_of_respawn_count"),
        (overlay_set_val, "$g_presentation_obj_admin_panel_27", ":var23"),
      (else_try),
        (assign, "$g_presentation_obj_admin_panel_27", -1),
      (try_end),
      (val_sub, ":var1", ":var2"),
      (create_text_overlay, reg0, "str_team_points_limit", 0),
      (position_set_x, pos1, 0),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, reg0, pos1),
      (942, "$g_presentation_obj_admin_panel_8", 3, 1001),
      (position_set_x, pos1, 390),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, "$g_presentation_obj_admin_panel_8", pos1),
      (overlay_set_val, "$g_presentation_obj_admin_panel_8", "$g_multiplayer_game_max_points"),
      (try_begin),
        (eq, "$g_multiplayer_game_type", 5),
        (val_sub, ":var1", ":var2"),
        (create_text_overlay, reg0, "str_point_gained_from_flags", 0),
        (position_set_x, pos1, 0),
        (position_set_y, pos1, ":var1"),
        (overlay_set_position, reg0, pos1),
        (942, "$g_presentation_obj_admin_panel_17", 25, 401),
        (position_set_x, pos1, 390),
        (position_set_y, pos1, ":var1"),
        (overlay_set_position, "$g_presentation_obj_admin_panel_17", pos1),
        (overlay_set_val, "$g_presentation_obj_admin_panel_17", "$g_multiplayer_point_gained_from_flags"),
      (else_try),
        (assign, "$g_presentation_obj_admin_panel_17", -1),
      (try_end),
      (try_begin),
        (eq, "$g_multiplayer_game_type", 4),
        (val_sub, ":var1", ":var2"),
        (create_text_overlay, reg0, "str_point_gained_from_capturing_flag", 0),
        (position_set_x, pos1, 0),
        (position_set_y, pos1, ":var1"),
        (overlay_set_position, reg0, pos1),
        (942, "$g_presentation_obj_admin_panel_18", 0, 11),
        (position_set_x, pos1, 390),
        (position_set_y, pos1, ":var1"),
        (overlay_set_position, "$g_presentation_obj_admin_panel_18", pos1),
        (overlay_set_val, "$g_presentation_obj_admin_panel_18", "$g_multiplayer_point_gained_from_capturing_flag"),
      (else_try),
        (assign, "$g_presentation_obj_admin_panel_18", -1),
      (try_end),
      (val_sub, ":var1", ":var2"),
      (create_text_overlay, reg0, "str_respawn_period", 0),
      (position_set_x, pos1, 0),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, reg0, pos1),
      (942, "$g_presentation_obj_admin_panel_6", 3, 31),
      (position_set_x, pos1, 390),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, "$g_presentation_obj_admin_panel_6", pos1),
      (overlay_set_val, "$g_presentation_obj_admin_panel_6", "$g_multiplayer_respawn_period"),
      (val_sub, ":var1", ":var2"),
      (create_text_overlay, reg0, "str_initial_gold_multiplier", 0),
      (position_set_x, pos1, 0),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, reg0, pos1),
      (942, "$g_presentation_obj_admin_panel_33", 0, 1001),
      (position_set_x, pos1, 390),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, "$g_presentation_obj_admin_panel_33", pos1),
      (overlay_set_val, "$g_presentation_obj_admin_panel_33", "$g_multiplayer_initial_gold_multiplier"),
      (val_sub, ":var1", ":var2"),
      (create_text_overlay, reg0, "str_battle_earnings_multiplier", 0),
      (position_set_x, pos1, 0),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, reg0, pos1),
      (942, "$g_presentation_obj_admin_panel_34", 0, 1001),
      (position_set_x, pos1, 390),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, "$g_presentation_obj_admin_panel_34", pos1),
      (overlay_set_val, "$g_presentation_obj_admin_panel_34", "$g_multiplayer_battle_earnings_multiplier"),
      (try_begin),
        (this_or_next|eq, "$g_multiplayer_game_type", 2),
        (this_or_next|eq, "$g_multiplayer_game_type", 3),
        (eq, "$g_multiplayer_game_type", 6),
        (val_sub, ":var1", ":var2"),
        (create_text_overlay, reg0, "str_round_earnings_multiplier", 0),
        (position_set_x, pos1, 0),
        (position_set_y, pos1, ":var1"),
        (overlay_set_position, reg0, pos1),
        (942, "$g_presentation_obj_admin_panel_35", 0, 1001),
        (position_set_x, pos1, 390),
        (position_set_y, pos1, ":var1"),
        (overlay_set_position, "$g_presentation_obj_admin_panel_35", pos1),
        (overlay_set_val, "$g_presentation_obj_admin_panel_35", "$g_multiplayer_round_earnings_multiplier"),
      (else_try),
        (assign, "$g_presentation_obj_admin_panel_35", -1),
      (try_end),
      (val_sub, ":var1", ":var2"),
      (create_text_overlay, reg0, "str_make_kick_voteable", 0),
      (position_set_x, pos1, 30),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, reg0, pos1),
      (create_check_box_overlay, "$g_presentation_obj_admin_panel_28", "mesh_checkbox_off", "mesh_checkbox_on"),
      (position_set_x, pos1, 7),
      (store_add, ":var3", ":var1", 7),
      (position_set_y, pos1, ":var3"),
      (overlay_set_position, "$g_presentation_obj_admin_panel_28", pos1),
      (overlay_set_val, "$g_presentation_obj_admin_panel_28", "$g_multiplayer_kick_voteable"),
      (val_sub, ":var1", ":var2"),
      (create_text_overlay, reg0, "str_make_ban_voteable", 0),
      (position_set_x, pos1, 30),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, reg0, pos1),
      (create_check_box_overlay, "$g_presentation_obj_admin_panel_29", "mesh_checkbox_off", "mesh_checkbox_on"),
      (position_set_x, pos1, 7),
      (store_add, ":var3", ":var1", 7),
      (position_set_y, pos1, ":var3"),
      (overlay_set_position, "$g_presentation_obj_admin_panel_29", pos1),
      (overlay_set_val, "$g_presentation_obj_admin_panel_29", "$g_multiplayer_ban_voteable"),
      (val_sub, ":var1", ":var2"),
      (create_text_overlay, reg0, "str_make_maps_voteable", 0),
      (position_set_x, pos1, 30),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, reg0, pos1),
      (create_check_box_overlay, "$g_presentation_obj_admin_panel_24", "mesh_checkbox_off", "mesh_checkbox_on"),
      (position_set_x, pos1, 7),
      (store_add, ":var3", ":var1", 7),
      (position_set_y, pos1, ":var3"),
      (overlay_set_position, "$g_presentation_obj_admin_panel_24", pos1),
      (overlay_set_val, "$g_presentation_obj_admin_panel_24", "$g_multiplayer_maps_voteable"),
      (val_sub, ":var1", ":var2"),
      (create_text_overlay, reg0, "str_make_factions_voteable", 0),
      (position_set_x, pos1, 30),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, reg0, pos1),
      (create_check_box_overlay, "$g_presentation_obj_admin_panel_23", "mesh_checkbox_off", "mesh_checkbox_on"),
      (position_set_x, pos1, 7),
      (store_add, ":var3", ":var1", 7),
      (position_set_y, pos1, ":var3"),
      (overlay_set_position, "$g_presentation_obj_admin_panel_23", pos1),
      (overlay_set_val, "$g_presentation_obj_admin_panel_23", "$g_multiplayer_factions_voteable"),
      (val_sub, ":var1", ":var2"),
      (create_text_overlay, reg0, "str_bots_upper_limit_for_votes", 0),
      (position_set_x, pos1, 0),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, reg0, pos1),
      (assign, ":var24", 51),
      (val_min, ":var24", "$g_multiplayer_max_num_bots"),
      (942, "$g_presentation_obj_admin_panel_22", 0, ":var24"),
      (position_set_x, pos1, 390),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, "$g_presentation_obj_admin_panel_22", pos1),
      (overlay_set_val, "$g_presentation_obj_admin_panel_22", "$g_multiplayer_num_bots_voteable"),
      (val_sub, ":var1", ":var2"),
      (create_text_overlay, reg0, "str_valid_vote_ratio", 0),
      (position_set_x, pos1, 0),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, reg0, pos1),
      (942, "$g_presentation_obj_admin_panel_30", 50, 101),
      (position_set_x, pos1, 390),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, "$g_presentation_obj_admin_panel_30", pos1),
      (overlay_set_val, "$g_presentation_obj_admin_panel_30", "$g_multiplayer_valid_vote_ratio"),
      (val_sub, ":var1", ":var2"),
      (create_text_overlay, reg0, "str_auto_team_balance_limit", 0),
      (position_set_x, pos1, 0),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, reg0, pos1),
      (create_combo_button_overlay, "$g_presentation_obj_admin_panel_31"),
      (position_set_x, pos1, 800),
      (position_set_y, pos1, 800),
      (overlay_set_size, "$g_presentation_obj_admin_panel_31", pos1),
      (position_set_x, pos1, 490),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, "$g_presentation_obj_admin_panel_31", pos1),
      (overlay_add_item, "$g_presentation_obj_admin_panel_31", "str_unlimited"),
      (assign, reg0, 6),
      (overlay_add_item, "$g_presentation_obj_admin_panel_31", "str_reg0"),
      (assign, reg0, 5),
      (overlay_add_item, "$g_presentation_obj_admin_panel_31", "str_reg0"),
      (assign, reg0, 4),
      (overlay_add_item, "$g_presentation_obj_admin_panel_31", "str_reg0"),
      (assign, reg0, 3),
      (overlay_add_item, "$g_presentation_obj_admin_panel_31", "str_reg0"),
      (assign, reg0, 2),
      (overlay_add_item, "$g_presentation_obj_admin_panel_31", "str_reg0"),
      (try_begin),
        (ge, "$g_multiplayer_auto_team_balance_limit", 1000),
        (overlay_set_val, "$g_presentation_obj_admin_panel_31", 0),
      (else_try),
        (store_sub, ":var25", 7, "$g_multiplayer_auto_team_balance_limit"),
        (overlay_set_val, "$g_presentation_obj_admin_panel_31", ":var25"),
      (try_end),
      (val_sub, ":var1", ":var2"),
      (create_text_overlay, reg0, "str_allow_player_banners", 0),
      (position_set_x, pos1, 30),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, reg0, pos1),
      (create_check_box_overlay, "$g_presentation_obj_admin_panel_39", "mesh_checkbox_off", "mesh_checkbox_on"),
      (position_set_x, pos1, 7),
      (store_add, ":var3", ":var1", 7),
      (position_set_y, pos1, ":var3"),
      (overlay_set_position, "$g_presentation_obj_admin_panel_39", pos1),
      (overlay_set_val, "$g_presentation_obj_admin_panel_39", "$g_multiplayer_allow_player_banners"),
      (val_sub, ":var1", ":var2"),
      (create_text_overlay, reg0, "str_disallow_ranged_weapons", 0),
      (position_set_x, pos1, 30),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, reg0, pos1),
      (create_check_box_overlay, "$g_presentation_obj_admin_panel_42", "mesh_checkbox_off", "mesh_checkbox_on"),
      (position_set_x, pos1, 7),
      (store_add, ":var3", ":var1", 7),
      (position_set_y, pos1, ":var3"),
      (overlay_set_position, "$g_presentation_obj_admin_panel_42", pos1),
      (overlay_set_val, "$g_presentation_obj_admin_panel_42", "$g_multiplayer_disallow_ranged_weapons"),
      (val_sub, ":var1", ":var2"),
      (create_text_overlay, reg0, "str_force_default_armor", 0),
      (position_set_x, pos1, 30),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, reg0, pos1),
      (create_check_box_overlay, "$g_presentation_obj_admin_panel_40", "mesh_checkbox_off", "mesh_checkbox_on"),
      (position_set_x, pos1, 7),
      (store_add, ":var3", ":var1", 7),
      (position_set_y, pos1, ":var3"),
      (overlay_set_position, "$g_presentation_obj_admin_panel_40", pos1),
      (overlay_set_val, "$g_presentation_obj_admin_panel_40", "$g_multiplayer_force_default_armor"),
      (945, -1),
      (create_button_overlay, "$g_presentation_obj_admin_panel_13", "str_back", 16),
      (position_set_x, pos1, 825),
      (position_set_y, pos1, 50),
      (overlay_set_position, "$g_presentation_obj_admin_panel_13", pos1),
      (position_set_x, pos1, 1500),
      (position_set_y, pos1, 1500),
      (overlay_set_size, "$g_presentation_obj_admin_panel_13", pos1),
      (create_button_overlay, "$g_presentation_obj_admin_panel_2", "str_start_map", 16),
      (position_set_x, pos1, 825),
      (position_set_y, pos1, 90),
      (overlay_set_position, "$g_presentation_obj_admin_panel_2", pos1),
      (position_set_x, pos1, 1500),
      (position_set_y, pos1, 1500),
      (overlay_set_size, "$g_presentation_obj_admin_panel_2", pos1),
#COOP BEGIN############################################################
      (try_begin),
        (eq, "$coop_battle_state", coop_battle_state_setup_sp),
        (create_button_overlay, "$g_presentation_obj_admin_panel_43", "@Co-op Admin Panel", tf_center_justify),
        (position_set_x, pos1, 825),
        (position_set_y, pos1, 130),
        (overlay_set_position, "$g_presentation_obj_admin_panel_43", pos1),
        (position_set_x, pos1, 1500),
        (position_set_y, pos1, 1500),
        (overlay_set_size, "$g_presentation_obj_admin_panel_43", pos1),
      (try_end),
#COOP END#############################################################      
      (presentation_set_duration, 999999),
      (try_begin),
        (eq, ":var9", 0),
        (assign, "$g_multiplayer_selected_map", ":var8"),
        (presentation_set_duration, 0),
        (start_presentation, "prsnt_game_multiplayer_admin_panel"),
      (try_end),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (store_trigger_param_2, ":var1"),
      (try_begin),
        (eq, ":var0", "$g_presentation_obj_admin_panel_1"),
        (store_add, ":var2", ":var1", 0),
        (troop_get_slot, "$g_multiplayer_selected_map", "trp_multiplayer_data", ":var2"),
        (presentation_set_duration, 0),
        (start_presentation, "prsnt_game_multiplayer_admin_panel"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_2"),
        (390, 2, "$g_multiplayer_selected_map", "$g_multiplayer_game_type"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_3"),
        (390, 4, 1, ":var1"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_4"),
        (390, 4, 2, ":var1"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_5"),
        (389, 5, ":var1"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_6"),
        (389, 9, ":var1"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_7"),
        (389, 10, ":var1"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_8"),
        (389, 12, ":var1"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_9"),
        (393, 16, 0),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_10"),
        (assign, "$g_multiplayer_game_type", ":var1"),
        (presentation_set_duration, 0),
        (start_presentation, "prsnt_game_multiplayer_admin_panel"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_11"),
        (store_add, "$g_multiplayer_next_team_1_faction", ":var1", "fac_kingdom_1"),
        (390, 17, 1, "$g_multiplayer_next_team_1_faction"),
        (presentation_set_duration, 0),
        (start_presentation, "prsnt_game_multiplayer_admin_panel"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_12"),
        (store_add, "$g_multiplayer_next_team_2_faction", ":var1", "fac_kingdom_1"),
        (390, 17, 2, "$g_multiplayer_next_team_2_faction"),
        (presentation_set_duration, 0),
        (start_presentation, "prsnt_game_multiplayer_admin_panel"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_13"),
        (presentation_set_duration, 0),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_14"),
        (389, 8, ":var1"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_15"),
        (389, 7, ":var1"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_16"),
        (389, 11, ":var1"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_17"),
        (389, 13, ":var1"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_18"),
        (389, 14, ":var1"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_19"),
        (389, 6, ":var1"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_20"),
        (393, 15, 0),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_21"),
        (389, 3, ":var1"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_22"),
        (389, 25, ":var1"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_23"),
        (389, 26, ":var1"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_24"),
        (389, 27, ":var1"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_25"),
        (389, 28, ":var1"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_26"),
        (389, 29, ":var1"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_27"),
        (store_sub, ":var3", 5, ":var1"),
        (389, 30, ":var3"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_28"),
        (389, 31, ":var1"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_29"),
        (389, 32, ":var1"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_30"),
        (389, 33, ":var1"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_31"),
        (try_begin),
          (eq, ":var1", 0),
          (389, 34, 1000),
        (else_try),
          (store_sub, ":var3", 7, ":var1"),
          (389, 34, ":var3"),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_32"),
        (492, 0),
        (393, 35, 0),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_33"),
        (389, 36, ":var1"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_34"),
        (389, 37, ":var1"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_35"),
        (389, 38, ":var1"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_36"),
        (389, 39, ":var1"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_37"),
        (389, 40, ":var1"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_38"),
        (389, 41, ":var1"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_39"),
        (389, 42, ":var1"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_40"),
        (389, 43, ":var1"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_41"),
        (389, 44, ":var1"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_42"),
        (389, 47, ":var1"),
#COOP BEGIN############################################################
      (else_try),
        (eq, ":var0", "$g_presentation_obj_admin_panel_43"),
        (presentation_set_duration, 0),
        (multiplayer_send_int_to_server, multiplayer_event_coop_send_to_server, coop_event_setup_battle),

#COOP END##########################################################        
      (try_end),
    ]),
    (ti_on_presentation_run,
    [
#COOP BEGIN############################################################
      (try_begin), 
        (multiplayer_is_server),
        (call_script, "script_coop_on_admin_panel_load"),
        (eq, "$coop_battle_state", coop_battle_state_setup_mp),#only if coop battle is setup
        (presentation_set_duration, 0),
        (start_presentation, "prsnt_coop_admin_panel"),
      (try_end),
#COOP END###############################################################        
      (try_begin),
        (key_clicked, key_escape),
        (presentation_set_duration, 0),
      (try_end),
    ]),
  ]),

  ("multiplayer_welcome_message", prsntf_manual_end_only, mesh_null,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (2353, 0),
      (try_begin),
        (neg|2318, 0),
        (eq, "$g_multiplayer_welcome_message_shown", 0),
        (create_mesh_overlay, reg0, "mesh_mp_ui_welcome_panel"),
        (position_set_x, pos1, 200),
        (position_set_y, pos1, 400),
        (overlay_set_position, reg0, pos1),
        (create_text_overlay, reg0, s0, 8192),
        (overlay_set_color, reg0, 16777215),
        (position_set_x, pos1, 230),
        (position_set_y, pos1, 425),
        (overlay_set_position, reg0, pos1),
        (position_set_x, pos1, 540),
        (position_set_y, pos1, 150),
        (overlay_set_area_size, reg0, pos1),
        (presentation_set_duration, 999999),
      (else_try),
        (eq, "$g_multiplayer_show_server_rules", 1),
        (create_mesh_overlay, reg0, "mesh_mp_ui_welcome_panel"),
        (position_set_x, pos1, 200),
        (position_set_y, pos1, 400),
        (overlay_set_position, reg0, pos1),
        (try_begin),
          (neg|2318, 0),
          (str_clear, s3),
          (str_store_string, s2, s0),
          (str_store_string, s2, "str_s2_s3"),
          (str_store_string, s2, "str_s2_s3"),
        (else_try),
          (str_clear, s2),
        (try_end),
        (str_store_string, s3, "@Game Rules:^"),
        (str_store_string, s2, "str_s2_s3"),
        (assign, ":var0", 1000),
        (call_script, "script_game_multiplayer_get_game_type_mission_template", "$g_multiplayer_game_type"),
        (assign, ":var1", reg0),
        (2352, 0),
        (str_store_string, s3, "str_server_name_s0"),
        (str_store_string, s2, "str_s2_s3"),
        (try_begin),
          (eq, "$g_multiplayer_game_type", 0),
          (str_store_string, s0, "str_multi_game_type_1"),
        (else_try),
          (eq, "$g_multiplayer_game_type", 1),
          (str_store_string, s0, "str_multi_game_type_2"),
        (else_try),
          (eq, "$g_multiplayer_game_type", 2),
          (str_store_string, s0, "str_multi_game_type_3"),
        (else_try),
          (eq, "$g_multiplayer_game_type", 3),
          (str_store_string, s0, "str_multi_game_type_4"),
        (else_try),
          (eq, "$g_multiplayer_game_type", 4),
          (str_store_string, s0, "str_multi_game_type_5"),
        (else_try),
          (eq, "$g_multiplayer_game_type", 5),
          (str_store_string, s0, "str_multi_game_type_6"),
        (else_try),
          (eq, "$g_multiplayer_game_type", 6),
          (str_store_string, s0, "str_multi_game_type_7"),
        (else_try),
          (eq, "$g_multiplayer_game_type", 7),
          (str_store_string, s0, "str_multi_game_type_8"),
        (try_end),
        (str_store_string, s3, "str_game_type_s0"),
        (str_store_string, s2, "str_s2_s3"),
        (store_current_scene, ":var2"),
        (val_sub, ":var2", "scn_multi_scene_1"),
        (val_add, ":var2", "str_multi_scene_1"),
        (str_store_string, s0, ":var2"),
        (str_store_string, s3, "str_map_name_s0"),
        (str_store_string, s2, "str_s2_s3"),
        (store_mission_timer_a, ":var3"),
        (val_add, ":var3", "$server_mission_timer_while_player_joined"),
        (assign, reg0, ":var3"),
        (store_mul, "$g_multiplayer_game_max_seconds", "$g_multiplayer_game_max_minutes", 60),
        (store_sub, ":var4", "$g_multiplayer_game_max_seconds", ":var3"),
        (store_div, reg0, ":var4", 60),
        (store_mod, reg1, ":var4", 60),
        (try_begin),
          (ge, reg0, 10),
          (ge, reg1, 10),
          (str_clear, s0),
          (str_clear, s1),
        (else_try),
          (ge, reg0, 10),
          (str_clear, s0),
          (str_store_string, s1, "@0"),
        (else_try),
          (ge, reg1, 10),
          (str_store_string, s0, "@0"),
          (str_clear, s1),
        (else_try),
          (str_store_string, s0, "@0"),
          (str_store_string, s1, "@0"),
        (try_end),
        (str_store_string, s3, "str_remaining_time_s0reg0_s1reg1"),
        (str_store_string, s2, "str_s2_s3"),
        (try_for_range, ":var5", 0, ":var0"),
          (assign, reg0, -12345),
          (call_script, "script_game_get_multiplayer_server_option_for_mission_template", ":var1", ":var5"),
          (try_begin),
            (eq, reg0, -12345),
            (assign, ":var0", 0),
          (else_try),
            (call_script, "script_game_multiplayer_server_option_for_mission_template_to_string", ":var1", ":var5", reg0),
            (str_store_string, s3, s0),
            (str_store_string, s2, "str_s2_s3"),
          (try_end),
        (try_end),
        (create_text_overlay, reg0, s2, 8192),
        (overlay_set_color, reg0, 16777215),
        (position_set_x, pos1, 230),
        (position_set_y, pos1, 425),
        (overlay_set_position, reg0, pos1),
        (position_set_x, pos1, 540),
        (position_set_y, pos1, 150),
        (overlay_set_area_size, reg0, pos1),
        (presentation_set_duration, 999999),
      (try_end),
    ]),
    (ti_on_presentation_run,
    [
      (2353, 0),
      (try_begin),
        (neq, "$g_multiplayer_show_server_rules", 1),
        (this_or_next|2318, 0),
        (eq, "$g_multiplayer_welcome_message_shown", 1),
        (presentation_set_duration, 0),
        (neg|903, "prsnt_multiplayer_escape_menu"),
        (neg|903, "prsnt_multiplayer_team_select"),
        (start_presentation, "prsnt_multiplayer_team_select"),
      (else_try),
        (store_mission_timer_a, ":var0"),
        (gt, ":var0", 1),
        (this_or_next|key_clicked, key_escape),
        (this_or_next|key_clicked, key_space),
        (this_or_next|key_clicked, key_enter),
        (this_or_next|key_clicked, key_left_mouse_button),
        (key_clicked, key_right_mouse_button),
        (assign, "$g_multiplayer_welcome_message_shown", 1),
        (presentation_set_duration, 0),
        (neg|903, "prsnt_multiplayer_escape_menu"),
        (neg|903, "prsnt_multiplayer_team_select"),
        (try_begin),
          (eq, "$g_multiplayer_show_server_rules", 1),
          (assign, "$g_multiplayer_show_server_rules", 0),
          (start_presentation, "prsnt_multiplayer_escape_menu"),
        (else_try),
          (start_presentation, "prsnt_multiplayer_team_select"),
        (try_end),
      (try_end),
    ]),
  ]),

  ("multiplayer_team_select", prsntf_manual_end_only, mesh_null,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (create_mesh_overlay, reg0, "mesh_mp_ingame_menu"),
      (position_set_x, pos1, 250),
      (position_set_y, pos1, 80),
      (overlay_set_position, reg0, pos1),
      (position_set_x, pos1, 1000),
      (position_set_y, pos1, 1000),
      (overlay_set_size, reg0, pos1),
      (str_clear, s0),
      (create_text_overlay, "$g_presentation_obj_team_select_container", s0, 131072),
      (position_set_x, pos1, 285),
      (position_set_y, pos1, 125),
      (overlay_set_position, "$g_presentation_obj_team_select_container", pos1),
      (position_set_x, pos1, 405),
      (position_set_y, pos1, 500),
      (overlay_set_area_size, "$g_presentation_obj_team_select_container", pos1),
      (945, "$g_presentation_obj_team_select_container"),
      (assign, ":var0", 450),
      (create_text_overlay, reg0, "str_choose_a_faction", 0),
      (overlay_set_color, reg0, 16777215),
      (position_set_x, pos1, 0),
      (position_set_y, pos1, ":var0"),
      (overlay_set_position, reg0, pos1),
      (val_sub, ":var0", 40),
      (position_set_y, pos1, ":var0"),
      (position_set_x, pos1, 100),
      (415, ":var1"),
      (458, ":var2", 0),
      (str_store_faction_name, s0, ":var2"),
      (create_button_overlay, "$g_presentation_obj_team_select_1", s0, 0),
      (try_begin),
        (call_script, "script_cf_multiplayer_team_is_available", ":var1", 0),
        (overlay_set_color, "$g_presentation_obj_team_select_1", 16777215),
        (overlay_set_hilight_color, "$g_presentation_obj_team_select_1", 5635920),
        (assign, "$g_multiplayer_team_select_1_available", 1),
      (else_try),
        (overlay_set_color, "$g_presentation_obj_team_select_1", 8947848),
        (overlay_set_hilight_color, "$g_presentation_obj_team_select_1", 8947848),
        (assign, "$g_multiplayer_team_select_1_available", 0),
      (try_end),
      (position_set_y, pos1, ":var0"),
      (overlay_set_position, "$g_presentation_obj_team_select_1", pos1),
      (val_sub, ":var0", 40),
      (position_set_y, pos1, ":var0"),
      (458, ":var2", 1),
      (str_store_faction_name, s0, ":var2"),
      (create_button_overlay, "$g_presentation_obj_team_select_2", s0, 0),
      (try_begin),
        (call_script, "script_cf_multiplayer_team_is_available", ":var1", 1),
        (overlay_set_color, "$g_presentation_obj_team_select_2", 16777215),
        (overlay_set_hilight_color, "$g_presentation_obj_team_select_2", 5635920),
        (assign, "$g_multiplayer_team_select_2_available", 1),
      (else_try),
        (overlay_set_color, "$g_presentation_obj_team_select_2", 8947848),
        (overlay_set_hilight_color, "$g_presentation_obj_team_select_2", 8947848),
        (assign, "$g_multiplayer_team_select_2_available", 0),
      (try_end),
      (overlay_set_position, "$g_presentation_obj_team_select_2", pos1),
      (val_sub, ":var0", 40),
      (position_set_y, pos1, ":var0"),
      (create_button_overlay, "$g_presentation_obj_team_select_3", "str_spectator", 0),
      (overlay_set_color, "$g_presentation_obj_team_select_3", 16777215),
      (overlay_set_position, "$g_presentation_obj_team_select_3", pos1),
      (val_sub, ":var0", 40),
      (position_set_y, pos1, ":var0"),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (415, ":var1"),
      (try_begin),
        (eq, "$g_waiting_for_confirmation_to_terminate", 0),
        (try_begin),
          (eq, ":var0", "$g_presentation_obj_team_select_1"),
          (try_begin),
            (call_script, "script_cf_multiplayer_team_is_available", ":var1", 0),
            (try_begin),
              (402, ":var2", ":var1"),
              (neq, ":var2", 0),
              (assign, "$g_confirmation_result", 0),
              (assign, "$g_waiting_for_confirmation_to_terminate", 1),
              (404, "$g_confirmation_troop_backup", ":var1"),
              (402, "$g_confirmation_team_backup", ":var1"),
              (405, ":var1", -1),
              (389, 19, 0),
              (403, ":var1", 0),
            (else_try),
              (presentation_set_duration, 0),
              (start_presentation, "prsnt_multiplayer_troop_select"),
            (try_end),
          (try_end),
        (else_try),
          (eq, ":var0", "$g_presentation_obj_team_select_2"),
          (try_begin),
            (call_script, "script_cf_multiplayer_team_is_available", ":var1", 1),
            (try_begin),
              (402, ":var2", ":var1"),
              (neq, ":var2", 1),
              (assign, "$g_confirmation_result", 0),
              (assign, "$g_waiting_for_confirmation_to_terminate", 1),
              (404, "$g_confirmation_troop_backup", ":var1"),
              (402, "$g_confirmation_team_backup", ":var1"),
              (405, ":var1", -1),
              (389, 19, 1),
              (403, ":var1", 1),
            (else_try),
              (presentation_set_duration, 0),
              (start_presentation, "prsnt_multiplayer_troop_select"),
            (try_end),
          (try_end),
        (else_try),
          (eq, ":var0", "$g_presentation_obj_team_select_3"),
          (405, ":var1", -1),
          (389, 19, 2),
          (403, ":var1", 2),
          (presentation_set_duration, 0),
        (try_end),
      (try_end),
    ]),
    (ti_on_presentation_run,
    [
      (415, ":var0"),
      (try_begin),
        (key_clicked, key_escape),
        (eq, "$g_waiting_for_confirmation_to_terminate", 0),
        (411, ":var1"),
        (try_begin),
          (eq, ":var1", 3),
          (405, ":var0", -1),
          (389, 19, 2),
          (403, ":var0", 2),
        (try_end),
        (presentation_set_duration, 0),
      (else_try),
        (eq, "$g_waiting_for_confirmation_to_terminate", 1),
        (eq, "$g_confirmation_result", 1),
        (assign, "$g_waiting_for_confirmation_to_terminate", 0),
        (assign, "$g_confirmation_result", 0),
        (presentation_set_duration, 0),
        (start_presentation, "prsnt_multiplayer_troop_select"),
      (else_try),
        (eq, "$g_waiting_for_confirmation_to_terminate", 1),
        (eq, "$g_confirmation_result", -1),
        (405, ":var0", "$g_confirmation_troop_backup"),
        (403, ":var0", "$g_confirmation_team_backup"),
        (assign, "$g_waiting_for_confirmation_to_terminate", 0),
        (assign, "$g_confirmation_result", 0),
        (presentation_set_duration, 0),
        (start_presentation, "prsnt_multiplayer_team_select"),
      (else_try),
        (assign, ":var2", 0),
        (try_begin),
          (call_script, "script_cf_multiplayer_team_is_available", ":var0", 0),
          (try_begin),
            (eq, "$g_multiplayer_team_select_1_available", 0),
            (assign, ":var2", 1),
          (try_end),
        (else_try),
          (try_begin),
            (eq, "$g_multiplayer_team_select_1_available", 1),
            (assign, ":var2", 1),
          (try_end),
        (try_end),
        (try_begin),
          (call_script, "script_cf_multiplayer_team_is_available", ":var0", 1),
          (try_begin),
            (eq, "$g_multiplayer_team_select_2_available", 0),
            (assign, ":var2", 1),
          (try_end),
        (else_try),
          (try_begin),
            (eq, "$g_multiplayer_team_select_2_available", 1),
            (assign, ":var2", 1),
          (try_end),
        (try_end),
        (eq, ":var2", 1),
        (presentation_set_duration, 0),
        (start_presentation, "prsnt_multiplayer_team_select"),
      (try_end),
    ]),
  ]),

  ("multiplayer_troop_select", prsntf_manual_end_only, mesh_null,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (create_mesh_overlay, reg0, "mesh_mp_ingame_menu"),
      (position_set_x, pos1, 250),
      (position_set_y, pos1, 80),
      (overlay_set_position, reg0, pos1),
      (position_set_x, pos1, 1000),
      (position_set_y, pos1, 1000),
      (overlay_set_size, reg0, pos1),
      (str_clear, s0),
      (create_text_overlay, "$g_presentation_obj_troop_select_container", s0, 131072),
      (position_set_x, pos1, 285),
      (position_set_y, pos1, 125),
      (overlay_set_position, "$g_presentation_obj_troop_select_container", pos1),
      (position_set_x, pos1, 405),
      (position_set_y, pos1, 500),
      (overlay_set_area_size, "$g_presentation_obj_troop_select_container", pos1),
      (945, "$g_presentation_obj_troop_select_container"),
      (assign, ":var0", 450),
      (create_text_overlay, reg0, "str_choose_a_troop", 0),
      (overlay_set_color, reg0, 16777215),
      (position_set_x, pos1, 0),
      (position_set_y, pos1, ":var0"),
      (overlay_set_position, reg0, pos1),
      (val_sub, ":var0", 40),
      (position_set_y, pos1, ":var0"),
      (position_set_x, pos1, 100),
      (415, ":var1"),
      (402, ":var2", ":var1"),
      (458, ":var3", ":var2"),
      (try_for_range, ":var4", 30, 46),
        (troop_set_slot, "trp_multiplayer_data", ":var4", -1),
      (try_end),
      (assign, ":var5", 0),
      (try_for_range, ":var6", "trp_sarleon_longbowman_multiplayer", "trp_multiplayer_end"),
        (store_troop_faction, ":var7", ":var6"),
        (eq, ":var7", ":var3"),
        (str_store_troop_name, s1, ":var6"),
        (create_button_overlay, reg0, s1, 0),
        (overlay_set_color, reg0, 16777215),
        (store_add, ":var8", ":var5", 30),
        (troop_set_slot, "trp_multiplayer_data", ":var8", reg0),
        (position_set_y, pos1, ":var0"),
        (overlay_set_position, reg0, pos1),
        (val_sub, ":var0", 40),
        (position_set_y, pos1, ":var0"),
        (val_add, ":var5", 1),
      (try_end),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (415, ":var1"),
      (402, ":var2", ":var1"),
      (458, ":var3", ":var2"),
      (assign, ":var4", -1),
      (assign, ":var5", 46),
      (try_for_range, ":var6", 30, ":var5"),
        (troop_slot_eq, "trp_multiplayer_data", ":var6", ":var0"),
        (store_sub, ":var7", ":var6", 30),
        (assign, ":var8", "trp_multiplayer_end"),
        (try_for_range, ":var9", "trp_sarleon_longbowman_multiplayer", ":var8"),
          (store_troop_faction, ":var10", ":var9"),
          (eq, ":var10", ":var3"),
          (val_sub, ":var7", 1),
          (lt, ":var7", 0),
          (assign, ":var4", ":var9"),
          (assign, ":var8", 0),
        (try_end),
        (try_begin),
          (412, ":var9"),
          (neq, ":var9", ":var4"),
          (405, ":var1", ":var4"),
          (389, 20, ":var4"),
          (call_script, "script_multiplayer_set_default_item_selections_for_troop", ":var4"),
          (call_script, "script_multiplayer_send_item_selections"),
        (try_end),
        (presentation_set_duration, 0),
        (assign, "$g_presentation_state", 0),
        (start_presentation, "prsnt_multiplayer_item_select"),
        (assign, ":var5", 0),
      (try_end),
    ]),
    (ti_on_presentation_run,
    [
      (try_begin),
        (key_clicked, key_escape),
        (415, ":var0"),
        (is_between, ":var0", 0, 1000),
        (412, ":var1"),
        (try_begin),
          (neg|is_between, ":var1", "trp_sarleon_longbowman_multiplayer", "trp_multiplayer_end"),
          (405, ":var0", -1),
          (389, 20, -1),
          (389, 19, 2),
          (403, ":var0", 2),
        (try_end),
        (presentation_set_duration, 0),
      (try_end),
    ]),
  ]),

  ("multiplayer_item_select", prsntf_manual_end_only, mesh_null,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (415, ":var0"),
      (assign, "$g_presentation_obj_item_select_1", -1),
      (assign, "$g_presentation_obj_item_select_2", -1),
      (assign, "$g_presentation_obj_item_select_3", -1),
      (assign, "$g_presentation_obj_item_select_4", -1),
      (assign, "$g_presentation_obj_item_select_5", -1),
      (assign, "$g_presentation_obj_item_select_6", -1),
      (assign, "$g_presentation_obj_item_select_7", -1),
      (assign, "$g_presentation_obj_item_select_8", -1),
      (assign, "$g_presentation_obj_item_select_9", -1),
      (assign, "$g_presentation_obj_item_select_10", -1),
      (assign, "$g_presentation_obj_item_select_11", -1),
      (assign, "$g_presentation_obj_item_select_12", -1),
      (assign, "$g_presentation_obj_item_select_13", -1),
      (assign, "$g_presentation_obj_item_select_14", -1),
      (assign, "$g_presentation_obj_item_select_15", -1),
      (assign, "$g_presentation_obj_item_select_16", -1),
      (try_begin),
        (neq, "$g_current_opened_item_details", -1),
        (971),
        (assign, "$g_current_opened_item_details", -1),
      (try_end),
      (store_add, ":var1", 2, 0),
      (528, ":var2", ":var0", ":var1"),
      (try_begin),
        (ge, ":var2", 0),
        (create_image_button_overlay, "$g_presentation_obj_item_select_1", "mesh_mp_inventory_slot_empty", "mesh_mp_inventory_slot_empty"),
        (944, reg0, ":var2"),
        (position_set_x, pos1, 950),
        (position_set_y, pos1, 526),
        (overlay_set_position, reg0, pos1),
        (assign, "$g_inside_obj_1", reg0),
      (else_try),
        (create_image_button_overlay, "$g_presentation_obj_item_select_1", "mesh_mp_inventory_slot_equip", "mesh_mp_inventory_slot_equip"),
      (try_end),
      (position_set_x, pos1, 800),
      (position_set_y, pos1, 800),
      (overlay_set_size, "$g_presentation_obj_item_select_1", pos1),
      (position_set_x, pos1, 899),
      (position_set_y, pos1, 475),
      (overlay_set_position, "$g_presentation_obj_item_select_1", pos1),
      (store_add, ":var1", 2, 1),
      (528, ":var2", ":var0", ":var1"),
      (try_begin),
        (ge, ":var2", 0),
        (create_image_button_overlay, "$g_presentation_obj_item_select_2", "mesh_mp_inventory_slot_empty", "mesh_mp_inventory_slot_empty"),
        (944, reg0, ":var2"),
        (position_set_x, pos1, 950),
        (position_set_y, pos1, 426),
        (overlay_set_position, reg0, pos1),
        (assign, "$g_inside_obj_2", reg0),
      (else_try),
        (create_image_button_overlay, "$g_presentation_obj_item_select_2", "mesh_mp_inventory_slot_equip", "mesh_mp_inventory_slot_equip"),
      (try_end),
      (position_set_x, pos1, 800),
      (position_set_y, pos1, 800),
      (overlay_set_size, "$g_presentation_obj_item_select_2", pos1),
      (position_set_x, pos1, 899),
      (position_set_y, pos1, 375),
      (overlay_set_position, "$g_presentation_obj_item_select_2", pos1),
      (store_add, ":var1", 2, 2),
      (528, ":var2", ":var0", ":var1"),
      (try_begin),
        (ge, ":var2", 0),
        (create_image_button_overlay, "$g_presentation_obj_item_select_3", "mesh_mp_inventory_slot_empty", "mesh_mp_inventory_slot_empty"),
        (944, reg0, ":var2"),
        (position_set_x, pos1, 950),
        (position_set_y, pos1, 326),
        (overlay_set_position, reg0, pos1),
        (assign, "$g_inside_obj_3", reg0),
      (else_try),
        (create_image_button_overlay, "$g_presentation_obj_item_select_3", "mesh_mp_inventory_slot_equip", "mesh_mp_inventory_slot_equip"),
      (try_end),
      (position_set_x, pos1, 800),
      (position_set_y, pos1, 800),
      (overlay_set_size, "$g_presentation_obj_item_select_3", pos1),
      (position_set_x, pos1, 899),
      (position_set_y, pos1, 275),
      (overlay_set_position, "$g_presentation_obj_item_select_3", pos1),
      (store_add, ":var1", 2, 3),
      (528, ":var2", ":var0", ":var1"),
      (try_begin),
        (ge, ":var2", 0),
        (create_image_button_overlay, "$g_presentation_obj_item_select_4", "mesh_mp_inventory_slot_empty", "mesh_mp_inventory_slot_empty"),
        (944, reg0, ":var2"),
        (position_set_x, pos1, 950),
        (position_set_y, pos1, 226),
        (overlay_set_position, reg0, pos1),
        (assign, "$g_inside_obj_4", reg0),
      (else_try),
        (create_image_button_overlay, "$g_presentation_obj_item_select_4", "mesh_mp_inventory_slot_equip", "mesh_mp_inventory_slot_equip"),
      (try_end),
      (position_set_x, pos1, 800),
      (position_set_y, pos1, 800),
      (overlay_set_size, "$g_presentation_obj_item_select_4", pos1),
      (position_set_x, pos1, 899),
      (position_set_y, pos1, 175),
      (overlay_set_position, "$g_presentation_obj_item_select_4", pos1),
      (store_add, ":var1", 2, 4),
      (528, ":var2", ":var0", ":var1"),
      (try_begin),
        (ge, ":var2", 0),
        (create_image_button_overlay, "$g_presentation_obj_item_select_5", "mesh_mp_inventory_slot_empty", "mesh_mp_inventory_slot_empty"),
        (944, reg0, ":var2"),
        (position_set_x, pos1, 53),
        (position_set_y, pos1, 576),
        (overlay_set_position, reg0, pos1),
        (assign, "$g_inside_obj_5", reg0),
      (else_try),
        (create_image_button_overlay, "$g_presentation_obj_item_select_5", "mesh_mp_inventory_slot_helmet", "mesh_mp_inventory_slot_helmet"),
      (try_end),
      (position_set_x, pos1, 800),
      (position_set_y, pos1, 800),
      (overlay_set_size, "$g_presentation_obj_item_select_5", pos1),
      (position_set_x, pos1, 2),
      (position_set_y, pos1, 525),
      (overlay_set_position, "$g_presentation_obj_item_select_5", pos1),
      (store_add, ":var1", 2, 5),
      (528, ":var2", ":var0", ":var1"),
      (try_begin),
        (ge, ":var2", 0),
        (create_image_button_overlay, "$g_presentation_obj_item_select_6", "mesh_mp_inventory_slot_empty", "mesh_mp_inventory_slot_empty"),
        (944, reg0, ":var2"),
        (position_set_x, pos1, 53),
        (position_set_y, pos1, 476),
        (overlay_set_position, reg0, pos1),
        (assign, "$g_inside_obj_6", reg0),
      (else_try),
        (create_image_button_overlay, "$g_presentation_obj_item_select_6", "mesh_mp_inventory_slot_armor", "mesh_mp_inventory_slot_armor"),
      (try_end),
      (position_set_x, pos1, 800),
      (position_set_y, pos1, 800),
      (overlay_set_size, "$g_presentation_obj_item_select_6", pos1),
      (position_set_x, pos1, 2),
      (position_set_y, pos1, 425),
      (overlay_set_position, "$g_presentation_obj_item_select_6", pos1),
      (store_add, ":var1", 2, 6),
      (528, ":var2", ":var0", ":var1"),
      (try_begin),
        (ge, ":var2", 0),
        (create_image_button_overlay, "$g_presentation_obj_item_select_7", "mesh_mp_inventory_slot_empty", "mesh_mp_inventory_slot_empty"),
        (944, reg0, ":var2"),
        (position_set_x, pos1, 53),
        (position_set_y, pos1, 376),
        (overlay_set_position, reg0, pos1),
        (assign, "$g_inside_obj_7", reg0),
      (else_try),
        (create_image_button_overlay, "$g_presentation_obj_item_select_7", "mesh_mp_inventory_slot_boot", "mesh_mp_inventory_slot_boot"),
      (try_end),
      (position_set_x, pos1, 800),
      (position_set_y, pos1, 800),
      (overlay_set_size, "$g_presentation_obj_item_select_7", pos1),
      (position_set_x, pos1, 2),
      (position_set_y, pos1, 325),
      (overlay_set_position, "$g_presentation_obj_item_select_7", pos1),
      (store_add, ":var1", 2, 7),
      (528, ":var2", ":var0", ":var1"),
      (try_begin),
        (ge, ":var2", 0),
        (create_image_button_overlay, "$g_presentation_obj_item_select_8", "mesh_mp_inventory_slot_empty", "mesh_mp_inventory_slot_empty"),
        (944, reg0, ":var2"),
        (position_set_x, pos1, 53),
        (position_set_y, pos1, 276),
        (overlay_set_position, reg0, pos1),
        (assign, "$g_inside_obj_8", reg0),
      (else_try),
        (create_image_button_overlay, "$g_presentation_obj_item_select_8", "mesh_mp_inventory_slot_glove", "mesh_mp_inventory_slot_glove"),
      (try_end),
      (position_set_x, pos1, 800),
      (position_set_y, pos1, 800),
      (overlay_set_size, "$g_presentation_obj_item_select_8", pos1),
      (position_set_x, pos1, 2),
      (position_set_y, pos1, 225),
      (overlay_set_position, "$g_presentation_obj_item_select_8", pos1),
      (store_add, ":var1", 2, 8),
      (528, ":var2", ":var0", ":var1"),
      (try_begin),
        (ge, ":var2", 0),
        (eq, "$g_horses_are_avaliable", 1),
        (create_image_button_overlay, "$g_presentation_obj_item_select_9", "mesh_mp_inventory_slot_empty", "mesh_mp_inventory_slot_empty"),
        (944, reg0, ":var2"),
        (position_set_x, pos1, 53),
        (position_set_y, pos1, 176),
        (overlay_set_position, reg0, pos1),
        (assign, "$g_inside_obj_9", reg0),
      (else_try),
        (create_image_button_overlay, "$g_presentation_obj_item_select_9", "mesh_mp_inventory_slot_horse", "mesh_mp_inventory_slot_horse"),
      (try_end),
      (position_set_x, pos1, 800),
      (position_set_y, pos1, 800),
      (overlay_set_size, "$g_presentation_obj_item_select_9", pos1),
      (position_set_x, pos1, 2),
      (position_set_y, pos1, 125),
      (overlay_set_position, "$g_presentation_obj_item_select_9", pos1),
      (create_mesh_overlay, reg0, "mesh_mp_inventory_left"),
      (position_set_x, pos1, 800),
      (position_set_y, pos1, 800),
      (overlay_set_size, reg0, pos1),
      (position_set_x, pos1, 0),
      (position_set_y, pos1, 14),
      (overlay_set_position, reg0, pos1),
      (create_mesh_overlay, reg0, "mesh_mp_inventory_right"),
      (position_set_x, pos1, 800),
      (position_set_y, pos1, 800),
      (overlay_set_size, reg0, pos1),
      (position_set_x, pos1, 894),
      (position_set_y, pos1, 65),
      (overlay_set_position, reg0, pos1),
      (941, "$g_presentation_obj_item_select_10", "str_reset_to_default", 0),
      (overlay_set_color, "$g_presentation_obj_item_select_10", 16777215),
      (position_set_x, pos1, 605),
      (position_set_y, pos1, 25),
      (overlay_set_position, "$g_presentation_obj_item_select_10", pos1),
      (941, "$g_presentation_obj_item_select_11", "str_done", 0),
      (overlay_set_color, "$g_presentation_obj_item_select_11", 16777215),
      (position_set_x, pos1, 395),
      (position_set_y, pos1, 25),
      (overlay_set_position, "$g_presentation_obj_item_select_11", pos1),
      (assign, ":var3", 725),
      (415, ":var0"),
      (402, ":var4", ":var0"),
      (assign, ":var5", 0),
      (try_begin),
        (eq, ":var4", 0),
        (try_begin),
          (gt, "$g_multiplayer_num_bots_team_1", 0),
          (assign, ":var5", 1),
        (try_end),
      (else_try),
        (try_begin),
          (gt, "$g_multiplayer_num_bots_team_2", 0),
          (assign, ":var5", 1),
        (try_end),
      (try_end),
      (458, ":var6", ":var4"),
      (try_begin),
        (eq, ":var5", 1),
        (neq, "$g_multiplayer_game_type", 0),
        (neq, "$g_multiplayer_game_type", 7),
        (assign, ":var7", 0),
        (try_begin),
          (eq, ":var5", 1),
          (try_for_range, ":var8", "trp_sarleon_longbowman_multiplayer_ai", "trp_sarleon_longbowman_multiplayer"),
            (store_troop_faction, ":var9", ":var8"),
            (eq, ":var9", ":var6"),
            (val_add, ":var7", 1),
          (try_end),
        (try_end),
        (store_mul, ":var10", ":var7", 20),
        (val_add, ":var10", 40),
        (create_mesh_overlay, reg0, "mesh_mp_ui_command_border_r"),
        (position_set_x, pos1, 280),
        (position_set_y, pos1, 680),
        (overlay_set_position, reg0, pos1),
        (position_set_x, pos1, 2500),
        (position_set_y, pos1, 2500),
        (overlay_set_size, reg0, pos1),
        (create_mesh_overlay, reg0, "mesh_mp_ui_command_border_l"),
        (position_set_x, pos1, 650),
        (position_set_y, pos1, 680),
        (overlay_set_position, reg0, pos1),
        (position_set_x, pos1, 2500),
        (position_set_y, pos1, 2500),
        (overlay_set_size, reg0, pos1),
        (create_mesh_overlay, reg0, "mesh_mp_ui_command_panel"),
        (position_set_x, pos1, 350),
        (store_sub, ":var11", 750, ":var10"),
        (position_set_y, pos1, ":var11"),
        (overlay_set_position, reg0, pos1),
        (position_set_x, pos1, 3000),
        (position_set_y, pos1, 3000),
        (overlay_set_size, reg0, pos1),
        (create_text_overlay, reg0, "str_command", 0),
        (overlay_set_color, reg0, 16777215),
        (position_set_x, pos1, 800),
        (position_set_y, pos1, 800),
        (overlay_set_size, reg0, pos1),
        (position_set_x, pos1, 370),
        (position_set_y, pos1, ":var3"),
        (overlay_set_position, reg0, pos1),
        (val_sub, ":var3", 20),
        (assign, ":var12", 0),
        (try_for_range, ":var8", "trp_sarleon_longbowman_multiplayer_ai", "trp_sarleon_longbowman_multiplayer"),
          (store_troop_faction, ":var9", ":var8"),
          (eq, ":var9", ":var6"),
          (create_check_box_overlay, reg0, "mesh_checkbox_off", "mesh_checkbox_on"),
          (position_set_x, pos1, 800),
          (position_set_y, pos1, 800),
          (overlay_set_size, reg0, pos1),
          (position_set_x, pos1, 377),
          (store_add, ":var13", ":var3", 2),
          (position_set_y, pos1, ":var13"),
          (overlay_set_position, reg0, pos1),
          (try_begin),
            (eq, ":var12", 0),
            (overlay_set_val, reg0, "$g_multiplayer_bot_type_1_wanted"),
            (assign, "$g_presentation_obj_item_select_13", reg0),
          (else_try),
            (eq, ":var12", 1),
            (overlay_set_val, reg0, "$g_multiplayer_bot_type_2_wanted"),
            (assign, "$g_presentation_obj_item_select_14", reg0),
          (else_try),
            (eq, ":var12", 2),
            (overlay_set_val, reg0, "$g_multiplayer_bot_type_3_wanted"),
            (assign, "$g_presentation_obj_item_select_15", reg0),
          (else_try),
            (overlay_set_val, reg0, "$g_multiplayer_bot_type_4_wanted"),
            (assign, "$g_presentation_obj_item_select_16", reg0),
          (try_end),
          (str_store_troop_name, s0, ":var8"),
          (create_text_overlay, reg0, "str_s0", 0),
          (overlay_set_color, reg0, 16777215),
          (position_set_x, pos1, 800),
          (position_set_y, pos1, 800),
          (overlay_set_size, reg0, pos1),
          (position_set_x, pos1, 397),
          (position_set_y, pos1, ":var3"),
          (overlay_set_position, reg0, pos1),
          (val_sub, ":var3", 20),
          (val_add, ":var12", 1),
        (try_end),
        (val_sub, ":var3", 20),
      (try_end),
      (415, ":var0"),
      (407, ":var14", ":var0"),
      (call_script, "script_multiplayer_calculate_cur_selected_items_cost", ":var0", 1),
      (create_text_overlay, "$g_presentation_obj_item_select_12", "str_total_item_cost_reg0", 98308),
      (try_begin),
        (ge, ":var14", reg0),
        (overlay_set_color, "$g_presentation_obj_item_select_12", 16777215),
      (else_try),
        (overlay_set_color, "$g_presentation_obj_item_select_12", 16711680),
      (try_end),
      (position_set_x, pos1, 680),
      (position_set_y, pos1, 652),
      (overlay_set_position, "$g_presentation_obj_item_select_12", pos1),
      (store_add, "$g_presentation_obj_item_select_next", "$g_presentation_obj_item_select_12", 1),
      (404, ":var15", ":var0"),
      (try_begin),
        (eq, "$g_presentation_state", 1),
        (call_script, "script_multiplayer_display_available_items_for_troop_and_item_classes", ":var15", 1, 18, 781, 474),
        (create_mesh_overlay, reg0, "mesh_mp_inventory_right_arrow"),
        (position_set_x, pos1, 800),
        (position_set_y, pos1, 800),
        (overlay_set_size, reg0, pos1),
        (position_set_x, pos1, 881),
        (position_set_y, pos1, 515),
        (overlay_set_position, reg0, pos1),
      (else_try),
        (eq, "$g_presentation_state", 2),
        (call_script, "script_multiplayer_display_available_items_for_troop_and_item_classes", ":var15", 1, 18, 781, 374),
        (create_mesh_overlay, reg0, "mesh_mp_inventory_right_arrow"),
        (position_set_x, pos1, 800),
        (position_set_y, pos1, 800),
        (overlay_set_size, reg0, pos1),
        (position_set_x, pos1, 881),
        (position_set_y, pos1, 415),
        (overlay_set_position, reg0, pos1),
      (else_try),
        (eq, "$g_presentation_state", 3),
        (call_script, "script_multiplayer_display_available_items_for_troop_and_item_classes", ":var15", 1, 18, 781, 274),
        (create_mesh_overlay, reg0, "mesh_mp_inventory_right_arrow"),
        (position_set_x, pos1, 800),
        (position_set_y, pos1, 800),
        (overlay_set_size, reg0, pos1),
        (position_set_x, pos1, 881),
        (position_set_y, pos1, 315),
        (overlay_set_position, reg0, pos1),
      (else_try),
        (eq, "$g_presentation_state", 4),
        (call_script, "script_multiplayer_display_available_items_for_troop_and_item_classes", ":var15", 1, 18, 781, 174),
        (create_mesh_overlay, reg0, "mesh_mp_inventory_right_arrow"),
        (position_set_x, pos1, 800),
        (position_set_y, pos1, 800),
        (overlay_set_size, reg0, pos1),
        (position_set_x, pos1, 881),
        (position_set_y, pos1, 215),
        (overlay_set_position, reg0, pos1),
      (else_try),
        (eq, "$g_presentation_state", 5),
        (call_script, "script_multiplayer_display_available_items_for_troop_and_item_classes", ":var15", 22, 24, 117, 524),
        (create_mesh_overlay, reg0, "mesh_mp_inventory_left_arrow"),
        (position_set_x, pos1, 800),
        (position_set_y, pos1, 800),
        (overlay_set_size, reg0, pos1),
        (position_set_x, pos1, 106),
        (position_set_y, pos1, 565),
        (overlay_set_position, reg0, pos1),
      (else_try),
        (eq, "$g_presentation_state", 6),
        (call_script, "script_multiplayer_display_available_items_for_troop_and_item_classes", ":var15", 19, 22, 117, 424),
        (create_mesh_overlay, reg0, "mesh_mp_inventory_left_arrow"),
        (position_set_x, pos1, 800),
        (position_set_y, pos1, 800),
        (overlay_set_size, reg0, pos1),
        (position_set_x, pos1, 106),
        (position_set_y, pos1, 465),
        (overlay_set_position, reg0, pos1),
      (else_try),
        (eq, "$g_presentation_state", 7),
        (call_script, "script_multiplayer_display_available_items_for_troop_and_item_classes", ":var15", 24, 26, 117, 324),
        (create_mesh_overlay, reg0, "mesh_mp_inventory_left_arrow"),
        (position_set_x, pos1, 800),
        (position_set_y, pos1, 800),
        (overlay_set_size, reg0, pos1),
        (position_set_x, pos1, 106),
        (position_set_y, pos1, 365),
        (overlay_set_position, reg0, pos1),
      (else_try),
        (eq, "$g_presentation_state", 8),
        (call_script, "script_multiplayer_display_available_items_for_troop_and_item_classes", ":var15", 26, 27, 117, 224),
        (create_mesh_overlay, reg0, "mesh_mp_inventory_left_arrow"),
        (position_set_x, pos1, 800),
        (position_set_y, pos1, 800),
        (overlay_set_size, reg0, pos1),
        (position_set_x, pos1, 106),
        (position_set_y, pos1, 265),
        (overlay_set_position, reg0, pos1),
      (else_try),
        (eq, "$g_presentation_state", 9),
        (eq, "$g_horses_are_avaliable", 1),
        (call_script, "script_multiplayer_display_available_items_for_troop_and_item_classes", ":var15", 18, 19, 117, 124),
        (create_mesh_overlay, reg0, "mesh_mp_inventory_left_arrow"),
        (position_set_x, pos1, 800),
        (position_set_y, pos1, 800),
        (overlay_set_size, reg0, pos1),
        (position_set_x, pos1, 106),
        (position_set_y, pos1, 165),
        (overlay_set_position, reg0, pos1),
      (try_end),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_mouse_enter_leave,
    [
      (store_trigger_param_1, ":var0"),
      (store_trigger_param_2, ":var1"),
      (try_begin),
        (eq, "$g_close_equipment_selection", 0),
        (try_begin),
          (eq, ":var1", 0),
          (assign, ":var2", -1),
          (try_begin),
            (ge, ":var0", "$g_presentation_obj_item_select_next"),
            (store_sub, ":var3", ":var0", "$g_presentation_obj_item_select_next"),
            (store_mod, ":var4", ":var3", 2),
            (store_sub, ":var4", 1, ":var4"),
            (val_div, ":var3", 2),
            (store_add, ":var5", 46, ":var3"),
            (troop_get_slot, ":var2", "trp_multiplayer_data", ":var5"),
            (assign, ":var6", ":var0"),
            (val_add, ":var6", ":var4"),
          (else_try),
            (eq, ":var0", "$g_presentation_obj_item_select_1"),
            (store_add, ":var7", 2, 1),
            (val_sub, ":var7", 1),
            (415, ":var8"),
            (528, ":var2", ":var8", ":var7"),
            (assign, ":var6", "$g_inside_obj_1"),
          (else_try),
            (eq, ":var0", "$g_presentation_obj_item_select_2"),
            (store_add, ":var7", 2, 2),
            (val_sub, ":var7", 1),
            (415, ":var8"),
            (528, ":var2", ":var8", ":var7"),
            (assign, ":var6", "$g_inside_obj_2"),
          (else_try),
            (eq, ":var0", "$g_presentation_obj_item_select_3"),
            (store_add, ":var7", 2, 3),
            (val_sub, ":var7", 1),
            (415, ":var8"),
            (528, ":var2", ":var8", ":var7"),
            (assign, ":var6", "$g_inside_obj_3"),
          (else_try),
            (eq, ":var0", "$g_presentation_obj_item_select_4"),
            (store_add, ":var7", 2, 4),
            (val_sub, ":var7", 1),
            (415, ":var8"),
            (528, ":var2", ":var8", ":var7"),
            (assign, ":var6", "$g_inside_obj_4"),
          (else_try),
            (eq, ":var0", "$g_presentation_obj_item_select_5"),
            (store_add, ":var7", 2, 5),
            (val_sub, ":var7", 1),
            (415, ":var8"),
            (528, ":var2", ":var8", ":var7"),
            (assign, ":var6", "$g_inside_obj_5"),
          (else_try),
            (eq, ":var0", "$g_presentation_obj_item_select_6"),
            (store_add, ":var7", 2, 6),
            (val_sub, ":var7", 1),
            (415, ":var8"),
            (528, ":var2", ":var8", ":var7"),
            (assign, ":var6", "$g_inside_obj_6"),
          (else_try),
            (eq, ":var0", "$g_presentation_obj_item_select_7"),
            (store_add, ":var7", 2, 7),
            (val_sub, ":var7", 1),
            (415, ":var8"),
            (528, ":var2", ":var8", ":var7"),
            (assign, ":var6", "$g_inside_obj_7"),
          (else_try),
            (eq, ":var0", "$g_presentation_obj_item_select_8"),
            (store_add, ":var7", 2, 8),
            (val_sub, ":var7", 1),
            (415, ":var8"),
            (528, ":var2", ":var8", ":var7"),
            (assign, ":var6", "$g_inside_obj_8"),
          (else_try),
            (eq, ":var0", "$g_presentation_obj_item_select_9"),
            (eq, "$g_horses_are_avaliable", 1),
            (store_add, ":var7", 2, 9),
            (val_sub, ":var7", 1),
            (415, ":var8"),
            (528, ":var2", ":var8", ":var7"),
            (assign, ":var6", "$g_inside_obj_9"),
          (try_end),
          (try_begin),
            (ge, ":var2", 0),
            (946, 0, ":var6"),
            (415, ":var8"),
            (404, ":var9", ":var8"),
            (try_begin),
              (call_script, "script_cf_multiplayer_is_item_default_for_troop", ":var2", ":var9"),
              (970, ":var2", 0, 0),
            (else_try),
              (store_troop_faction, ":var10", ":var9"),
              (store_sub, ":var11", ":var10", "fac_kingdom_1"),
              (val_add, ":var11", 30),
              (item_get_slot, ":var12", ":var2", ":var11"),
              (970, ":var2", 0, ":var12"),
            (try_end),
            (assign, "$g_current_opened_item_details", ":var2"),
          (try_end),
        (else_try),
          (assign, ":var2", -1),
          (try_begin),
            (ge, ":var0", "$g_presentation_obj_item_select_next"),
            (store_sub, ":var3", ":var0", "$g_presentation_obj_item_select_next"),
            (val_div, ":var3", 2),
            (store_add, ":var5", 46, ":var3"),
            (troop_get_slot, ":var2", "trp_multiplayer_data", ":var5"),
          (else_try),
            (eq, ":var0", "$g_presentation_obj_item_select_1"),
            (store_add, ":var7", 2, 1),
            (val_sub, ":var7", 1),
            (415, ":var8"),
            (528, ":var2", ":var8", ":var7"),
            (assign, ":var6", "$g_inside_obj_1"),
          (else_try),
            (eq, ":var0", "$g_presentation_obj_item_select_2"),
            (store_add, ":var7", 2, 2),
            (val_sub, ":var7", 1),
            (415, ":var8"),
            (528, ":var2", ":var8", ":var7"),
            (assign, ":var6", "$g_inside_obj_2"),
          (else_try),
            (eq, ":var0", "$g_presentation_obj_item_select_3"),
            (store_add, ":var7", 2, 3),
            (val_sub, ":var7", 1),
            (415, ":var8"),
            (528, ":var2", ":var8", ":var7"),
            (assign, ":var6", "$g_inside_obj_3"),
          (else_try),
            (eq, ":var0", "$g_presentation_obj_item_select_4"),
            (store_add, ":var7", 2, 4),
            (val_sub, ":var7", 1),
            (415, ":var8"),
            (528, ":var2", ":var8", ":var7"),
            (assign, ":var6", "$g_inside_obj_4"),
          (else_try),
            (eq, ":var0", "$g_presentation_obj_item_select_5"),
            (store_add, ":var7", 2, 5),
            (val_sub, ":var7", 1),
            (415, ":var8"),
            (528, ":var2", ":var8", ":var7"),
            (assign, ":var6", "$g_inside_obj_5"),
          (else_try),
            (eq, ":var0", "$g_presentation_obj_item_select_6"),
            (store_add, ":var7", 2, 6),
            (val_sub, ":var7", 1),
            (415, ":var8"),
            (528, ":var2", ":var8", ":var7"),
            (assign, ":var6", "$g_inside_obj_6"),
          (else_try),
            (eq, ":var0", "$g_presentation_obj_item_select_7"),
            (store_add, ":var7", 2, 7),
            (val_sub, ":var7", 1),
            (415, ":var8"),
            (528, ":var2", ":var8", ":var7"),
            (assign, ":var6", "$g_inside_obj_7"),
          (else_try),
            (eq, ":var0", "$g_presentation_obj_item_select_8"),
            (store_add, ":var7", 2, 8),
            (val_sub, ":var7", 1),
            (415, ":var8"),
            (528, ":var2", ":var8", ":var7"),
            (assign, ":var6", "$g_inside_obj_8"),
          (else_try),
            (eq, ":var0", "$g_presentation_obj_item_select_9"),
            (eq, "$g_horses_are_avaliable", 1),
            (store_add, ":var7", 2, 9),
            (val_sub, ":var7", 1),
            (415, ":var8"),
            (528, ":var2", ":var8", ":var7"),
            (assign, ":var6", "$g_inside_obj_9"),
          (try_end),
          (try_begin),
            (eq, "$g_current_opened_item_details", ":var2"),
            (971),
            (assign, "$g_current_opened_item_details", -1),
          (try_end),
        (try_end),
      (else_try),
        (assign, "$g_close_equipment_selection", 0),
        (presentation_set_duration, 0),
      (try_end),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (store_trigger_param_2, ":var1"),
      (415, ":var2"),
      (404, ":var3", ":var2"),
      (try_begin),
        (eq, "$g_close_equipment_selection", 0),
        (try_begin),
          (eq, "$g_presentation_state", 0),
          (try_begin),
            (eq, ":var0", "$g_presentation_obj_item_select_1"),
            (assign, "$g_presentation_state", 1),
            (presentation_set_duration, 0),
            (start_presentation, "prsnt_multiplayer_item_select"),
          (else_try),
            (eq, ":var0", "$g_presentation_obj_item_select_2"),
            (assign, "$g_presentation_state", 2),
            (presentation_set_duration, 0),
            (start_presentation, "prsnt_multiplayer_item_select"),
          (else_try),
            (eq, ":var0", "$g_presentation_obj_item_select_3"),
            (assign, "$g_presentation_state", 3),
            (presentation_set_duration, 0),
            (start_presentation, "prsnt_multiplayer_item_select"),
          (else_try),
            (eq, ":var0", "$g_presentation_obj_item_select_4"),
            (assign, "$g_presentation_state", 4),
            (presentation_set_duration, 0),
            (start_presentation, "prsnt_multiplayer_item_select"),
          (else_try),
            (eq, ":var0", "$g_presentation_obj_item_select_5"),
            (assign, "$g_presentation_state", 5),
            (presentation_set_duration, 0),
            (start_presentation, "prsnt_multiplayer_item_select"),
          (else_try),
            (eq, ":var0", "$g_presentation_obj_item_select_6"),
            (assign, "$g_presentation_state", 6),
            (presentation_set_duration, 0),
            (start_presentation, "prsnt_multiplayer_item_select"),
          (else_try),
            (eq, ":var0", "$g_presentation_obj_item_select_7"),
            (assign, "$g_presentation_state", 7),
            (presentation_set_duration, 0),
            (start_presentation, "prsnt_multiplayer_item_select"),
          (else_try),
            (eq, ":var0", "$g_presentation_obj_item_select_8"),
            (assign, "$g_presentation_state", 8),
            (presentation_set_duration, 0),
            (start_presentation, "prsnt_multiplayer_item_select"),
          (else_try),
            (eq, ":var0", "$g_presentation_obj_item_select_9"),
            (eq, "$g_horses_are_avaliable", 1),
            (assign, "$g_presentation_state", 9),
            (presentation_set_duration, 0),
            (start_presentation, "prsnt_multiplayer_item_select"),
          (try_end),
        (else_try),
          (gt, "$g_presentation_state", 0),
          (store_sub, ":var4", ":var0", "$g_presentation_obj_item_select_next"),
          (val_div, ":var4", 2),
          (assign, ":var5", 146),
          (try_for_range, ":var6", 46, ":var5"),
            (neg|troop_slot_eq, "trp_multiplayer_data", ":var6", -1),
            (store_sub, ":var7", ":var6", 46),
            (eq, ":var4", ":var7"),
            (troop_get_slot, ":var8", "trp_multiplayer_data", ":var6"),
            (store_add, ":var9", 2, "$g_presentation_state"),
            (val_sub, ":var9", 1),
            (508, ":var2", ":var9", ":var8"),
            (407, ":var10", ":var2"),
            (call_script, "script_multiplayer_calculate_cur_selected_items_cost", ":var2", 1),
            (overlay_set_text, "$g_presentation_obj_item_select_12", "str_total_item_cost_reg0"),
            (try_begin),
              (ge, ":var10", reg0),
              (overlay_set_color, "$g_presentation_obj_item_select_12", 16777215),
            (else_try),
              (overlay_set_color, "$g_presentation_obj_item_select_12", 16711680),
            (try_end),
            (assign, ":var5", 0),
          (try_end),
          (presentation_set_duration, 0),
          (assign, "$g_presentation_state", 0),
          (start_presentation, "prsnt_multiplayer_item_select"),
        (try_end),
        (try_begin),
          (eq, ":var0", "$g_presentation_obj_item_select_10"),
          (call_script, "script_multiplayer_set_default_item_selections_for_troop", ":var3"),
          (presentation_set_duration, 0),
          (assign, "$g_presentation_state", 0),
          (start_presentation, "prsnt_multiplayer_item_select"),
        (else_try),
          (eq, ":var0", "$g_presentation_obj_item_select_11"),
          (call_script, "script_multiplayer_send_item_selections"),
          (presentation_set_duration, 0),
          (try_begin),
            (try_begin),
              (eq, "$g_multiplayer_game_type", 6),
              (gt, "$g_multiplayer_number_of_respawn_count", 0),
              (ge, "$g_my_spawn_count", "$g_multiplayer_number_of_respawn_count"),
              (415, ":var2"),
              (402, ":var11", ":var2"),
              (this_or_next|eq, ":var11", 0),
              (ge, "$g_my_spawn_count", 999),
              (assign, "$g_show_no_more_respawns_remained", 1),
            (else_try),
              (assign, "$g_show_no_more_respawns_remained", 0),
            (try_end),
            (eq, "$g_show_no_more_respawns_remained", 1),
            (store_mission_timer_a, "$g_multiplayer_respawn_start_time"),
            (start_presentation, "prsnt_multiplayer_respawn_time_counter"),
          (try_end),
        (else_try),
          (eq, ":var0", "$g_presentation_obj_item_select_13"),
          (assign, "$g_multiplayer_bot_type_1_wanted", ":var1"),
          (390, 1, 35, ":var1"),
        (else_try),
          (eq, ":var0", "$g_presentation_obj_item_select_14"),
          (assign, "$g_multiplayer_bot_type_2_wanted", ":var1"),
          (390, 1, 36, ":var1"),
        (else_try),
          (eq, ":var0", "$g_presentation_obj_item_select_15"),
          (assign, "$g_multiplayer_bot_type_3_wanted", ":var1"),
          (390, 1, 37, ":var1"),
        (else_try),
          (eq, ":var0", "$g_presentation_obj_item_select_16"),
          (assign, "$g_multiplayer_bot_type_4_wanted", ":var1"),
          (390, 1, 38, ":var1"),
        (try_end),
      (else_try),
        (assign, "$g_close_equipment_selection", 0),
        (presentation_set_duration, 0),
      (try_end),
    ]),
    (ti_on_presentation_mouse_press,
    [
      (store_trigger_param_1, ":var0"),
      (store_trigger_param_2, ":var1"),
      (try_begin),
        (eq, "$g_close_equipment_selection", 0),
        (try_begin),
          (eq, ":var1", 1),
          (try_begin),
            (eq, "$g_presentation_state", 0),
            (415, ":var2"),
            (try_begin),
              (eq, ":var0", "$g_presentation_obj_item_select_1"),
              (store_add, ":var3", 2, 0),
              (508, ":var2", ":var3", -1),
              (presentation_set_duration, 0),
              (assign, "$g_presentation_state", 0),
              (start_presentation, "prsnt_multiplayer_item_select"),
            (else_try),
              (eq, ":var0", "$g_presentation_obj_item_select_2"),
              (store_add, ":var3", 2, 1),
              (508, ":var2", ":var3", -1),
              (presentation_set_duration, 0),
              (assign, "$g_presentation_state", 0),
              (start_presentation, "prsnt_multiplayer_item_select"),
            (else_try),
              (eq, ":var0", "$g_presentation_obj_item_select_3"),
              (store_add, ":var3", 2, 2),
              (508, ":var2", ":var3", -1),
              (presentation_set_duration, 0),
              (assign, "$g_presentation_state", 0),
              (start_presentation, "prsnt_multiplayer_item_select"),
            (else_try),
              (eq, ":var0", "$g_presentation_obj_item_select_4"),
              (store_add, ":var3", 2, 3),
              (508, ":var2", ":var3", -1),
              (presentation_set_duration, 0),
              (assign, "$g_presentation_state", 0),
              (start_presentation, "prsnt_multiplayer_item_select"),
            (else_try),
              (eq, ":var0", "$g_presentation_obj_item_select_5"),
              (store_add, ":var3", 2, 4),
              (508, ":var2", ":var3", -1),
              (presentation_set_duration, 0),
              (assign, "$g_presentation_state", 0),
              (start_presentation, "prsnt_multiplayer_item_select"),
            (else_try),
              (eq, ":var0", "$g_presentation_obj_item_select_6"),
              (store_add, ":var3", 2, 5),
              (508, ":var2", ":var3", -1),
              (presentation_set_duration, 0),
              (assign, "$g_presentation_state", 0),
              (start_presentation, "prsnt_multiplayer_item_select"),
            (else_try),
              (eq, ":var0", "$g_presentation_obj_item_select_7"),
              (store_add, ":var3", 2, 6),
              (508, ":var2", ":var3", -1),
              (presentation_set_duration, 0),
              (assign, "$g_presentation_state", 0),
              (start_presentation, "prsnt_multiplayer_item_select"),
            (else_try),
              (eq, ":var0", "$g_presentation_obj_item_select_8"),
              (store_add, ":var3", 2, 7),
              (508, ":var2", ":var3", -1),
              (presentation_set_duration, 0),
              (assign, "$g_presentation_state", 0),
              (start_presentation, "prsnt_multiplayer_item_select"),
            (else_try),
              (eq, ":var0", "$g_presentation_obj_item_select_9"),
              (eq, "$g_horses_are_avaliable", 1),
              (store_add, ":var3", 2, 8),
              (508, ":var2", ":var3", -1),
              (presentation_set_duration, 0),
              (assign, "$g_presentation_state", 0),
              (start_presentation, "prsnt_multiplayer_item_select"),
            (try_end),
          (else_try),
            (gt, "$g_presentation_state", 0),
            (presentation_set_duration, 0),
            (assign, "$g_presentation_state", 0),
            (start_presentation, "prsnt_multiplayer_item_select"),
          (try_end),
        (try_end),
      (else_try),
        (assign, "$g_close_equipment_selection", 0),
        (presentation_set_duration, 0),
      (try_end),
    ]),
    (ti_on_presentation_run,
    [
      (store_trigger_param_1, ":var0"),
      (try_begin),
        (eq, "$g_close_equipment_selection", 0),
        (try_begin),
          (key_clicked, key_escape),
          (try_begin),
            (neq, "$g_current_opened_item_details", -1),
            (971),
            (assign, "$g_current_opened_item_details", -1),
          (try_end),
          (gt, ":var0", 200),
          (presentation_set_duration, 0),
        (try_end),
      (else_try),
        (assign, "$g_close_equipment_selection", 0),
        (presentation_set_duration, 0),
      (try_end),
    ]),
  ]),

  ("multiplayer_message_1", prsntf_read_only|prsntf_manual_end_only, mesh_null,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (try_begin),
        (eq, "$g_multiplayer_message_type", 12),
        (assign, ":var0", "$g_multiplayer_message_value_1"),
        (try_begin),
          (eq, ":var0", -1),
          (assign, ":var1", 4294967295),
          (str_store_string, s0, "str_round_draw_no_one_remained"),
        (else_try),
          (try_begin),
            (eq, ":var0", 0),
            (assign, ":var1", 4281589009),
          (else_try),
            (assign, ":var1", 4294919202),
          (try_end),
          (try_begin),
            (lt, "$my_team_at_start_of_round", 2),
            (try_begin),
              (eq, "$my_team_at_start_of_round", ":var0"),
              (assign, ":var1", 4281589009),
            (else_try),
              (assign, ":var1", 4294919202),
            (try_end),
          (try_end),
          (458, ":var2", ":var0"),
          (str_store_faction_name, s1, ":var2"),
          (str_store_string, s0, "str_s1_won_round"),
        (try_end),
        (create_text_overlay, "$g_multiplayer_message_1", s0, 65552),
        (overlay_set_color, "$g_multiplayer_message_1", ":var1"),
        (try_begin),
          (neq, ":var0", -1),
          (position_set_x, pos1, 375),
        (else_try),
          (position_set_x, pos1, 400),
        (try_end),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, 400),
        (overlay_set_position, "$g_multiplayer_message_1", pos1),
        (position_set_x, pos1, 2000),
        (position_set_y, pos1, 2000),
        (overlay_set_size, "$g_multiplayer_message_1", pos1),
        (presentation_set_duration, 300),
      (else_try),
        (eq, "$g_multiplayer_message_type", 4),
        (agent_get_team, ":var0", "$g_multiplayer_message_value_1"),
        (458, ":var3", ":var0"),
        (str_store_faction_name, s1, ":var3"),
        (try_begin),
          (eq, ":var0", 0),
          (assign, ":var1", 4281589009),
        (else_try),
          (assign, ":var1", 4294919202),
        (try_end),
        (415, ":var4"),
        (try_begin),
          (ge, ":var4", 0),
          (406, ":var5", ":var4"),
          (try_begin),
            (ge, ":var5", 0),
            (agent_get_team, ":var6", ":var5"),
            (try_begin),
              (eq, ":var6", ":var0"),
              (assign, ":var1", 4281589009),
              (play_sound, "snd_team_scored_a_point"),
            (else_try),
              (assign, ":var1", 4294919202),
              (play_sound, "snd_enemy_scored_a_point"),
            (try_end),
          (try_end),
        (try_end),
        (str_store_string, s0, "str_s1_captured_flag"),
        (create_text_overlay, "$g_multiplayer_message_1", s0, 65552),
        (overlay_set_color, "$g_multiplayer_message_1", ":var1"),
        (position_set_x, pos1, 350),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, 400),
        (overlay_set_position, "$g_multiplayer_message_1", pos1),
        (position_set_x, pos1, 2000),
        (position_set_y, pos1, 2000),
        (overlay_set_size, "$g_multiplayer_message_1", pos1),
        (presentation_set_duration, 400),
      (else_try),
        (eq, "$g_multiplayer_message_type", 5),
        (try_begin),
          (ge, "$g_multiplayer_message_value_1", 0),
          (agent_get_team, ":var7", "$g_multiplayer_message_value_1"),
          (458, ":var8", ":var7"),
          (str_store_faction_name, s1, ":var8"),
          (str_store_string, s0, "str_s1_returned_flag"),
        (else_try),
          (val_add, "$g_multiplayer_message_value_1", 1),
          (val_mul, "$g_multiplayer_message_value_1", -1),
          (assign, ":var7", "$g_multiplayer_message_value_1"),
          (458, ":var8", ":var7"),
          (str_store_faction_name, s1, ":var8"),
          (str_store_string, s0, "str_s1_auto_returned_flag"),
        (try_end),
        (415, ":var4"),
        (try_begin),
          (ge, ":var4", 0),
          (406, ":var5", ":var4"),
          (try_begin),
            (ge, ":var5", 0),
            (play_sound, "snd_flag_returned"),
          (try_end),
        (try_end),
        (assign, ":var1", 4294967295),
        (create_text_overlay, "$g_multiplayer_message_1", s0, 65552),
        (overlay_set_color, "$g_multiplayer_message_1", ":var1"),
        (position_set_x, pos1, 325),
        (position_set_y, pos1, 400),
        (position_set_x, pos1, 500),
        (overlay_set_position, "$g_multiplayer_message_1", pos1),
        (position_set_x, pos1, 2000),
        (position_set_y, pos1, 2000),
        (overlay_set_size, "$g_multiplayer_message_1", pos1),
        (presentation_set_duration, 400),
      (else_try),
        (eq, "$g_multiplayer_message_type", 6),
        (agent_get_team, ":var9", "$g_multiplayer_message_value_1"),
        (458, ":var10", ":var9"),
        (str_store_faction_name, s1, ":var10"),
        (assign, ":var1", 4294967295),
        (415, ":var4"),
        (try_begin),
          (ge, ":var4", 0),
          (406, ":var5", ":var4"),
          (try_begin),
            (ge, ":var5", 0),
            (agent_get_team, ":var6", ":var5"),
            (try_begin),
              (eq, ":var6", ":var9"),
              (play_sound, "snd_enemy_flag_taken"),
            (else_try),
              (play_sound, "snd_your_flag_taken"),
            (try_end),
          (try_end),
        (try_end),
        (str_store_string, s0, "str_s1_taken_flag"),
        (create_text_overlay, "$g_multiplayer_message_1", s0, 65552),
        (overlay_set_color, "$g_multiplayer_message_1", ":var1"),
        (position_set_x, pos1, 365),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, 400),
        (overlay_set_position, "$g_multiplayer_message_1", pos1),
        (position_set_x, pos1, 2000),
        (position_set_y, pos1, 2000),
        (overlay_set_size, "$g_multiplayer_message_1", pos1),
        (presentation_set_duration, 400),
      (else_try),
        (eq, "$g_multiplayer_message_type", 9),
        (store_div, ":var0", "$g_multiplayer_message_value_1", 100),
        (store_mod, reg0, "$g_multiplayer_message_value_1", 100),
        (val_sub, ":var0", 1),
        (try_begin),
          (eq, ":var0", 0),
          (assign, ":var1", 4281589009),
        (else_try),
          (assign, ":var1", 4294919202),
        (try_end),
        (415, ":var4"),
        (try_begin),
          (ge, ":var4", 0),
          (406, ":var5", ":var4"),
          (try_begin),
            (ge, ":var5", 0),
            (agent_get_team, ":var6", ":var5"),
            (try_begin),
              (eq, ":var6", ":var0"),
              (assign, ":var1", 4281589009),
              (play_sound, "snd_team_scored_a_point"),
            (else_try),
              (assign, ":var1", 4294919202),
              (play_sound, "snd_enemy_scored_a_point"),
            (try_end),
          (try_end),
        (try_end),
        (458, ":var3", ":var0"),
        (str_store_faction_name, s1, ":var3"),
        (str_store_string, s0, "str_s1_captured_flag_reg0"),
        (create_text_overlay, "$g_multiplayer_message_1", s0, 65552),
        (overlay_set_color, "$g_multiplayer_message_1", ":var1"),
        (position_set_x, pos1, 345),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, 400),
        (overlay_set_position, "$g_multiplayer_message_1", pos1),
        (position_set_x, pos1, 2000),
        (position_set_y, pos1, 2000),
        (overlay_set_size, "$g_multiplayer_message_1", pos1),
        (presentation_set_duration, 400),
      (else_try),
        (eq, "$g_multiplayer_message_type", 10),
        (store_div, ":var0", "$g_multiplayer_message_value_1", 100),
        (store_mod, reg0, "$g_multiplayer_message_value_1", 100),
        (val_sub, ":var0", 1),
        (415, ":var4"),
        (try_begin),
          (ge, ":var4", 0),
          (406, ":var5", ":var4"),
          (try_begin),
            (ge, ":var5", 0),
            (agent_get_team, ":var6", ":var5"),
            (try_begin),
              (eq, ":var6", ":var0"),
              (play_sound, "snd_enemy_flag_taken"),
            (else_try),
              (play_sound, "snd_your_flag_taken"),
            (try_end),
          (try_end),
        (try_end),
        (assign, ":var1", 4294967295),
        (458, ":var3", ":var0"),
        (str_store_faction_name, s1, ":var3"),
        (str_store_string, s0, "str_s1_pulling_flag_reg0"),
        (create_text_overlay, "$g_multiplayer_message_1", s0, 65552),
        (overlay_set_color, "$g_multiplayer_message_1", ":var1"),
        (position_set_x, pos1, 345),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, 400),
        (overlay_set_position, "$g_multiplayer_message_1", pos1),
        (position_set_x, pos1, 2000),
        (position_set_y, pos1, 2000),
        (overlay_set_size, "$g_multiplayer_message_1", pos1),
        (presentation_set_duration, 400),
      (else_try),
        (eq, "$g_multiplayer_message_type", 8),
        (store_div, ":var0", "$g_multiplayer_message_value_1", 100),
        (store_mod, reg0, "$g_multiplayer_message_value_1", 100),
        (val_sub, ":var0", 1),
        (415, ":var4"),
        (try_begin),
          (ge, ":var4", 0),
          (406, ":var5", ":var4"),
          (try_begin),
            (ge, ":var5", 0),
            (play_sound, "snd_flag_returned"),
          (try_end),
        (try_end),
        (try_begin),
          (eq, ":var0", 0),
          (assign, ":var1", 4281589009),
        (else_try),
          (assign, ":var1", 4294919202),
        (try_end),
        (415, ":var4"),
        (try_begin),
          (ge, ":var4", 0),
          (406, ":var5", ":var4"),
          (try_begin),
            (ge, ":var5", 0),
            (agent_get_team, ":var6", ":var5"),
            (try_begin),
              (eq, ":var6", ":var0"),
              (assign, ":var1", 4281589009),
            (else_try),
              (assign, ":var1", 4294919202),
            (try_end),
          (try_end),
        (try_end),
        (458, ":var3", ":var0"),
        (str_store_faction_name, s1, ":var3"),
        (str_store_string, s0, "str_s1_neutralized_flag_reg0"),
        (create_text_overlay, "$g_multiplayer_message_1", s0, 65552),
        (overlay_set_color, "$g_multiplayer_message_1", ":var1"),
        (position_set_x, pos1, 345),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, 400),
        (overlay_set_position, "$g_multiplayer_message_1", pos1),
        (position_set_x, pos1, 2000),
        (position_set_y, pos1, 2000),
        (overlay_set_size, "$g_multiplayer_message_1", pos1),
        (presentation_set_duration, 400),
      (else_try),
        (eq, "$g_multiplayer_message_type", 13),
        (assign, ":var0", "$g_multiplayer_message_value_1"),
        (try_begin),
          (eq, ":var0", 0),
          (assign, ":var1", 4281589009),
        (else_try),
          (assign, ":var1", 4294919202),
        (try_end),
        (415, ":var4"),
        (try_begin),
          (ge, ":var4", 0),
          (406, ":var5", ":var4"),
          (try_begin),
            (ge, ":var5", 0),
            (agent_get_team, ":var6", ":var5"),
            (try_begin),
              (eq, ":var6", ":var0"),
              (assign, ":var1", 4281589009),
            (else_try),
              (assign, ":var1", 4294919202),
            (try_end),
          (try_end),
        (try_end),
        (try_begin),
          (eq, "$g_multiplayer_message_value_1", 0),
          (str_store_string, s0, "str_s1_defended_castle"),
        (else_try),
          (eq, "$g_multiplayer_message_value_1", 1),
          (str_store_string, s0, "str_s1_captured_castle"),
        (else_try),
          (str_store_string, s0, "str_round_draw"),
          (assign, ":var1", 4294967295),
        (try_end),
        (create_text_overlay, "$g_multiplayer_message_1", s0, 65552),
        (overlay_set_color, "$g_multiplayer_message_1", ":var1"),
        (try_begin),
          (neq, "$g_multiplayer_message_value_1", -1),
          (position_set_x, pos1, 325),
        (else_try),
          (position_set_x, pos1, 400),
        (try_end),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, 400),
        (overlay_set_position, "$g_multiplayer_message_1", pos1),
        (position_set_x, pos1, 2000),
        (position_set_y, pos1, 2000),
        (overlay_set_size, "$g_multiplayer_message_1", pos1),
        (presentation_set_duration, 400),
      (else_try),
        (eq, "$g_multiplayer_message_type", 14),
        (assign, ":var1", 4294967295),
        (str_store_string, s0, "str_round_draw"),
        (create_text_overlay, "$g_multiplayer_message_1", s0, 65552),
        (overlay_set_color, "$g_multiplayer_message_1", ":var1"),
        (position_set_x, pos1, 375),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, 400),
        (overlay_set_position, "$g_multiplayer_message_1", pos1),
        (position_set_x, pos1, 2000),
        (position_set_y, pos1, 2000),
        (overlay_set_size, "$g_multiplayer_message_1", pos1),
        (presentation_set_duration, 400),
      (else_try),
        (eq, "$g_multiplayer_message_type", 18),
        (assign, ":var1", 4294967295),
        (str_store_string, s0, "str_death_mode_started"),
        (create_text_overlay, "$g_multiplayer_message_1", s0, 65552),
        (overlay_set_color, "$g_multiplayer_message_1", ":var1"),
        (position_set_x, pos1, 350),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, 400),
        (overlay_set_position, "$g_multiplayer_message_1", pos1),
        (position_set_x, pos1, 2000),
        (position_set_y, pos1, 2000),
        (overlay_set_size, "$g_multiplayer_message_1", pos1),
        (presentation_set_duration, 400),
      (else_try),
        (eq, "$g_multiplayer_message_type", 15),
        (try_begin),
          (lt, "$g_multiplayer_message_value_1", 0),
          (val_mul, "$g_multiplayer_message_value_1", -1),
          (assign, ":var11", 0),
          (458, ":var2", 1),
          (str_store_faction_name, s1, ":var2"),
        (else_try),
          (assign, ":var11", 1),
          (458, ":var2", 0),
          (str_store_faction_name, s1, ":var2"),
        (try_end),
        (try_begin),
          (eq, "$g_multiplayer_message_value_1", 1),
          (assign, ":var1", 4281589009),
        (else_try),
          (assign, ":var1", 4294919202),
        (try_end),
        (415, ":var4"),
        (try_begin),
          (ge, ":var4", 0),
          (try_begin),
            (415, ":var4"),
            (402, ":var12", ":var4"),
            (neq, ":var11", ":var12"),
            (assign, ":var1", 4281589009),
          (else_try),
            (assign, ":var1", 4294919202),
          (try_end),
        (try_end),
        (try_begin),
          (eq, "$g_multiplayer_message_value_1", 9),
          (str_store_string, s0, "str_s1_destroyed_all_targets"),
        (else_try),
          (eq, "$g_multiplayer_message_value_1", 1),
          (str_store_string, s0, "str_s1_destroyed_catapult"),
        (else_try),
          (eq, "$g_multiplayer_message_value_1", 2),
          (str_store_string, s0, "str_s1_destroyed_trebuchet"),
        (try_end),
        (create_text_overlay, "$g_multiplayer_message_1", s0, 65552),
        (overlay_set_color, "$g_multiplayer_message_1", ":var1"),
        (position_set_x, pos1, 350),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, 400),
        (overlay_set_position, "$g_multiplayer_message_1", pos1),
        (position_set_x, pos1, 2000),
        (position_set_y, pos1, 2000),
        (overlay_set_size, "$g_multiplayer_message_1", pos1),
        (presentation_set_duration, 400),
      (else_try),
        (eq, "$g_multiplayer_message_type", 16),
        (try_begin),
          (eq, "$g_defender_team", 0),
          (assign, ":var1", 4281589009),
        (else_try),
          (assign, ":var1", 4294919202),
        (try_end),
        (415, ":var4"),
        (try_begin),
          (ge, ":var4", 0),
          (406, ":var5", ":var4"),
          (try_begin),
            (ge, ":var5", 0),
            (agent_get_team, ":var6", ":var5"),
            (try_begin),
              (eq, ":var6", "$g_defender_team"),
              (assign, ":var1", 4281589009),
            (else_try),
              (assign, ":var1", 4294919202),
            (try_end),
          (try_end),
        (try_end),
        (assign, ":var13", "$g_multiplayer_message_value_1"),
        (458, ":var2", "$g_defender_team"),
        (str_store_faction_name, s1, ":var2"),
        (try_begin),
          (eq, ":var13", 1),
          (str_store_string, s0, "str_s1_saved_1_target"),
        (else_try),
          (eq, ":var13", 2),
          (str_store_string, s0, "str_s1_saved_2_targets"),
        (try_end),
        (create_text_overlay, "$g_multiplayer_message_1", s0, 65552),
        (overlay_set_color, "$g_multiplayer_message_1", ":var1"),
        (position_set_x, pos1, 350),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, 400),
        (overlay_set_position, "$g_multiplayer_message_1", pos1),
        (position_set_x, pos1, 2000),
        (position_set_y, pos1, 2000),
        (overlay_set_size, "$g_multiplayer_message_1", pos1),
        (presentation_set_duration, 400),
      (else_try),
        (eq, "$g_multiplayer_message_type", 17),
        (assign, ":var0", "$g_multiplayer_message_value_1"),
        (try_begin),
          (eq, ":var0", 0),
          (assign, ":var1", 4281589009),
        (else_try),
          (assign, ":var1", 4294919202),
        (try_end),
        (415, ":var4"),
        (try_begin),
          (ge, ":var4", 0),
          (406, ":var5", ":var4"),
          (try_begin),
            (ge, ":var5", 0),
            (agent_get_team, ":var6", ":var5"),
            (try_begin),
              (eq, ":var6", ":var0"),
              (assign, ":var1", 4281589009),
            (else_try),
              (assign, ":var1", 4294919202),
            (try_end),
          (try_end),
        (try_end),
        (try_begin),
          (eq, "$g_defender_team", 0),
          (458, ":var2", 1),
        (else_try),
          (458, ":var2", 0),
        (try_end),
        (str_store_faction_name, s1, ":var2"),
        (str_store_string, s0, "str_s1_won_round"),
        (create_text_overlay, "$g_multiplayer_message_1", s0, 65552),
        (overlay_set_color, "$g_multiplayer_message_1", ":var1"),
        (position_set_x, pos1, 350),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, 400),
        (overlay_set_position, "$g_multiplayer_message_1", pos1),
        (position_set_x, pos1, 2000),
        (position_set_y, pos1, 2000),
        (overlay_set_size, "$g_multiplayer_message_1", pos1),
        (presentation_set_duration, 400),
      (try_end),
    ]),
    (ti_on_presentation_run,
    [
    ]),
  ]),

  ("multiplayer_message_2", prsntf_read_only|prsntf_manual_end_only, mesh_null,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (try_begin),
        (eq, "$g_multiplayer_message_type", 2),
        (assign, ":var0", 4294967295),
        (str_store_string, s0, "str_auto_team_balance_done"),
        (create_text_overlay, "$g_multiplayer_message_2", s0, 65552),
        (overlay_set_color, "$g_multiplayer_message_2", ":var0"),
        (position_set_x, pos1, 375),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, 550),
        (overlay_set_position, "$g_multiplayer_message_2", pos1),
        (position_set_x, pos1, 2000),
        (position_set_y, pos1, 2000),
        (overlay_set_size, "$g_multiplayer_message_2", pos1),
        (presentation_set_duration, 300),
      (else_try),
        (eq, "$g_multiplayer_message_type", 3),
        (assign, ":var0", 4294967295),
        (try_begin),
          (neq, "$g_multiplayer_game_type", 2),
          (neq, "$g_multiplayer_game_type", 3),
          (neq, "$g_multiplayer_game_type", 6),
          (str_store_string, s0, "str_auto_team_balance_in_20_seconds"),
          (position_set_x, pos1, 375),
        (else_try),
          (str_store_string, s0, "str_auto_team_balance_next_round"),
          (position_set_x, pos1, 375),
        (try_end),
        (create_text_overlay, "$g_multiplayer_message_2", s0, 65552),
        (overlay_set_color, "$g_multiplayer_message_2", ":var0"),
        (position_set_y, pos1, 550),
        (position_set_x, pos1, 500),
        (overlay_set_position, "$g_multiplayer_message_2", pos1),
        (position_set_x, pos1, 2000),
        (position_set_y, pos1, 2000),
        (overlay_set_size, "$g_multiplayer_message_2", pos1),
        (presentation_set_duration, 300),
      (try_end),
    ]),
    (ti_on_presentation_run,
    [
    ]),
  ]),

  ("multiplayer_message_3", prsntf_read_only|prsntf_manual_end_only, mesh_null,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (try_begin),
        (eq, "$g_multiplayer_message_type", 7),
        (assign, ":var0", 4294967295),
        (try_begin),
          (eq, "$g_multiplayer_message_value_3", 1),
          (str_store_string, s0, "str_poll_result_yes"),
        (else_try),
          (str_store_string, s0, "str_poll_result_no"),
        (try_end),
        (create_text_overlay, "$g_multiplayer_message_3", s0, 65552),
        (overlay_set_color, "$g_multiplayer_message_3", ":var0"),
        (position_set_x, pos1, 380),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, 475),
        (overlay_set_position, "$g_multiplayer_message_3", pos1),
        (position_set_x, pos1, 2000),
        (position_set_y, pos1, 2000),
        (overlay_set_size, "$g_multiplayer_message_3", pos1),
        (presentation_set_duration, 400),
      (try_end),
    ]),
    (ti_on_presentation_run,
    [
    ]),
  ]),

  ("multiplayer_round_time_counter", prsntf_read_only|prsntf_manual_end_only, mesh_null,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (assign, "$g_multiplayer_last_round_time_counter_value", -1),
      (str_clear, s0),
      (create_text_overlay, "$g_multiplayer_round_time_counter_overlay", s0, 98308),
      (overlay_set_color, "$g_multiplayer_round_time_counter_overlay", 16777215),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 690),
      (overlay_set_position, "$g_multiplayer_round_time_counter_overlay", pos1),
      (position_set_x, pos1, 2000),
      (position_set_y, pos1, 2000),
      (overlay_set_size, "$g_multiplayer_round_time_counter_overlay", pos1),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_run,
    [
      (store_mission_timer_a, ":var0"),
      (store_sub, ":var1", ":var0", "$g_round_start_time"),
      (store_sub, ":var2", "$g_multiplayer_round_max_seconds", ":var1"),
      (val_max, ":var2", 0),
      (try_begin),
        (neq, "$g_multiplayer_last_round_time_counter_value", ":var2"),
        (assign, "$g_multiplayer_last_round_time_counter_value", ":var2"),
        (store_div, reg0, ":var2", 60),
        (store_div, reg1, ":var2", 10),
        (val_mod, reg1, 6),
        (assign, reg2, ":var2"),
        (val_mod, reg2, 10),
        (str_store_string, s0, "str_reg0_dd_reg1reg2"),
        (overlay_set_text, "$g_multiplayer_round_time_counter_overlay", s0),
      (try_end),
    ]),
  ]),

  ("multiplayer_team_score_display", prsntf_read_only|prsntf_manual_end_only, mesh_null,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (assign, "$g_multiplayer_team_1_last_displayed_score", -1),
      (assign, "$g_multiplayer_team_2_last_displayed_score", -1),
      (str_clear, s0),
      (create_text_overlay, "$g_multiplayer_team_1_score_display_overlay", s0, 98308),
      (overlay_set_color, "$g_multiplayer_team_1_score_display_overlay", 16777215),
      (position_set_x, pos1, 40),
      (position_set_y, pos1, 700),
      (overlay_set_position, "$g_multiplayer_team_1_score_display_overlay", pos1),
      (position_set_x, pos1, 1500),
      (position_set_y, pos1, 1500),
      (overlay_set_size, "$g_multiplayer_team_1_score_display_overlay", pos1),
      (create_text_overlay, "$g_multiplayer_team_2_score_display_overlay", s0, 98308),
      (overlay_set_color, "$g_multiplayer_team_2_score_display_overlay", 16777215),
      (position_set_x, pos1, 40),
      (position_set_y, pos1, 645),
      (overlay_set_position, "$g_multiplayer_team_2_score_display_overlay", pos1),
      (position_set_x, pos1, 1500),
      (position_set_y, pos1, 1500),
      (overlay_set_size, "$g_multiplayer_team_2_score_display_overlay", pos1),
      (try_begin),
        (eq, "$g_multiplayer_team_1_faction", "fac_kingdom_4"),
        (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_1"),
      (else_try),
        (eq, "$g_multiplayer_team_1_faction", "fac_kingdom_2"),
        (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_2"),
      (else_try),
        (eq, "$g_multiplayer_team_1_faction", "fac_kingdom_3"),
        (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_3"),
      (else_try),
        (eq, "$g_multiplayer_team_1_faction", "fac_kingdom_5"),
        (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_4"),
      (else_try),
        (eq, "$g_multiplayer_team_1_faction", "fac_kingdom_1"),
        (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_6"),
      (try_end),
      (position_set_x, pos3, 25),
      (position_set_y, pos3, 715),
      (overlay_set_position, reg0, pos3),
      (position_set_x, pos1, 50),
      (position_set_y, pos1, 50),
      (overlay_set_size, reg0, pos1),
      (try_begin),
        (eq, "$g_multiplayer_team_1_faction", "$g_multiplayer_team_2_faction"),
        (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_7"),
      (else_try),
        (eq, "$g_multiplayer_team_2_faction", "fac_kingdom_4"),
        (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_1"),
      (else_try),
        (eq, "$g_multiplayer_team_2_faction", "fac_kingdom_2"),
        (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_2"),
      (else_try),
        (eq, "$g_multiplayer_team_2_faction", "fac_kingdom_3"),
        (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_3"),
      (else_try),
        (eq, "$g_multiplayer_team_2_faction", "fac_kingdom_5"),
        (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_4"),
      (else_try),
        (eq, "$g_multiplayer_team_2_faction", "fac_kingdom_1"),
        (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_6"),
      (try_end),
      (position_set_x, pos3, 25),
      (position_set_y, pos3, 660),
      (overlay_set_position, reg0, pos3),
      (position_set_x, pos1, 50),
      (position_set_y, pos1, 50),
      (overlay_set_size, reg0, pos1),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_run,
    [
      (455, ":var0", 0),
      (455, ":var1", 1),
      (try_begin),
        (this_or_next|neq, ":var0", "$g_multiplayer_team_1_last_displayed_score"),
        (neq, ":var1", "$g_multiplayer_team_2_last_displayed_score"),
        (assign, "$g_multiplayer_team_1_last_displayed_score", ":var0"),
        (assign, "$g_multiplayer_team_2_last_displayed_score", ":var1"),
        (str_store_faction_name, s0, "$g_multiplayer_team_1_faction"),
        (assign, reg0, ":var0"),
        (overlay_set_text, "$g_multiplayer_team_1_score_display_overlay", "str_reg0"),
        (str_store_faction_name, s0, "$g_multiplayer_team_2_faction"),
        (assign, reg0, ":var1"),
        (overlay_set_text, "$g_multiplayer_team_2_score_display_overlay", "str_reg0"),
      (try_end),
    ]),
  ]),

  ("multiplayer_flag_projection_display", prsntf_read_only|prsntf_manual_end_only, mesh_null,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (store_sub, ":var0", "$g_multiplayer_team_1_faction", "fac_kingdom_1"),
      (val_add, ":var0", "mesh_flag_project_sw"),
      (create_mesh_overlay, "$g_presentation_obj_flag_projection_display_1", ":var0"),
      (val_sub, ":var0", "mesh_flag_project_sw"),
      (val_add, ":var0", "mesh_flag_project_sw_miss"),
      (create_mesh_overlay, "$g_presentation_obj_flag_projection_display_2", ":var0"),
      (try_begin),
        (neq, "$g_multiplayer_team_1_faction", "$g_multiplayer_team_2_faction"),
        (store_sub, ":var0", "$g_multiplayer_team_2_faction", "fac_kingdom_1"),
        (val_add, ":var0", "mesh_flag_project_sw"),
        (create_mesh_overlay, "$g_presentation_obj_flag_projection_display_3", ":var0"),
        (val_sub, ":var0", "mesh_flag_project_sw"),
        (val_add, ":var0", "mesh_flag_project_sw_miss"),
        (create_mesh_overlay, "$g_presentation_obj_flag_projection_display_4", ":var0"),
      (else_try),
        (assign, ":var0", "mesh_flag_project_rb"),
        (create_mesh_overlay, "$g_presentation_obj_flag_projection_display_3", ":var0"),
        (assign, ":var0", "mesh_flag_project_rb_miss"),
        (create_mesh_overlay, "$g_presentation_obj_flag_projection_display_4", ":var0"),
      (try_end),
      (position_set_x, pos1, 250),
      (position_set_y, pos1, 250),
      (overlay_set_size, "$g_presentation_obj_flag_projection_display_1", pos1),
      (overlay_set_size, "$g_presentation_obj_flag_projection_display_2", pos1),
      (overlay_set_size, "$g_presentation_obj_flag_projection_display_3", pos1),
      (overlay_set_size, "$g_presentation_obj_flag_projection_display_4", pos1),
      (947, "$g_presentation_obj_flag_projection_display_1", 0),
      (947, "$g_presentation_obj_flag_projection_display_2", 0),
      (947, "$g_presentation_obj_flag_projection_display_3", 0),
      (947, "$g_presentation_obj_flag_projection_display_4", 0),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_run,
    [
      (set_fixed_point_multiplier, 1000),
      (scene_prop_get_instance, ":var0", "$team_1_flag_scene_prop", 0),
      (529, ":var1", 0, 0),
      (try_begin),
        (neq, ":var1", 1),
        (prop_instance_get_position, pos1, ":var0"),
      (else_try),
        (entry_point_get_position, pos1, 64),
      (try_end),
      (position_move_z, pos1, 200, 1),
      (scene_prop_get_instance, ":var2", "$team_2_flag_scene_prop", 0),
      (529, ":var3", 1, 0),
      (try_begin),
        (neq, ":var3", 1),
        (prop_instance_get_position, pos2, ":var2"),
      (else_try),
        (entry_point_get_position, pos2, 65),
      (try_end),
      (position_move_z, pos2, 200, 1),
      (750, 3, 1),
      (position_get_x, ":var4", pos3),
      (position_get_y, ":var5", pos3),
      (position_set_y, pos3, ":var5"),
      (try_begin),
        (is_between, ":var4", -100, 1100),
        (is_between, ":var5", -100, 850),
        (415, ":var6"),
        (try_begin),
          (ge, ":var6", 0),
          (402, ":var7", ":var6"),
        (else_try),
          (assign, ":var7", 2),
        (try_end),
        (try_begin),
          (neq, ":var7", 1),
          (try_begin),
            (neq, ":var1", 1),
            (overlay_set_position, "$g_presentation_obj_flag_projection_display_1", pos3),
            (947, "$g_presentation_obj_flag_projection_display_1", 1),
            (947, "$g_presentation_obj_flag_projection_display_2", 0),
          (else_try),
            (try_begin),
              (eq, ":var7", 0),
              (assign, ":var8", 64),
            (else_try),
              (assign, ":var8", 65),
            (try_end),
            (entry_point_get_position, pos5, ":var8"),
            (750, 3, 5),
            (overlay_set_position, "$g_presentation_obj_flag_projection_display_2", pos3),
            (947, "$g_presentation_obj_flag_projection_display_2", 1),
            (947, "$g_presentation_obj_flag_projection_display_1", 0),
          (try_end),
        (else_try),
          (try_begin),
            (neq, ":var1", 1),
            (overlay_set_position, "$g_presentation_obj_flag_projection_display_1", pos3),
            (947, "$g_presentation_obj_flag_projection_display_1", 1),
            (947, "$g_presentation_obj_flag_projection_display_2", 0),
          (try_end),
        (try_end),
      (else_try),
        (947, "$g_presentation_obj_flag_projection_display_1", 0),
        (947, "$g_presentation_obj_flag_projection_display_2", 0),
      (try_end),
      (750, 3, 2),
      (position_get_x, ":var4", pos3),
      (position_get_y, ":var5", pos3),
      (position_set_y, pos3, ":var5"),
      (try_begin),
        (is_between, ":var4", -100, 1100),
        (is_between, ":var5", -100, 850),
        (529, ":var3", 1, 0),
        (415, ":var6"),
        (try_begin),
          (ge, ":var6", 0),
          (402, ":var7", ":var6"),
        (else_try),
          (assign, ":var7", 2),
        (try_end),
        (try_begin),
          (neq, ":var7", 0),
          (try_begin),
            (neq, ":var3", 1),
            (overlay_set_position, "$g_presentation_obj_flag_projection_display_3", pos3),
            (947, "$g_presentation_obj_flag_projection_display_3", 1),
            (947, "$g_presentation_obj_flag_projection_display_4", 0),
          (else_try),
            (try_begin),
              (eq, ":var7", 0),
              (assign, ":var8", 64),
            (else_try),
              (assign, ":var8", 65),
            (try_end),
            (entry_point_get_position, pos5, ":var8"),
            (750, 3, 5),
            (overlay_set_position, "$g_presentation_obj_flag_projection_display_4", pos3),
            (947, "$g_presentation_obj_flag_projection_display_4", 1),
            (947, "$g_presentation_obj_flag_projection_display_3", 0),
          (try_end),
        (else_try),
          (try_begin),
            (neq, ":var3", 1),
            (overlay_set_position, "$g_presentation_obj_flag_projection_display_3", pos3),
            (947, "$g_presentation_obj_flag_projection_display_3", 1),
            (947, "$g_presentation_obj_flag_projection_display_4", 0),
          (try_end),
        (try_end),
      (else_try),
        (947, "$g_presentation_obj_flag_projection_display_3", 0),
        (947, "$g_presentation_obj_flag_projection_display_4", 0),
      (try_end),
    ]),
  ]),

  ("multiplayer_flag_projection_display_bt", prsntf_read_only|prsntf_manual_end_only, mesh_null,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (store_sub, ":var0", "$g_multiplayer_team_1_faction", "fac_kingdom_1"),
      (val_add, ":var0", "mesh_flag_project_sw"),
      (create_mesh_overlay, "$g_presentation_obj_flag_projection_display_1", ":var0"),
      (try_begin),
        (neq, "$g_multiplayer_team_1_faction", "$g_multiplayer_team_2_faction"),
        (store_sub, ":var0", "$g_multiplayer_team_2_faction", "fac_kingdom_1"),
        (val_add, ":var0", "mesh_flag_project_sw"),
      (else_try),
        (assign, ":var0", "mesh_flag_project_rb"),
      (try_end),
      (create_mesh_overlay, "$g_presentation_obj_flag_projection_display_3", ":var0"),
      (position_set_x, pos1, 250),
      (position_set_y, pos1, 250),
      (overlay_set_size, "$g_presentation_obj_flag_projection_display_1", pos1),
      (overlay_set_size, "$g_presentation_obj_flag_projection_display_3", pos1),
      (947, "$g_presentation_obj_flag_projection_display_1", 0),
      (947, "$g_presentation_obj_flag_projection_display_3", 0),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_run,
    [
      (try_begin),
        (eq, "$g_round_ended", 0),
        (set_fixed_point_multiplier, 1000),
        (scene_prop_get_instance, ":var0", "$team_1_flag_scene_prop", 0),
        (prop_instance_get_position, pos1, ":var0"),
        (position_move_z, pos1, 250, 1),
        (scene_prop_get_instance, ":var1", "$team_2_flag_scene_prop", 0),
        (prop_instance_get_position, pos2, ":var1"),
        (position_move_z, pos2, 250, 1),
        (750, 3, 1),
        (position_get_x, ":var2", pos3),
        (position_get_y, ":var3", pos3),
        (position_set_y, pos3, ":var3"),
        (try_begin),
          (is_between, ":var2", -100, 1100),
          (is_between, ":var3", -100, 850),
          (overlay_set_position, "$g_presentation_obj_flag_projection_display_1", pos3),
          (947, "$g_presentation_obj_flag_projection_display_1", 1),
        (else_try),
          (947, "$g_presentation_obj_flag_projection_display_1", 0),
        (try_end),
        (750, 3, 2),
        (position_get_x, ":var2", pos3),
        (position_get_y, ":var3", pos3),
        (position_set_y, pos3, ":var3"),
        (try_begin),
          (is_between, ":var2", -100, 1100),
          (is_between, ":var3", -100, 850),
          (overlay_set_position, "$g_presentation_obj_flag_projection_display_3", pos3),
          (947, "$g_presentation_obj_flag_projection_display_3", 1),
        (else_try),
          (947, "$g_presentation_obj_flag_projection_display_3", 0),
        (try_end),
      (else_try),
        (presentation_set_duration, 0),
      (try_end),
    ]),
  ]),

  ("multiplayer_destructible_targets_display", prsntf_read_only|prsntf_manual_end_only, mesh_null,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (try_begin),
        (eq, "$g_defender_team", 0),
        (store_sub, ":var0", "$g_multiplayer_team_1_faction", "fac_kingdom_1"),
      (else_try),
        (store_sub, ":var0", "$g_multiplayer_team_2_faction", "fac_kingdom_1"),
      (try_end),
      (val_add, ":var0", "mesh_flag_project_sw"),
      (create_mesh_overlay, "$g_presentation_obj_flag_projection_display_1", ":var0"),
      (create_mesh_overlay, "$g_presentation_obj_flag_projection_display_2", ":var0"),
      (position_set_x, pos1, 250),
      (position_set_y, pos1, 250),
      (overlay_set_size, "$g_presentation_obj_flag_projection_display_1", pos1),
      (overlay_set_size, "$g_presentation_obj_flag_projection_display_2", pos1),
      (947, "$g_presentation_obj_flag_projection_display_1", 0),
      (947, "$g_presentation_obj_flag_projection_display_2", 0),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_run,
    [
      (try_begin),
        (eq, "$g_round_ended", 0),
        (set_fixed_point_multiplier, 1000),
        (scene_prop_get_instance, ":var0", "$g_destructible_target_1", 0),
        (prop_instance_get_position, pos1, ":var0"),
        (prop_instance_get_position, pos1, ":var0"),
        (position_move_z, pos1, 250, 1),
        (scene_prop_get_instance, ":var1", "$g_destructible_target_2", 0),
        (prop_instance_get_position, pos2, ":var1"),
        (prop_instance_get_position, pos2, ":var1"),
        (position_move_z, pos2, 250, 1),
        (750, 3, 1),
        (position_get_x, ":var2", pos3),
        (position_get_y, ":var3", pos3),
        (position_set_y, pos3, ":var3"),
        (try_begin),
          (is_between, ":var2", -100, 1100),
          (is_between, ":var3", -100, 850),
          (prop_instance_get_starting_position, pos0, ":var0"),
          (prop_instance_get_position, pos1, ":var0"),
          (position_is_behind_position, ":var4", pos0, 1),
          (le, ":var4", 2),
          (overlay_set_position, "$g_presentation_obj_flag_projection_display_1", pos3),
          (947, "$g_presentation_obj_flag_projection_display_1", 1),
        (else_try),
          (947, "$g_presentation_obj_flag_projection_display_1", 0),
        (try_end),
        (750, 3, 2),
        (position_get_x, ":var2", pos3),
        (position_get_y, ":var3", pos3),
        (position_set_y, pos3, ":var3"),
        (try_begin),
          (is_between, ":var2", -100, 1100),
          (is_between, ":var3", -100, 850),
          (prop_instance_get_starting_position, pos0, ":var1"),
          (prop_instance_get_position, pos1, ":var1"),
          (position_is_behind_position, ":var4", pos0, 1),
          (le, ":var4", 2),
          (overlay_set_position, "$g_presentation_obj_flag_projection_display_2", pos3),
          (947, "$g_presentation_obj_flag_projection_display_2", 1),
        (else_try),
          (947, "$g_presentation_obj_flag_projection_display_2", 0),
        (try_end),
      (else_try),
        (presentation_set_duration, 0),
      (try_end),
    ]),
  ]),

  ("multiplayer_respawn_time_counter", prsntf_read_only|prsntf_manual_end_only, mesh_null,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (assign, "$g_multiplayer_respawn_counter_overlay", -1),
      (assign, "$g_multiplayer_respawn_remained_overlay", -1),
      (assign, ":var0", 0),
      (try_begin),
        (eq, "$g_multiplayer_message_type", 13),
        (this_or_next|eq, "$g_round_ended", 1),
        (eq, "$g_flag_is_not_ready", 1),
        (assign, ":var0", 1),
      (try_end),
      (eq, ":var0", 0),
      (assign, "$g_multiplayer_last_respawn_counter_value", -1),
      (str_clear, s0),
      (create_text_overlay, "$g_multiplayer_respawn_counter_overlay", s0, 65552),
      (overlay_set_color, "$g_multiplayer_respawn_counter_overlay", 16777215),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 600),
      (overlay_set_position, "$g_multiplayer_respawn_counter_overlay", pos1),
      (position_set_x, pos1, 2000),
      (position_set_y, pos1, 2000),
      (overlay_set_size, "$g_multiplayer_respawn_counter_overlay", pos1),
      (str_clear, s0),
      (create_text_overlay, "$g_multiplayer_respawn_remained_overlay", s0, 65552),
      (overlay_set_color, "$g_multiplayer_respawn_remained_overlay", 16777215),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 570),
      (overlay_set_position, "$g_multiplayer_respawn_remained_overlay", pos1),
      (position_set_x, pos1, 1400),
      (position_set_y, pos1, 1400),
      (overlay_set_size, "$g_multiplayer_respawn_remained_overlay", pos1),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_run,
    [
      (ge, "$g_multiplayer_respawn_counter_overlay", 0),
      (415, ":var0"),
      (try_begin),
        (ge, ":var0", 0),
        (402, ":var1", ":var0"),
        (try_begin),
          (eq, ":var1", 2),
          (presentation_set_duration, 0),
        (else_try),
          (store_mission_timer_a, ":var2"),
          (store_sub, ":var3", ":var2", "$g_multiplayer_respawn_start_time"),
          (try_begin),
            (eq, "$g_show_no_more_respawns_remained", 0),
            (assign, ":var4", "$g_multiplayer_respawn_period"),
            (try_begin),
              (eq, "$g_multiplayer_game_type", 6),
              (402, ":var1", ":var0"),
              (eq, ":var1", 0),
              (val_add, ":var4", 27),
            (try_end),
          (else_try),
            (assign, ":var4", 6),
          (try_end),
          (store_sub, ":var5", ":var4", ":var3"),
          (try_begin),
            (le, ":var5", 0),
            (presentation_set_duration, 0),
          (else_try),
            (neq, "$g_multiplayer_last_respawn_counter_value", ":var5"),
            (assign, "$g_multiplayer_last_respawn_counter_value", ":var5"),
            (try_begin),
              (eq, "$g_show_no_more_respawns_remained", 0),
              (assign, reg0, ":var5"),
              (str_store_string, s0, "str_respawning_in_reg0_seconds"),
              (try_begin),
                (gt, "$g_multiplayer_number_of_respawn_count", 0),
                (store_sub, reg0, "$g_multiplayer_number_of_respawn_count", "$g_my_spawn_count"),
                (415, ":var0"),
                (402, ":var6", ":var0"),
                (eq, ":var6", 0),
                (try_begin),
                  (gt, reg0, 1),
                  (str_store_string, s1, "str_reg0_respawns_remained"),
                (else_try),
                  (str_store_string, s1, "str_this_is_your_last_respawn"),
                (try_end),
              (else_try),
                (str_clear, s1),
              (try_end),
            (else_try),
              (eq, "$g_show_no_more_respawns_remained", 1),
              (str_store_string, s0, "str_no_more_respawns_remained_this_round"),
              (str_clear, s1),
              (str_store_string, s1, "str_wait_next_round"),
            (try_end),
            (overlay_set_text, "$g_multiplayer_respawn_counter_overlay", s0),
            (overlay_set_text, "$g_multiplayer_respawn_remained_overlay", s1),
          (try_end),
        (try_end),
      (else_try),
        (presentation_set_duration, 0),
      (try_end),
      (try_begin),
        (eq, "$g_multiplayer_message_type", 13),
        (this_or_next|eq, "$g_round_ended", 1),
        (eq, "$g_flag_is_not_ready", 1),
        (presentation_set_duration, 0),
      (try_end),
    ]),
  ]),

  ("multiplayer_stats_chart", prsntf_read_only|prsntf_manual_end_only, mesh_null,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (create_mesh_overlay, reg0, "mesh_mp_score_b"),
      (position_set_x, pos1, 100),
      (position_set_y, pos1, 100),
      (overlay_set_position, reg0, pos1),
      (position_set_x, pos1, 1000),
      (position_set_y, pos1, 1000),
      (overlay_set_size, reg0, pos1),
      (assign, ":var0", 0),
      (assign, ":var1", 0),
      (assign, ":var2", 0),
      (400, ":var3"),
      (try_for_range, ":var4", 0, ":var3"),
        (store_add, ":var5", ":var4", 186),
        (try_begin),
          (401, ":var4"),
          (troop_set_slot, "trp_multiplayer_data", ":var5", 1),
          (402, ":var6", ":var4"),
          (try_begin),
            (eq, ":var6", 0),
            (val_add, ":var0", 1),
          (else_try),
            (eq, ":var6", 1),
            (val_add, ":var1", 1),
          (else_try),
            (eq, ":var6", 2),
            (val_add, ":var2", 1),
          (try_end),
        (else_try),
          (troop_set_slot, "trp_multiplayer_data", ":var5", 0),
        (try_end),
      (try_end),
      (try_begin),
        (gt, "$g_multiplayer_num_bots_team_1", 0),
        (val_add, ":var0", 1),
      (try_end),
      (try_begin),
        (gt, "$g_multiplayer_num_bots_team_2", 0),
        (val_add, ":var1", 1),
      (try_end),
      (assign, ":var7", ":var0"),
      (val_max, ":var7", ":var1"),
      (val_add, ":var7", ":var2"),
      (str_clear, s0),
      (create_text_overlay, "$g_presentation_obj_stats_chart_container", s0, 131072),
      (position_set_x, pos1, 100),
      (position_set_y, pos1, 120),
      (overlay_set_position, "$g_presentation_obj_stats_chart_container", pos1),
      (position_set_x, pos1, 746),
      (position_set_y, pos1, 530),
      (overlay_set_area_size, "$g_presentation_obj_stats_chart_container", pos1),
      (945, "$g_presentation_obj_stats_chart_container"),
      (store_mul, ":var8", ":var7", 20),
      (val_add, ":var8", 100),
      (try_begin),
        (gt, ":var2", 0),
        (val_add, ":var8", 70),
      (try_end),
      (415, ":var9"),
      (try_begin),
        (gt, ":var8", 490),
        (assign, "$g_stats_chart_update_period", 8),
      (else_try),
        (assign, "$g_stats_chart_update_period", 1),
      (try_end),
      (try_begin),
        (eq, "$g_multiplayer_game_type", 5),
        (call_script, "script_get_headquarters_scores"),
        (assign, ":var10", reg0),
        (assign, ":var11", reg1),
      (try_end),
      (try_for_range, ":var12", 0, 2),
        (assign, ":var13", 0),
        (400, ":var3"),
        (try_for_range, ":var4", 0, ":var3"),
          (401, ":var4"),
          (402, ":var14", ":var4"),
          (eq, ":var14", ":var12"),
          (val_add, ":var13", 1),
        (try_end),
        (assign, reg0, ":var13"),
        (try_begin),
          (neq, ":var13", 1),
          (create_text_overlay, reg1, "str_reg0_players", 0),
        (else_try),
          (create_text_overlay, reg1, "str_reg0_player", 0),
        (try_end),
        (assign, ":var15", ":var8"),
        (458, ":var16", ":var12"),
        (str_store_faction_name, s1, ":var16"),
        (create_text_overlay, reg0, s1, 0),
        (try_begin),
          (eq, ":var12", 0),
          (overlay_set_color, reg0, 16711680),
          (overlay_set_color, reg1, 16711680),
        (else_try),
          (overlay_set_color, reg0, 39423),
          (overlay_set_color, reg1, 39423),
        (try_end),
        (assign, ":var17", 373),
        (store_mul, ":var18", ":var17", ":var12"),
        (val_add, ":var18", 42),
        (store_add, ":var19", ":var18", 15),
        (position_set_x, pos3, ":var19"),
        (position_set_y, pos3, ":var15"),
        (store_add, ":var20", ":var18", 35),
        (position_set_x, pos1, ":var20"),
        (position_set_y, pos1, ":var15"),
        (copy_position, pos2, pos1),
        (store_sub, ":var21", ":var15", 10),
        (position_set_x, pos2, ":var20"),
        (position_set_y, pos2, ":var21"),
        (overlay_set_position, reg0, pos1),
        (overlay_set_position, reg1, pos2),
        (position_set_x, pos1, 1000),
        (position_set_y, pos1, 1000),
        (position_set_x, pos2, 600),
        (position_set_y, pos2, 600),
        (overlay_set_size, reg0, pos1),
        (overlay_set_size, reg1, pos2),
        (458, ":var22", 0),
        (458, ":var23", 1),
        (try_begin),
          (eq, ":var22", ":var23"),
          (eq, ":var12", 1),
          (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_7"),
        (else_try),
          (eq, ":var16", "fac_kingdom_4"),
          (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_1"),
        (else_try),
          (eq, ":var16", "fac_kingdom_2"),
          (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_2"),
        (else_try),
          (eq, ":var16", "fac_kingdom_3"),
          (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_3"),
        (else_try),
          (eq, ":var16", "fac_kingdom_5"),
          (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_4"),
        (else_try),
          (eq, ":var16", "fac_kingdom_1"),
          (create_mesh_overlay, reg0, "mesh_ui_kingdom_shield_6"),
        (try_end),
        (position_set_x, pos1, 100),
        (position_set_y, pos1, 100),
        (overlay_set_position, reg0, pos3),
        (position_set_x, pos1, 50),
        (position_set_y, pos1, 50),
        (overlay_set_size, reg0, pos1),
        (455, reg0, ":var12"),
        (create_text_overlay, reg0, "str_score_reg0", 8),
        (overlay_set_color, reg0, 16777215),
        (store_add, ":var24", ":var18", 325),
        (store_add, ":var25", ":var15", 0),
        (position_set_x, pos1, ":var24"),
        (position_set_y, pos1, ":var25"),
        (overlay_set_position, reg0, pos1),
        (position_set_x, pos1, 1200),
        (position_set_y, pos1, 1200),
        (overlay_set_size, reg0, pos1),
        (try_begin),
          (eq, "$g_multiplayer_game_type", 5),
          (try_begin),
            (eq, ":var12", 0),
            (assign, reg0, ":var10"),
          (else_try),
            (eq, ":var12", 1),
            (assign, reg0, ":var11"),
          (try_end),
          (create_text_overlay, reg0, "str_flags_reg0", 0),
          (overlay_set_color, reg0, 16777215),
          (store_add, ":var24", ":var18", 258),
          (store_add, ":var25", ":var15", -10),
          (position_set_x, pos1, ":var24"),
          (position_set_y, pos1, ":var25"),
          (overlay_set_position, reg0, pos1),
          (position_set_x, pos1, 600),
          (position_set_y, pos1, 600),
          (overlay_set_size, reg0, pos1),
        (try_end),
        (val_sub, ":var15", 60),
        (create_text_overlay, reg0, "str_player_name", 0),
        (overlay_set_color, reg0, 16777215),
        (position_set_x, pos1, ":var18"),
        (position_set_y, pos1, ":var15"),
        (overlay_set_position, reg0, pos1),
        (position_set_x, pos1, 750),
        (position_set_y, pos1, 750),
        (overlay_set_size, reg0, pos1),
        (try_begin),
          (this_or_next|eq, "$g_multiplayer_game_type", 4),
          (eq, "$g_multiplayer_game_type", 5),
          (create_text_overlay, reg0, "str_score", 0),
          (overlay_set_color, reg0, 16777215),
          (store_add, ":var24", ":var18", 138),
          (position_set_x, pos1, ":var24"),
          (position_set_y, pos1, ":var15"),
          (overlay_set_position, reg0, pos1),
          (position_set_x, pos1, 750),
          (position_set_y, pos1, 750),
          (overlay_set_size, reg0, pos1),
        (try_end),
        (create_text_overlay, reg0, "str_kills", 16),
        (overlay_set_color, reg0, 16777215),
        (store_add, ":var24", ":var18", 206),
        (position_set_x, pos1, ":var24"),
        (position_set_y, pos1, ":var15"),
        (overlay_set_position, reg0, pos1),
        (position_set_x, pos1, 750),
        (position_set_y, pos1, 750),
        (overlay_set_size, reg0, pos1),
        (create_text_overlay, reg0, "str_deaths", 16),
        (overlay_set_color, reg0, 16777215),
        (store_add, ":var24", ":var18", 260),
        (position_set_x, pos1, ":var24"),
        (position_set_y, pos1, ":var15"),
        (overlay_set_position, reg0, pos1),
        (position_set_x, pos1, 750),
        (position_set_y, pos1, 750),
        (overlay_set_size, reg0, pos1),
        (create_text_overlay, reg0, "str_ping", 16),
        (overlay_set_color, reg0, 16777215),
        (store_add, ":var24", ":var18", 308),
        (position_set_x, pos1, ":var24"),
        (position_set_y, pos1, ":var15"),
        (overlay_set_position, reg0, pos1),
        (position_set_x, pos1, 750),
        (position_set_y, pos1, 750),
        (overlay_set_size, reg0, pos1),
        (create_mesh_overlay, reg0, "mesh_white_plane"),
        (overlay_set_color, reg0, 16777215),
        (overlay_set_alpha, reg0, 0xD0),
        (store_add, ":var24", ":var18", 0),
        (position_set_x, pos1, ":var24"),
        (store_add, ":var25", ":var15", -10),
        (position_set_y, pos1, ":var25"),
        (overlay_set_position, reg0, pos1),
        (position_set_x, pos1, 16500),
        (position_set_y, pos1, 50),
        (overlay_set_size, reg0, pos1),
        (val_sub, ":var15", 35),
        (store_add, ":var26", ":var3", 1),
        (try_for_range, ":var27", 0, ":var26"),
          (assign, ":var28", -30030),
          (assign, ":var29", -1),
          (try_for_range, ":var4", 0, ":var3"),
            (store_add, ":var5", ":var4", 186),
            (troop_slot_eq, "trp_multiplayer_data", ":var5", 1),
            (402, ":var6", ":var4"),
            (eq, ":var6", ":var12"),
            (try_begin),
              (this_or_next|eq, "$g_multiplayer_game_type", 4),
              (eq, "$g_multiplayer_game_type", 5),
              (431, ":var30", ":var4"),
            (else_try),
              (433, ":var30", ":var4"),
            (try_end),
            (435, ":var31", ":var4"),
            (store_mul, ":var32", ":var30", 1000),
            (val_sub, ":var32", ":var31"),
            (this_or_next|gt, ":var32", ":var28"),
            (eq, ":var32", -30030),
            (assign, ":var28", ":var32"),
            (assign, ":var29", ":var4"),
          (try_end),
          (try_begin),
            (ge, ":var29", 0),
            (store_add, ":var5", ":var29", 186),
            (troop_set_slot, "trp_multiplayer_data", ":var5", 0),
            (try_begin),
              (eq, ":var9", ":var29"),
              (create_mesh_overlay, reg0, "mesh_white_plane"),
              (overlay_set_color, reg0, 16777215),
              (overlay_set_alpha, reg0, 0x35),
              (store_add, ":var24", ":var18", 0),
              (position_set_x, pos1, ":var24"),
              (store_add, ":var25", ":var15", 0),
              (position_set_y, pos1, ":var25"),
              (overlay_set_position, reg0, pos1),
              (position_set_x, pos1, 16500),
              (position_set_y, pos1, 1000),
              (overlay_set_size, reg0, pos1),
            (try_end),
            (try_begin),
              (this_or_next|eq, "$g_multiplayer_game_type", 4),
              (eq, "$g_multiplayer_game_type", 5),
              (assign, ":var33", 16777215),
              (406, ":var34", ":var29"),
              (try_begin),
                (this_or_next|lt, ":var34", 0),
                (neg|agent_is_alive, ":var34"),
                (assign, ":var33", 16711680),
              (try_end),
              (431, reg0, ":var29"),
              (create_text_overlay, reg0, "str_reg0", 8),
              (overlay_set_color, reg0, ":var33"),
              (position_set_x, pos1, 750),
              (position_set_y, pos1, 750),
              (overlay_set_size, reg0, pos1),
              (store_add, ":var24", ":var18", 165),
              (position_set_x, pos1, ":var24"),
              (position_set_y, pos1, ":var15"),
              (overlay_set_position, reg0, pos1),
            (else_try),
              (assign, ":var33", 16777215),
              (406, ":var34", ":var29"),
              (try_begin),
                (this_or_next|lt, ":var34", 0),
                (neg|agent_is_alive, ":var34"),
                (assign, ":var33", 16711680),
                (create_text_overlay, reg0, "str_dead", 0),
                (overlay_set_color, reg0, ":var33"),
                (position_set_x, pos1, 750),
                (position_set_y, pos1, 750),
                (overlay_set_size, reg0, pos1),
                (store_add, ":var24", ":var18", 130),
                (position_set_x, pos1, ":var24"),
                (position_set_y, pos1, ":var15"),
                (overlay_set_position, reg0, pos1),
              (try_end),
            (try_end),
            (2350, 1, ":var29"),
            (create_text_overlay, reg0, s1, 0),
            (overlay_set_color, reg0, ":var33"),
            (position_set_x, pos1, 750),
            (position_set_y, pos1, 750),
            (overlay_set_size, reg0, pos1),
            (position_set_x, pos1, ":var18"),
            (position_set_y, pos1, ":var15"),
            (overlay_set_position, reg0, pos1),
            (433, reg0, ":var29"),
            (create_text_overlay, reg0, "str_reg0", 8),
            (overlay_set_color, reg0, ":var33"),
            (position_set_x, pos1, 750),
            (position_set_y, pos1, 750),
            (overlay_set_size, reg0, pos1),
            (store_add, ":var24", ":var18", 215),
            (position_set_x, pos1, ":var24"),
            (position_set_y, pos1, ":var15"),
            (overlay_set_position, reg0, pos1),
            (435, reg0, ":var29"),
            (create_text_overlay, reg0, "str_reg0", 8),
            (overlay_set_color, reg0, ":var33"),
            (position_set_x, pos1, 750),
            (position_set_y, pos1, 750),
            (overlay_set_size, reg0, pos1),
            (store_add, ":var24", ":var18", 265),
            (position_set_x, pos1, ":var24"),
            (position_set_y, pos1, ":var15"),
            (overlay_set_position, reg0, pos1),
            (437, reg0, ":var29"),
            (create_text_overlay, reg0, "str_reg0", 8),
            (overlay_set_color, reg0, ":var33"),
            (position_set_x, pos1, 750),
            (position_set_y, pos1, 750),
            (overlay_set_size, reg0, pos1),
            (store_add, ":var24", ":var18", 315),
            (position_set_x, pos1, ":var24"),
            (position_set_y, pos1, ":var15"),
            (overlay_set_position, reg0, pos1),
            (val_sub, ":var15", 20),
          (else_try),
            (try_begin),
              (try_begin),
                (eq, ":var12", 0),
                (assign, ":var35", "$g_multiplayer_num_bots_team_1"),
              (else_try),
                (assign, ":var35", "$g_multiplayer_num_bots_team_2"),
              (try_end),
              (450, reg0, ":var12"),
              (452, reg1, ":var12"),
              (try_begin),
                (this_or_next|neq, reg0, 0),
                (this_or_next|neq, reg1, 0),
                (neq, ":var35", 0),
                (assign, ":var36", 1),
              (else_try),
                (assign, ":var36", 0),
              (try_end),
              (eq, ":var36", 1),
              (assign, ":var37", 0),
              (try_for_agents, ":var38"),
                (1707, ":var38"),
                (agent_is_alive, ":var38"),
                (agent_get_team, ":var39", ":var38"),
                (eq, ":var39", ":var12"),
                (val_add, ":var37", 1),
              (try_end),
              (store_sub, ":var40", ":var35", ":var37"),
              (try_begin),
                (eq, ":var37", 0),
                (assign, ":var33", 16711680),
              (else_try),
                (assign, ":var33", 13684944),
              (try_end),
              (try_begin),
                (gt, ":var40", 0),
                (try_begin),
                  (eq, ":var35", 1),
                  (create_text_overlay, reg0, "str_dead", 0),
                  (store_add, ":var24", ":var18", 130),
                (else_try),
                  (assign, reg0, ":var40"),
                  (create_text_overlay, reg0, "str_reg0_dead", 0),
                  (store_add, ":var24", ":var18", 123),
                (try_end),
                (overlay_set_color, reg0, ":var33"),
                (position_set_x, pos1, 750),
                (position_set_y, pos1, 750),
                (overlay_set_size, reg0, pos1),
                (position_set_x, pos1, ":var24"),
                (position_set_y, pos1, ":var15"),
                (overlay_set_position, reg0, pos1),
              (try_end),
              (try_begin),
                (gt, ":var35", 1),
                (assign, reg0, ":var35"),
                (create_text_overlay, reg0, "str_bots_reg0_agents", 0),
              (else_try),
                (create_text_overlay, reg0, "str_bot_1_agent", 0),
              (try_end),
              (overlay_set_color, reg0, ":var33"),
              (position_set_x, pos1, 750),
              (position_set_y, pos1, 750),
              (overlay_set_size, reg0, pos1),
              (position_set_x, pos1, ":var18"),
              (position_set_y, pos1, ":var15"),
              (overlay_set_position, reg0, pos1),
              (450, reg0, ":var12"),
              (create_text_overlay, reg0, "str_reg0", 8),
              (overlay_set_color, reg0, ":var33"),
              (position_set_x, pos1, 750),
              (position_set_y, pos1, 750),
              (overlay_set_size, reg0, pos1),
              (store_add, ":var24", ":var18", 215),
              (position_set_x, pos1, ":var24"),
              (position_set_y, pos1, ":var15"),
              (overlay_set_position, reg0, pos1),
              (452, reg0, ":var12"),
              (create_text_overlay, reg0, "str_reg0", 8),
              (overlay_set_color, reg0, ":var33"),
              (position_set_x, pos1, 750),
              (position_set_y, pos1, 750),
              (overlay_set_size, reg0, pos1),
              (store_add, ":var24", ":var18", 265),
              (position_set_x, pos1, ":var24"),
              (position_set_y, pos1, ":var15"),
              (overlay_set_position, reg0, pos1),
              (val_sub, ":var15", 20),
            (try_end),
            (assign, ":var26", 0),
          (try_end),
        (try_end),
        (try_begin),
          (eq, ":var12", 0),
          (assign, ":var41", ":var15"),
        (try_end),
      (try_end),
      (try_begin),
        (le, ":var41", ":var15"),
        (assign, ":var15", ":var41"),
      (try_end),
      (assign, ":var18", 42),
      (create_mesh_overlay, reg0, "mesh_white_plane"),
      (overlay_set_color, reg0, 16777215),
      (overlay_set_alpha, reg0, 0xD0),
      (store_add, ":var24", ":var18", 0),
      (position_set_x, pos1, ":var24"),
      (store_add, ":var25", ":var15", 10),
      (position_set_y, pos1, ":var25"),
      (overlay_set_position, reg0, pos1),
      (position_set_x, pos1, 36000),
      (position_set_y, pos1, 50),
      (overlay_set_size, reg0, pos1),
      (try_begin),
        (gt, ":var2", 0),
        (assign, ":var18", 280),
        (val_sub, ":var15", 50),
        (create_text_overlay, reg0, "str_spectators", 0),
        (overlay_set_color, reg0, 16777215),
        (position_set_x, pos1, ":var18"),
        (position_set_y, pos1, ":var15"),
        (overlay_set_position, reg0, pos1),
        (position_set_x, pos1, 1000),
        (position_set_y, pos1, 1000),
        (overlay_set_size, reg0, pos1),
        (create_text_overlay, reg0, "str_ping", 8),
        (overlay_set_color, reg0, 16777215),
        (store_add, ":var24", ":var18", 215),
        (position_set_x, pos1, ":var24"),
        (position_set_y, pos1, ":var15"),
        (overlay_set_position, reg0, pos1),
        (position_set_x, pos1, 750),
        (position_set_y, pos1, 750),
        (overlay_set_size, reg0, pos1),
        (create_mesh_overlay, reg0, "mesh_white_plane"),
        (overlay_set_color, reg0, 16777215),
        (overlay_set_alpha, reg0, 0xD0),
        (store_add, ":var24", ":var18", 0),
        (position_set_x, pos1, ":var24"),
        (store_add, ":var25", ":var15", -10),
        (position_set_y, pos1, ":var25"),
        (overlay_set_position, reg0, pos1),
        (position_set_x, pos1, 12000),
        (position_set_y, pos1, 50),
        (overlay_set_size, reg0, pos1),
        (val_sub, ":var15", 30),
        (assign, ":var33", 12632256),
        (store_add, ":var26", ":var3", 1),
        (try_for_range, ":var4", 0, ":var26"),
          (store_add, ":var5", ":var4", 186),
          (troop_slot_eq, "trp_multiplayer_data", ":var5", 1),
          (402, ":var6", ":var4"),
          (eq, ":var6", 2),
          (troop_set_slot, "trp_multiplayer_data", ":var5", 1),
          (try_begin),
            (eq, ":var9", ":var4"),
            (create_mesh_overlay, reg0, "mesh_white_plane"),
            (overlay_set_color, reg0, 16777215),
            (overlay_set_alpha, reg0, 0x35),
            (store_add, ":var24", ":var18", 0),
            (position_set_x, pos1, ":var24"),
            (store_add, ":var25", ":var15", 0),
            (position_set_y, pos1, ":var25"),
            (overlay_set_position, reg0, pos1),
            (position_set_x, pos1, 12000),
            (position_set_y, pos1, 1000),
            (overlay_set_size, reg0, pos1),
          (try_end),
          (2350, 1, ":var4"),
          (create_text_overlay, reg0, s1, 0),
          (overlay_set_color, reg0, ":var33"),
          (position_set_x, pos1, 750),
          (position_set_y, pos1, 750),
          (overlay_set_size, reg0, pos1),
          (position_set_x, pos1, ":var18"),
          (position_set_y, pos1, ":var15"),
          (overlay_set_position, reg0, pos1),
          (437, reg0, ":var4"),
          (create_text_overlay, reg0, "str_reg0", 8),
          (overlay_set_color, reg0, ":var33"),
          (position_set_x, pos1, 750),
          (position_set_y, pos1, 750),
          (overlay_set_size, reg0, pos1),
          (store_add, ":var24", ":var18", 215),
          (position_set_x, pos1, ":var24"),
          (position_set_y, pos1, ":var15"),
          (overlay_set_position, reg0, pos1),
          (val_sub, ":var15", 20),
        (try_end),
      (try_end),
      (77, 238),
      (77, 239),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_run,
    [
      (store_trigger_param_1, ":var0"),
      (try_begin),
        (this_or_next|key_clicked, key_mouse_scroll_up),
        (key_clicked, key_mouse_scroll_down),
        (77, 238),
        (77, 239),
      (try_end),
      (try_begin),
        (eq, "$g_multiplayer_stats_chart_opened_manually", 1),
        (neg|game_key_is_down, 18),
        (assign, "$g_multiplayer_stats_chart_opened_manually", 0),
        (78),
        (presentation_set_duration, 0),
      (try_end),
      (try_begin),
        (store_mul, ":var1", "$g_stats_chart_update_period", 1000),
        (gt, ":var0", ":var1"),
        (78),
        (presentation_set_duration, 0),
        (start_presentation, "prsnt_multiplayer_stats_chart"),
      (try_end),
    ]),
  ]),

  ("multiplayer_stats_chart_deathmatch", prsntf_read_only|prsntf_manual_end_only, mesh_null,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (create_mesh_overlay, reg0, "mesh_mp_score_a"),
      (position_set_x, pos1, 295),
      (position_set_y, pos1, 115),
      (overlay_set_position, reg0, pos1),
      (position_set_x, pos1, 1000),
      (position_set_y, pos1, 1000),
      (overlay_set_size, reg0, pos1),
      (assign, ":var0", 0),
      (assign, ":var1", 0),
      (400, ":var2"),
      (try_for_range, ":var3", 0, ":var2"),
        (store_add, ":var4", ":var3", 186),
        (try_begin),
          (401, ":var3"),
          (troop_set_slot, "trp_multiplayer_data", ":var4", 1),
          (402, ":var5", ":var3"),
          (try_begin),
            (this_or_next|eq, ":var5", 0),
            (eq, ":var5", 1),
            (val_add, ":var0", 1),
          (else_try),
            (eq, ":var5", 2),
            (val_add, ":var1", 1),
          (try_end),
        (else_try),
          (troop_set_slot, "trp_multiplayer_data", ":var4", 0),
        (try_end),
      (try_end),
      (try_begin),
        (this_or_next|gt, "$g_multiplayer_num_bots_team_1", 0),
        (gt, "$g_multiplayer_num_bots_team_2", 0),
        (val_add, ":var0", 1),
      (try_end),
      (store_add, ":var6", ":var0", ":var1"),
      (str_clear, s0),
      (create_text_overlay, "$g_presentation_obj_stats_chart_deathmatch_container", s0, 131072),
      (position_set_x, pos1, 300),
      (position_set_y, pos1, 140),
      (overlay_set_position, "$g_presentation_obj_stats_chart_deathmatch_container", pos1),
      (position_set_x, pos1, 346),
      (position_set_y, pos1, 530),
      (overlay_set_area_size, "$g_presentation_obj_stats_chart_deathmatch_container", pos1),
      (945, "$g_presentation_obj_stats_chart_deathmatch_container"),
      (store_mul, ":var7", ":var6", 20),
      (val_add, ":var7", 80),
      (try_begin),
        (gt, ":var1", 0),
        (val_add, ":var7", 70),
      (try_end),
      (try_begin),
        (ge, ":var6", 17),
        (assign, "$g_stats_chart_update_period", 10),
      (else_try),
        (assign, "$g_stats_chart_update_period", 1),
      (try_end),
      (415, ":var8"),
      (assign, ":var9", ":var7"),
      (assign, ":var10", 42),
      (create_text_overlay, reg0, "str_player_name", 0),
      (overlay_set_color, reg0, 16777215),
      (position_set_x, pos1, ":var10"),
      (position_set_y, pos1, ":var9"),
      (overlay_set_position, reg0, pos1),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg0, pos1),
      (create_text_overlay, reg0, "str_kills", 16),
      (overlay_set_color, reg0, 16777215),
      (store_add, ":var11", ":var10", 179),
      (position_set_x, pos1, ":var11"),
      (position_set_y, pos1, ":var9"),
      (overlay_set_position, reg0, pos1),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg0, pos1),
      (create_text_overlay, reg0, "str_deaths", 16),
      (overlay_set_color, reg0, 16777215),
      (store_add, ":var11", ":var10", 233),
      (position_set_x, pos1, ":var11"),
      (position_set_y, pos1, ":var9"),
      (overlay_set_position, reg0, pos1),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg0, pos1),
      (create_text_overlay, reg0, "str_ping", 16),
      (overlay_set_color, reg0, 16777215),
      (store_add, ":var11", ":var10", 282),
      (position_set_x, pos1, ":var11"),
      (position_set_y, pos1, ":var9"),
      (overlay_set_position, reg0, pos1),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg0, pos1),
      (create_mesh_overlay, reg0, "mesh_white_plane"),
      (overlay_set_color, reg0, 16777215),
      (overlay_set_alpha, reg0, 0xD0),
      (store_add, ":var11", ":var10", 0),
      (position_set_x, pos1, ":var11"),
      (store_add, ":var12", ":var9", -10),
      (position_set_y, pos1, ":var12"),
      (overlay_set_position, reg0, pos1),
      (position_set_x, pos1, 15250),
      (position_set_y, pos1, 50),
      (overlay_set_size, reg0, pos1),
      (val_sub, ":var9", 35),
      (store_add, ":var13", ":var2", 1),
      (try_for_range, ":var14", 0, ":var13"),
        (assign, ":var15", -30030),
        (assign, ":var16", -1),
        (try_for_range, ":var3", 0, ":var2"),
          (store_add, ":var4", ":var3", 186),
          (troop_slot_eq, "trp_multiplayer_data", ":var4", 1),
          (402, ":var5", ":var3"),
          (this_or_next|eq, ":var5", 0),
          (eq, ":var5", 1),
          (433, ":var17", ":var3"),
          (435, ":var18", ":var3"),
          (store_mul, ":var19", ":var17", 1000),
          (val_sub, ":var19", ":var18"),
          (this_or_next|gt, ":var19", ":var15"),
          (eq, ":var19", -30030),
          (assign, ":var15", ":var19"),
          (assign, ":var16", ":var3"),
        (try_end),
        (try_begin),
          (ge, ":var16", 0),
          (store_add, ":var4", ":var16", 186),
          (troop_set_slot, "trp_multiplayer_data", ":var4", 0),
          (2350, 1, ":var16"),
          (try_begin),
            (eq, ":var8", ":var16"),
            (create_mesh_overlay, reg0, "mesh_white_plane"),
            (overlay_set_color, reg0, 16777215),
            (overlay_set_alpha, reg0, 0x35),
            (store_add, ":var11", ":var10", 0),
            (position_set_x, pos1, ":var11"),
            (store_add, ":var12", ":var9", 0),
            (position_set_y, pos1, ":var12"),
            (overlay_set_position, reg0, pos1),
            (position_set_x, pos1, 16000),
            (position_set_y, pos1, 1000),
            (overlay_set_size, reg0, pos1),
          (try_end),
          (create_text_overlay, reg0, s1, 0),
          (overlay_set_color, reg0, 16777215),
          (position_set_x, pos1, 750),
          (position_set_y, pos1, 750),
          (overlay_set_size, reg0, pos1),
          (position_set_x, pos1, ":var10"),
          (position_set_y, pos1, ":var9"),
          (overlay_set_position, reg0, pos1),
          (433, reg0, ":var16"),
          (create_text_overlay, reg0, "str_reg0", 8),
          (overlay_set_color, reg0, 16777215),
          (position_set_x, pos1, 750),
          (position_set_y, pos1, 750),
          (overlay_set_size, reg0, pos1),
          (store_add, ":var11", ":var10", 188),
          (position_set_x, pos1, ":var11"),
          (position_set_y, pos1, ":var9"),
          (overlay_set_position, reg0, pos1),
          (435, reg0, ":var16"),
          (create_text_overlay, reg0, "str_reg0", 8),
          (overlay_set_color, reg0, 16777215),
          (position_set_x, pos1, 750),
          (position_set_y, pos1, 750),
          (overlay_set_size, reg0, pos1),
          (store_add, ":var11", ":var10", 238),
          (position_set_x, pos1, ":var11"),
          (position_set_y, pos1, ":var9"),
          (overlay_set_position, reg0, pos1),
          (437, reg0, ":var16"),
          (create_text_overlay, reg0, "str_reg0", 8),
          (overlay_set_color, reg0, 16777215),
          (position_set_x, pos1, 750),
          (position_set_y, pos1, 750),
          (overlay_set_size, reg0, pos1),
          (store_add, ":var11", ":var10", 288),
          (position_set_x, pos1, ":var11"),
          (position_set_y, pos1, ":var9"),
          (overlay_set_position, reg0, pos1),
          (val_sub, ":var9", 20),
        (else_try),
          (store_add, ":var20", "$g_multiplayer_num_bots_team_1", "$g_multiplayer_num_bots_team_2"),
          (ge, ":var20", 1),
          (try_begin),
            (gt, ":var20", 1),
            (assign, reg0, ":var20"),
            (create_text_overlay, reg0, "str_bots_reg0_agents", 0),
          (else_try),
            (create_text_overlay, reg0, "str_bot_1_agent", 0),
          (try_end),
          (overlay_set_color, reg0, 13684944),
          (position_set_x, pos1, 750),
          (position_set_y, pos1, 750),
          (overlay_set_size, reg0, pos1),
          (position_set_x, pos1, ":var10"),
          (position_set_y, pos1, ":var9"),
          (overlay_set_position, reg0, pos1),
          (450, reg0, 0),
          (assign, ":var21", reg0),
          (450, reg0, 1),
          (val_add, ":var21", reg0),
          (assign, reg0, ":var21"),
          (create_text_overlay, reg0, "str_reg0", 8),
          (overlay_set_color, reg0, 13684944),
          (position_set_x, pos1, 750),
          (position_set_y, pos1, 750),
          (overlay_set_size, reg0, pos1),
          (store_add, ":var11", ":var10", 188),
          (position_set_x, pos1, ":var11"),
          (position_set_y, pos1, ":var9"),
          (overlay_set_position, reg0, pos1),
          (452, reg0, 0),
          (assign, ":var22", reg0),
          (452, reg0, 1),
          (val_add, ":var22", reg0),
          (assign, reg0, ":var22"),
          (create_text_overlay, reg0, "str_reg0", 8),
          (overlay_set_color, reg0, 13684944),
          (position_set_x, pos1, 750),
          (position_set_y, pos1, 750),
          (overlay_set_size, reg0, pos1),
          (store_add, ":var11", ":var10", 238),
          (position_set_x, pos1, ":var11"),
          (position_set_y, pos1, ":var9"),
          (overlay_set_position, reg0, pos1),
          (val_sub, ":var9", 20),
          (assign, ":var13", 0),
        (else_try),
          (assign, ":var13", 0),
        (try_end),
      (try_end),
      (assign, ":var10", 42),
      (create_mesh_overlay, reg0, "mesh_white_plane"),
      (overlay_set_color, reg0, 16777215),
      (overlay_set_alpha, reg0, 0xD0),
      (store_add, ":var11", ":var10", 0),
      (position_set_x, pos1, ":var11"),
      (store_add, ":var12", ":var9", 10),
      (position_set_y, pos1, ":var12"),
      (overlay_set_position, reg0, pos1),
      (position_set_x, pos1, 15250),
      (position_set_y, pos1, 50),
      (overlay_set_size, reg0, pos1),
      (try_begin),
        (gt, ":var1", 0),
        (assign, ":var10", 75),
        (val_sub, ":var9", 50),
        (create_text_overlay, reg0, "str_spectators", 0),
        (overlay_set_color, reg0, 16777215),
        (position_set_x, pos1, ":var10"),
        (position_set_y, pos1, ":var9"),
        (overlay_set_position, reg0, pos1),
        (position_set_x, pos1, 1000),
        (position_set_y, pos1, 1000),
        (overlay_set_size, reg0, pos1),
        (create_text_overlay, reg0, "str_ping", 16),
        (overlay_set_color, reg0, 16777215),
        (store_add, ":var11", ":var10", 218),
        (position_set_x, pos1, ":var11"),
        (position_set_y, pos1, ":var9"),
        (overlay_set_position, reg0, pos1),
        (position_set_x, pos1, 750),
        (position_set_y, pos1, 750),
        (overlay_set_size, reg0, pos1),
        (create_mesh_overlay, reg0, "mesh_white_plane"),
        (overlay_set_color, reg0, 16777215),
        (overlay_set_alpha, reg0, 0xD0),
        (store_add, ":var11", ":var10", 0),
        (position_set_x, pos1, ":var11"),
        (store_add, ":var12", ":var9", -10),
        (position_set_y, pos1, ":var12"),
        (overlay_set_position, reg0, pos1),
        (position_set_x, pos1, 12000),
        (position_set_y, pos1, 50),
        (overlay_set_size, reg0, pos1),
        (val_sub, ":var9", 30),
        (assign, ":var23", 12632256),
        (store_add, ":var13", ":var2", 1),
        (try_for_range, ":var3", 0, ":var13"),
          (store_add, ":var4", ":var3", 186),
          (troop_slot_eq, "trp_multiplayer_data", ":var4", 1),
          (402, ":var5", ":var3"),
          (eq, ":var5", 2),
          (troop_set_slot, "trp_multiplayer_data", ":var4", 1),
          (try_begin),
            (eq, ":var8", ":var3"),
            (create_mesh_overlay, reg0, "mesh_white_plane"),
            (overlay_set_color, reg0, 16777215),
            (overlay_set_alpha, reg0, 0x35),
            (store_add, ":var11", ":var10", 0),
            (position_set_x, pos1, ":var11"),
            (store_add, ":var12", ":var9", 0),
            (position_set_y, pos1, ":var12"),
            (overlay_set_position, reg0, pos1),
            (position_set_x, pos1, 12000),
            (position_set_y, pos1, 1000),
            (overlay_set_size, reg0, pos1),
          (try_end),
          (2350, 1, ":var3"),
          (create_text_overlay, reg0, s1, 0),
          (overlay_set_color, reg0, ":var23"),
          (position_set_x, pos1, 750),
          (position_set_y, pos1, 750),
          (overlay_set_size, reg0, pos1),
          (position_set_x, pos1, ":var10"),
          (position_set_y, pos1, ":var9"),
          (overlay_set_position, reg0, pos1),
          (437, reg0, ":var3"),
          (create_text_overlay, reg0, "str_reg0", 8),
          (overlay_set_color, reg0, ":var23"),
          (position_set_x, pos1, 750),
          (position_set_y, pos1, 750),
          (overlay_set_size, reg0, pos1),
          (store_add, ":var11", ":var10", 215),
          (position_set_x, pos1, ":var11"),
          (position_set_y, pos1, ":var9"),
          (overlay_set_position, reg0, pos1),
          (val_sub, ":var9", 20),
        (try_end),
      (try_end),
      (77, 238),
      (77, 239),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_run,
    [
      (store_trigger_param_1, ":var0"),
      (try_begin),
        (this_or_next|key_clicked, key_mouse_scroll_up),
        (key_clicked, key_mouse_scroll_down),
        (77, 238),
        (77, 239),
      (try_end),
      (try_begin),
        (eq, "$g_multiplayer_stats_chart_opened_manually", 1),
        (neg|game_key_is_down, 18),
        (assign, "$g_multiplayer_stats_chart_opened_manually", 0),
        (78),
        (presentation_set_duration, 0),
      (try_end),
      (try_begin),
        (store_mul, ":var1", "$g_stats_chart_update_period", 1000),
        (gt, ":var0", ":var1"),
        (78),
        (presentation_set_duration, 0),
        (start_presentation, "prsnt_multiplayer_stats_chart_deathmatch"),
      (try_end),
    ]),
  ]),

  ("multiplayer_escape_menu", prsntf_manual_end_only, mesh_null,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (create_mesh_overlay, reg0, "mesh_mp_ingame_menu"),
      (position_set_x, pos1, 250),
      (position_set_y, pos1, 80),
      (overlay_set_position, reg0, pos1),
      (position_set_x, pos1, 1000),
      (position_set_y, pos1, 1000),
      (overlay_set_size, reg0, pos1),
      (str_clear, s0),
      (create_text_overlay, "$g_presentation_obj_escape_menu_container", s0, 131072),
      (position_set_x, pos1, 285),
      (position_set_y, pos1, 75),
      (overlay_set_position, "$g_presentation_obj_escape_menu_container", pos1),
      (position_set_x, pos1, 405),
      (position_set_y, pos1, 550),
      (overlay_set_area_size, "$g_presentation_obj_escape_menu_container", pos1),
      (945, "$g_presentation_obj_escape_menu_container"),
      (assign, ":var0", 500),
      (create_text_overlay, reg0, "str_choose_an_option", 0),
      (overlay_set_color, reg0, 16777215),
      (position_set_x, pos1, 0),
      (position_set_y, pos1, ":var0"),
      (overlay_set_position, reg0, pos1),
      (val_sub, ":var0", 40),
      (create_button_overlay, "$g_presentation_obj_escape_menu_1", "str_choose_faction", 0),
      (overlay_set_color, "$g_presentation_obj_escape_menu_1", 16777215),
      (411, ":var1"),
      (assign, "$g_presentation_obj_escape_menu_2", -1),
      (assign, "$g_presentation_obj_escape_menu_3", -1),
      (assign, "$g_presentation_obj_escape_menu_6", -1),
      (assign, "$g_presentation_obj_escape_menu_7", -1),
      (assign, "$g_presentation_obj_escape_menu_8", -1),
      (assign, "$g_presentation_obj_escape_menu_9", -1),
      (assign, "$g_presentation_obj_escape_menu_10", -1),
      (assign, "$g_presentation_obj_escape_menu_11", -1),
      (assign, "$g_presentation_obj_escape_menu_12", -1),
      (assign, "$g_presentation_obj_escape_menu_13", -1),
      (try_begin),
        (lt, ":var1", 2),
        (create_button_overlay, "$g_presentation_obj_escape_menu_2", "str_choose_troop", 0),
        (overlay_set_color, "$g_presentation_obj_escape_menu_2", 16777215),
        (412, ":var2"),
        (try_begin),
          (ge, ":var2", 0),
          (create_button_overlay, "$g_presentation_obj_escape_menu_3", "str_choose_items", 0),
          (overlay_set_color, "$g_presentation_obj_escape_menu_3", 16777215),
        (try_end),
      (try_end),
      (create_button_overlay, "$g_presentation_obj_escape_menu_4", "str_options", 0),
      (overlay_set_color, "$g_presentation_obj_escape_menu_4", 16777215),
      (create_button_overlay, "$g_presentation_obj_escape_menu_5", "str_redefine_keys", 0),
      (overlay_set_color, "$g_presentation_obj_escape_menu_5", 16777215),
      (create_button_overlay, "$g_presentation_obj_escape_menu_13", "@Show game rules", 0),
      (overlay_set_color, "$g_presentation_obj_escape_menu_13", 16777215),
      (415, ":var3"),
      (try_begin),
        (this_or_next|eq, "$g_multiplayer_maps_voteable", 1),
        (this_or_next|eq, "$g_multiplayer_factions_voteable", 1),
        (this_or_next|gt, "$g_multiplayer_num_bots_voteable", 0),
        (this_or_next|eq, "$g_multiplayer_kick_voteable", 1),
        (eq, "$g_multiplayer_ban_voteable", 1),
        (create_button_overlay, "$g_presentation_obj_escape_menu_6", "str_submit_a_poll", 0),
        (overlay_set_color, "$g_presentation_obj_escape_menu_6", 16777215),
        (assign, "$g_presentation_obj_escape_menu_6_available", 1),
        (try_begin),
          (ge, ":var3", 0),
          (528, ":var4", ":var3", 26),
          (store_mission_timer_a, ":var5"),
          (lt, ":var5", ":var4"),
          (overlay_set_color, "$g_presentation_obj_escape_menu_6", 8947848),
          (overlay_set_hilight_color, "$g_presentation_obj_escape_menu_6", 8947848),
          (assign, "$g_presentation_obj_escape_menu_6_available", 0),
        (try_end),
      (try_end),
      (try_begin),
        (ge, ":var3", 0),
        (430, ":var3"),
        (create_button_overlay, "$g_presentation_obj_escape_menu_7", "str_administrator_panel", 0),
        (overlay_set_color, "$g_presentation_obj_escape_menu_7", 16777215),
        (create_button_overlay, "$g_presentation_obj_escape_menu_8", "str_kick_player", 0),
        (overlay_set_color, "$g_presentation_obj_escape_menu_8", 16777215),
        (create_button_overlay, "$g_presentation_obj_escape_menu_9", "str_ban_player", 0),
        (overlay_set_color, "$g_presentation_obj_escape_menu_9", 16777215),
      (try_end),
      (create_button_overlay, "$g_presentation_obj_escape_menu_11", "str_mute_player", 0),
      (overlay_set_color, "$g_presentation_obj_escape_menu_11", 16777215),
      (try_begin),
        (assign, "$g_presentation_obj_escape_menu_12", -1),
        (assign, ":var6", 0),
        (400, ":var7"),
        (try_for_range, ":var8", 0, ":var7"),
          (401, ":var8"),
          (439, ":var9", ":var8"),
          (eq, ":var9", 1),
          (assign, ":var6", 1),
        (try_end),
        (eq, ":var6", 1),
        (create_button_overlay, "$g_presentation_obj_escape_menu_12", "str_unmute_player", 0),
        (overlay_set_color, "$g_presentation_obj_escape_menu_12", 16777215),
      (try_end),
      (create_button_overlay, "$g_presentation_obj_escape_menu_10", "str_quit", 0),
      (overlay_set_color, "$g_presentation_obj_escape_menu_10", 16777215),
      (position_set_x, pos1, 130),
      (position_set_y, pos1, ":var0"),
      (overlay_set_position, "$g_presentation_obj_escape_menu_1", pos1),
      (try_begin),
        (ge, "$g_presentation_obj_escape_menu_2", 0),
        (val_sub, ":var0", 40),
        (position_set_y, pos1, ":var0"),
        (overlay_set_position, "$g_presentation_obj_escape_menu_2", pos1),
      (try_end),
      (try_begin),
        (ge, "$g_presentation_obj_escape_menu_3", 0),
        (val_sub, ":var0", 40),
        (position_set_y, pos1, ":var0"),
        (overlay_set_position, "$g_presentation_obj_escape_menu_3", pos1),
      (try_end),
      (val_sub, ":var0", 40),
      (position_set_y, pos1, ":var0"),
      (overlay_set_position, "$g_presentation_obj_escape_menu_4", pos1),
      (val_sub, ":var0", 40),
      (position_set_y, pos1, ":var0"),
      (overlay_set_position, "$g_presentation_obj_escape_menu_5", pos1),
      (val_sub, ":var0", 40),
      (position_set_y, pos1, ":var0"),
      (overlay_set_position, "$g_presentation_obj_escape_menu_13", pos1),
      (try_begin),
        (ge, "$g_presentation_obj_escape_menu_6", 0),
        (val_sub, ":var0", 40),
        (position_set_y, pos1, ":var0"),
        (overlay_set_position, "$g_presentation_obj_escape_menu_6", pos1),
      (try_end),
      (try_begin),
        (ge, "$g_presentation_obj_escape_menu_7", 0),
        (val_sub, ":var0", 40),
        (position_set_y, pos1, ":var0"),
        (overlay_set_position, "$g_presentation_obj_escape_menu_7", pos1),
      (try_end),
      (try_begin),
        (ge, "$g_presentation_obj_escape_menu_8", 0),
        (val_sub, ":var0", 40),
        (position_set_y, pos1, ":var0"),
        (overlay_set_position, "$g_presentation_obj_escape_menu_8", pos1),
      (try_end),
      (try_begin),
        (ge, "$g_presentation_obj_escape_menu_9", 0),
        (val_sub, ":var0", 40),
        (position_set_y, pos1, ":var0"),
        (overlay_set_position, "$g_presentation_obj_escape_menu_9", pos1),
      (try_end),
      (val_sub, ":var0", 40),
      (position_set_y, pos1, ":var0"),
      (overlay_set_position, "$g_presentation_obj_escape_menu_11", pos1),
      (try_begin),
        (ge, "$g_presentation_obj_escape_menu_12", 0),
        (val_sub, ":var0", 40),
        (position_set_y, pos1, ":var0"),
        (overlay_set_position, "$g_presentation_obj_escape_menu_12", pos1),
      (try_end),
      (val_sub, ":var0", 40),
      (position_set_y, pos1, ":var0"),
      (overlay_set_position, "$g_presentation_obj_escape_menu_10", pos1),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (try_begin),
        (eq, ":var0", "$g_presentation_obj_escape_menu_1"),
        (presentation_set_duration, 0),
        (start_presentation, "prsnt_multiplayer_team_select"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_escape_menu_2"),
        (presentation_set_duration, 0),
        (start_presentation, "prsnt_multiplayer_troop_select"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_escape_menu_3"),
        (presentation_set_duration, 0),
        (assign, "$g_presentation_state", 0),
        (start_presentation, "prsnt_multiplayer_item_select"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_escape_menu_4"),
        (presentation_set_duration, 0),
        (2058),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_escape_menu_5"),
        (presentation_set_duration, 0),
        (2057),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_escape_menu_6"),
        (eq, "$g_presentation_obj_escape_menu_6_available", 1),
        (presentation_set_duration, 0),
        (start_presentation, "prsnt_multiplayer_poll_menu"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_escape_menu_7"),
        (presentation_set_duration, 0),
        (388, 18),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_escape_menu_8"),
        (presentation_set_duration, 0),
        (assign, "$g_multiplayer_players_list_action_type", 3),
        (start_presentation, "prsnt_multiplayer_show_players_list"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_escape_menu_9"),
        (presentation_set_duration, 0),
        (assign, "$g_multiplayer_players_list_action_type", 4),
        (start_presentation, "prsnt_multiplayer_show_players_list"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_escape_menu_10"),
        (presentation_set_duration, 0),
        (finish_mission, 0),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_escape_menu_11"),
        (presentation_set_duration, 0),
        (assign, "$g_multiplayer_players_list_action_type", 5),
        (start_presentation, "prsnt_multiplayer_show_players_list"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_escape_menu_12"),
        (presentation_set_duration, 0),
        (assign, "$g_multiplayer_players_list_action_type", 6),
        (start_presentation, "prsnt_multiplayer_show_players_list"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_escape_menu_13"),
        (presentation_set_duration, 0),
        (388, 45),
      (try_end),
    ]),
    (ti_on_presentation_run,
    [
      (store_trigger_param_1, ":var0"),
      (try_begin),
        (key_clicked, key_escape),
        (gt, ":var0", 200),
        (presentation_set_duration, 0),
      (try_end),
    ]),
  ]),

  ("multiplayer_poll_menu", prsntf_manual_end_only, mesh_null,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (create_mesh_overlay, reg0, "mesh_mp_ingame_menu"),
      (position_set_x, pos1, 250),
      (position_set_y, pos1, 80),
      (overlay_set_position, reg0, pos1),
      (position_set_x, pos1, 1000),
      (position_set_y, pos1, 1000),
      (overlay_set_size, reg0, pos1),
      (str_clear, s0),
      (create_text_overlay, "$g_presentation_obj_poll_menu_container", s0, 131072),
      (position_set_x, pos1, 285),
      (position_set_y, pos1, 125),
      (overlay_set_position, "$g_presentation_obj_poll_menu_container", pos1),
      (position_set_x, pos1, 405),
      (position_set_y, pos1, 500),
      (overlay_set_area_size, "$g_presentation_obj_poll_menu_container", pos1),
      (945, "$g_presentation_obj_poll_menu_container"),
      (assign, "$g_presentation_obj_poll_menu_1", -1),
      (assign, "$g_presentation_obj_poll_menu_4", -1),
      (assign, "$g_presentation_obj_poll_menu_5", -1),
      (assign, ":var0", 450),
      (create_text_overlay, reg0, "str_choose_a_poll_type", 0),
      (overlay_set_color, reg0, 16777215),
      (position_set_x, pos1, 0),
      (position_set_y, pos1, ":var0"),
      (overlay_set_position, reg0, pos1),
      (val_sub, ":var0", 40),
      (position_set_x, pos1, 60),
      (try_begin),
        (eq, "$g_multiplayer_maps_voteable", 1),
        (create_button_overlay, "$g_presentation_obj_poll_menu_1", "str_poll_for_changing_the_map", 0),
        (overlay_set_color, "$g_presentation_obj_poll_menu_1", 16777215),
        (position_set_y, pos1, ":var0"),
        (overlay_set_position, "$g_presentation_obj_poll_menu_1", pos1),
        (val_sub, ":var0", 40),
      (try_end),
      (try_begin),
        (eq, "$g_multiplayer_factions_voteable", 1),
        (create_button_overlay, "$g_presentation_obj_poll_menu_4", "str_poll_for_changing_the_map_and_factions", 0),
        (overlay_set_color, "$g_presentation_obj_poll_menu_4", 16777215),
        (position_set_y, pos1, ":var0"),
        (overlay_set_position, "$g_presentation_obj_poll_menu_4", pos1),
        (val_sub, ":var0", 40),
      (try_end),
      (try_begin),
        (gt, "$g_multiplayer_num_bots_voteable", 0),
        (create_button_overlay, "$g_presentation_obj_poll_menu_5", "str_poll_for_changing_number_of_bots", 0),
        (overlay_set_color, "$g_presentation_obj_poll_menu_5", 16777215),
        (position_set_y, pos1, ":var0"),
        (overlay_set_position, "$g_presentation_obj_poll_menu_5", pos1),
        (val_sub, ":var0", 40),
      (try_end),
      (try_begin),
        (eq, "$g_multiplayer_kick_voteable", 1),
        (create_button_overlay, "$g_presentation_obj_poll_menu_2", "str_poll_for_kicking_a_player", 0),
        (overlay_set_color, "$g_presentation_obj_poll_menu_2", 16777215),
        (position_set_y, pos1, ":var0"),
        (overlay_set_position, "$g_presentation_obj_poll_menu_2", pos1),
        (val_sub, ":var0", 40),
      (try_end),
      (try_begin),
        (eq, "$g_multiplayer_ban_voteable", 1),
        (create_button_overlay, "$g_presentation_obj_poll_menu_3", "str_poll_for_banning_a_player", 0),
        (overlay_set_color, "$g_presentation_obj_poll_menu_3", 16777215),
        (position_set_y, pos1, ":var0"),
        (overlay_set_position, "$g_presentation_obj_poll_menu_3", pos1),
      (try_end),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (try_begin),
        (eq, ":var0", "$g_presentation_obj_poll_menu_1"),
        (presentation_set_duration, 0),
        (assign, "$g_multiplayer_maps_list_action_type", 1),
        (start_presentation, "prsnt_multiplayer_show_maps_list"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_poll_menu_2"),
        (presentation_set_duration, 0),
        (assign, "$g_multiplayer_players_list_action_type", 1),
        (start_presentation, "prsnt_multiplayer_show_players_list"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_poll_menu_3"),
        (presentation_set_duration, 0),
        (assign, "$g_multiplayer_players_list_action_type", 2),
        (start_presentation, "prsnt_multiplayer_show_players_list"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_poll_menu_4"),
        (presentation_set_duration, 0),
        (assign, "$g_multiplayer_maps_list_action_type", 2),
        (start_presentation, "prsnt_multiplayer_show_maps_list"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_poll_menu_5"),
        (presentation_set_duration, 0),
        (assign, "$g_multiplayer_number_of_bots_list_action_type", 1),
        (start_presentation, "prsnt_multiplayer_show_number_of_bots_list"),
      (try_end),
    ]),
    (ti_on_presentation_run,
    [
      (store_trigger_param_1, ":var0"),
      (try_begin),
        (key_clicked, key_escape),
        (gt, ":var0", 200),
        (presentation_set_duration, 0),
      (try_end),
    ]),
  ]),

  ("multiplayer_show_players_list", prsntf_manual_end_only, mesh_null,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (create_mesh_overlay, reg0, "mesh_mp_ingame_menu"),
      (position_set_x, pos1, 250),
      (position_set_y, pos1, 80),
      (overlay_set_position, reg0, pos1),
      (position_set_x, pos1, 1000),
      (position_set_y, pos1, 1000),
      (overlay_set_size, reg0, pos1),
      (str_clear, s0),
      (create_text_overlay, "$g_presentation_obj_show_players_1", s0, 131072),
      (position_set_x, pos1, 285),
      (position_set_y, pos1, 125),
      (overlay_set_position, "$g_presentation_obj_show_players_1", pos1),
      (position_set_x, pos1, 405),
      (position_set_y, pos1, 500),
      (overlay_set_area_size, "$g_presentation_obj_show_players_1", pos1),
      (945, "$g_presentation_obj_show_players_1"),
      (415, ":var0"),
      (assign, ":var1", 10),
      (400, ":var2"),
      (try_for_range, ":var3", 1, ":var2"),
        (401, ":var3"),
        (assign, ":var4", 0),
        (try_begin),
          (neq, "$g_multiplayer_players_list_action_type", 5),
          (neq, "$g_multiplayer_players_list_action_type", 6),
          (assign, ":var4", 1),
        (else_try),
          (eq, "$g_multiplayer_players_list_action_type", 5),
          (neq, ":var3", ":var0"),
          (439, ":var5", ":var3"),
          (eq, ":var5", 0),
          (assign, ":var4", 1),
        (else_try),
          (eq, "$g_multiplayer_players_list_action_type", 6),
          (neq, ":var3", ":var0"),
          (439, ":var5", ":var3"),
          (eq, ":var5", 1),
          (assign, ":var4", 1),
        (try_end),
        (eq, ":var4", 1),
        (val_add, ":var1", 40),
      (try_end),
      (create_text_overlay, reg0, "str_choose_a_player", 0),
      (overlay_set_color, reg0, 16777215),
      (position_set_x, pos1, 0),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, reg0, pos1),
      (val_sub, ":var1", 40),
      (400, ":var2"),
      (try_for_range, ":var3", 1, ":var2"),
        (401, ":var3"),
        (508, ":var3", 22, -1),
        (assign, ":var4", 0),
        (try_begin),
          (neq, "$g_multiplayer_players_list_action_type", 5),
          (neq, "$g_multiplayer_players_list_action_type", 6),
          (assign, ":var4", 1),
        (else_try),
          (eq, "$g_multiplayer_players_list_action_type", 5),
          (neq, ":var3", ":var0"),
          (439, ":var5", ":var3"),
          (eq, ":var5", 0),
          (assign, ":var4", 1),
        (else_try),
          (eq, "$g_multiplayer_players_list_action_type", 6),
          (neq, ":var3", ":var0"),
          (439, ":var5", ":var3"),
          (eq, ":var5", 1),
          (assign, ":var4", 1),
        (try_end),
        (eq, ":var4", 1),
        (2350, 0, ":var3"),
        (create_button_overlay, ":var6", s0, 0),
        (overlay_set_color, ":var6", 16777215),
        (position_set_x, pos1, 130),
        (position_set_y, pos1, ":var1"),
        (overlay_set_position, ":var6", pos1),
        (val_sub, ":var1", 40),
        (508, ":var3", 22, ":var6"),
      (try_end),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (400, ":var1"),
      (try_for_range, ":var2", 1, ":var1"),
        (401, ":var2"),
        (548, ":var2", 22, ":var0"),
        (try_begin),
          (is_between, "$g_multiplayer_players_list_action_type", 1, 3),
          (try_begin),
            (415, ":var3"),
            (ge, ":var3", 0),
            (390, 21, "$g_multiplayer_players_list_action_type", ":var2"),
            (store_mission_timer_a, ":var4"),
            (val_add, ":var4", 900),
            (508, ":var3", 26, ":var4"),
          (try_end),
        (else_try),
          (eq, "$g_multiplayer_players_list_action_type", 3),
          (389, 23, ":var2"),
        (else_try),
          (eq, "$g_multiplayer_players_list_action_type", 4),
          (389, 24, ":var2"),
        (else_try),
          (eq, "$g_multiplayer_players_list_action_type", 5),
          (440, ":var2", 1),
        (else_try),
          (eq, "$g_multiplayer_players_list_action_type", 6),
          (440, ":var2", 0),
        (try_end),
        (assign, ":var1", 0),
        (presentation_set_duration, 0),
      (try_end),
    ]),
    (ti_on_presentation_run,
    [
      (store_trigger_param_1, ":var0"),
      (try_begin),
        (key_clicked, key_escape),
        (gt, ":var0", 200),
        (presentation_set_duration, 0),
      (try_end),
    ]),
  ]),

  ("multiplayer_show_maps_list", prsntf_manual_end_only, mesh_null,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (create_mesh_overlay, reg0, "mesh_mp_ingame_menu"),
      (position_set_x, pos1, 250),
      (position_set_y, pos1, 80),
      (overlay_set_position, reg0, pos1),
      (position_set_x, pos1, 1000),
      (position_set_y, pos1, 1000),
      (overlay_set_size, reg0, pos1),
      (str_clear, s0),
      (create_text_overlay, "$g_presentation_obj_show_maps_list_menu_container", s0, 131072),
      (position_set_x, pos1, 285),
      (position_set_y, pos1, 125),
      (overlay_set_position, "$g_presentation_obj_show_maps_list_menu_container", pos1),
      (position_set_x, pos1, 405),
      (position_set_y, pos1, 500),
      (overlay_set_area_size, "$g_presentation_obj_show_maps_list_menu_container", pos1),
      (945, "$g_presentation_obj_show_maps_list_menu_container"),
      (call_script, "script_multiplayer_fill_map_game_types", "$g_multiplayer_game_type"),
      (assign, ":var0", reg0),
      (store_mul, ":var1", ":var0", 40),
      (val_add, ":var1", 10),
      (create_text_overlay, reg0, "str_choose_a_map", 0),
      (overlay_set_color, reg0, 16777215),
      (position_set_x, pos1, 0),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, reg0, pos1),
      (val_sub, ":var1", 40),
      (assign, ":var2", -1),
      (try_for_range, ":var3", 0, ":var0"),
        (store_add, ":var4", ":var3", 0),
        (troop_get_slot, ":var5", "trp_multiplayer_data", ":var4"),
        (store_sub, ":var6", ":var5", "scn_multi_scene_1"),
        (val_add, ":var6", "str_multi_scene_1"),
        (str_store_string, s0, ":var6"),
        (create_button_overlay, ":var2", s0, 0),
        (overlay_set_color, ":var2", 16777215),
        (position_set_x, pos1, 100),
        (position_set_y, pos1, ":var1"),
        (overlay_set_position, ":var2", pos1),
        (val_sub, ":var1", 40),
      (try_end),
      (store_add, "$g_show_maps_list_button_list_end_index", ":var2", 1),
      (store_sub, "$g_show_maps_list_button_list_first_index", "$g_show_maps_list_button_list_end_index", ":var0"),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (try_for_range, ":var1", "$g_show_maps_list_button_list_first_index", "$g_show_maps_list_button_list_end_index"),
        (eq, ":var0", ":var1"),
        (call_script, "script_multiplayer_fill_map_game_types", "$g_multiplayer_game_type"),
        (store_sub, ":var2", ":var0", "$g_show_maps_list_button_list_first_index"),
        (val_add, ":var2", 0),
        (troop_get_slot, ":var3", "trp_multiplayer_data", ":var2"),
        (presentation_set_duration, 0),
        (try_begin),
          (eq, "$g_multiplayer_maps_list_action_type", 1),
          (try_begin),
            (415, ":var4"),
            (ge, ":var4", 0),
            (390, 21, 0, ":var3"),
            (store_mission_timer_a, ":var5"),
            (val_add, ":var5", 900),
            (508, ":var4", 26, ":var5"),
          (try_end),
        (else_try),
          (assign, "$g_multiplayer_factions_list_action_type", 1),
          (assign, "$g_multiplayer_poll_for_map_and_faction_data_map", ":var3"),
          (start_presentation, "prsnt_multiplayer_show_factions_list"),
        (try_end),
        (assign, "$g_show_maps_list_button_list_end_index", 0),
      (try_end),
    ]),
    (ti_on_presentation_run,
    [
      (store_trigger_param_1, ":var0"),
      (try_begin),
        (key_clicked, key_escape),
        (gt, ":var0", 200),
        (presentation_set_duration, 0),
      (try_end),
    ]),
  ]),

  ("multiplayer_show_factions_list", prsntf_manual_end_only, mesh_null,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (create_mesh_overlay, reg0, "mesh_mp_ingame_menu"),
      (position_set_x, pos1, 250),
      (position_set_y, pos1, 80),
      (overlay_set_position, reg0, pos1),
      (position_set_x, pos1, 1000),
      (position_set_y, pos1, 1000),
      (overlay_set_size, reg0, pos1),
      (str_clear, s0),
      (create_text_overlay, "$g_presentation_obj_show_factions_list_menu_container", s0, 131072),
      (position_set_x, pos1, 285),
      (position_set_y, pos1, 125),
      (overlay_set_position, "$g_presentation_obj_show_factions_list_menu_container", pos1),
      (position_set_x, pos1, 405),
      (position_set_y, pos1, 500),
      (overlay_set_area_size, "$g_presentation_obj_show_factions_list_menu_container", pos1),
      (945, "$g_presentation_obj_show_factions_list_menu_container"),
      (store_sub, ":var0", "fac_kingdoms_end", "fac_kingdom_1"),
      (try_begin),
        (eq, "$g_multiplayer_factions_list_action_type", 2),
        (val_sub, ":var0", 1),
      (try_end),
      (store_mul, ":var1", ":var0", 40),
      (val_add, ":var1", 10),
      (assign, reg0, "$g_multiplayer_factions_list_action_type"),
      (create_text_overlay, reg0, "str_choose_a_faction_for_team_reg0", 0),
      (overlay_set_color, reg0, 16777215),
      (position_set_x, pos1, 0),
      (position_set_y, pos1, ":var1"),
      (overlay_set_position, reg0, pos1),
      (val_sub, ":var1", 40),
      (assign, ":var2", -1),
      (try_for_range, ":var3", "fac_kingdom_1", "fac_kingdoms_end"),
        (this_or_next|eq, "$g_multiplayer_factions_list_action_type", 1),
        (neq, "$g_multiplayer_poll_for_map_and_faction_data_faction_1", ":var3"),
        (str_store_faction_name, s0, ":var3"),
        (create_button_overlay, ":var2", s0, 0),
        (overlay_set_color, ":var2", 16777215),
        (position_set_x, pos1, 100),
        (position_set_y, pos1, ":var1"),
        (overlay_set_position, ":var2", pos1),
        (val_sub, ":var1", 40),
      (try_end),
      (store_add, "$g_show_factions_list_button_list_end_index", ":var2", 1),
      (store_sub, "$g_show_factions_list_button_list_first_index", "$g_show_factions_list_button_list_end_index", ":var0"),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (try_for_range, ":var1", "$g_show_factions_list_button_list_first_index", "$g_show_factions_list_button_list_end_index"),
        (eq, ":var0", ":var1"),
        (store_sub, ":var2", ":var0", "$g_show_factions_list_button_list_first_index"),
        (val_add, ":var2", "fac_kingdom_1"),
        (presentation_set_duration, 0),
        (try_begin),
          (eq, "$g_multiplayer_factions_list_action_type", 2),
          (try_begin),
            (ge, ":var2", "$g_multiplayer_poll_for_map_and_faction_data_faction_1"),
            (val_add, ":var2", 1),
          (try_end),
          (try_begin),
            (415, ":var3"),
            (ge, ":var3", 0),
            (392, 21, 3, "$g_multiplayer_poll_for_map_and_faction_data_map", "$g_multiplayer_poll_for_map_and_faction_data_faction_1", ":var2"),
            (store_mission_timer_a, ":var4"),
            (val_add, ":var4", 900),
            (508, ":var3", 26, ":var4"),
          (try_end),
        (else_try),
          (assign, "$g_multiplayer_factions_list_action_type", 2),
          (assign, "$g_multiplayer_poll_for_map_and_faction_data_faction_1", ":var2"),
          (start_presentation, "prsnt_multiplayer_show_factions_list"),
        (try_end),
        (assign, "$g_show_factions_list_button_list_end_index", 0),
      (try_end),
    ]),
    (ti_on_presentation_run,
    [
      (store_trigger_param_1, ":var0"),
      (try_begin),
        (key_clicked, key_escape),
        (gt, ":var0", 200),
        (presentation_set_duration, 0),
      (try_end),
    ]),
  ]),

  ("multiplayer_show_number_of_bots_list", prsntf_manual_end_only, mesh_null,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (create_mesh_overlay, reg0, "mesh_mp_ingame_menu"),
      (position_set_x, pos1, 250),
      (position_set_y, pos1, 80),
      (overlay_set_position, reg0, pos1),
      (position_set_x, pos1, 1000),
      (position_set_y, pos1, 1000),
      (overlay_set_size, reg0, pos1),
      (str_clear, s0),
      (create_text_overlay, "$g_presentation_obj_show_number_of_bots_list_menu_container", s0, 131072),
      (position_set_x, pos1, 285),
      (position_set_y, pos1, 125),
      (overlay_set_position, "$g_presentation_obj_show_number_of_bots_list_menu_container", pos1),
      (position_set_x, pos1, 405),
      (position_set_y, pos1, 500),
      (overlay_set_area_size, "$g_presentation_obj_show_number_of_bots_list_menu_container", pos1),
      (945, "$g_presentation_obj_show_number_of_bots_list_menu_container"),
      (assign, ":var0", 0),
      (store_add, ":var1", "$g_multiplayer_num_bots_voteable", 1),
      (try_for_range, ":var2", 0, ":var1"),
        (assign, ":var3", ":var2"),
        (val_mod, ":var3", 5),
        (this_or_next|lt, ":var2", 10),
        (eq, ":var3", 0),
        (val_add, ":var0", 1),
      (try_end),
      (store_mul, ":var4", ":var0", 40),
      (val_add, ":var4", 10),
      (assign, reg0, "$g_multiplayer_number_of_bots_list_action_type"),
      (create_text_overlay, reg0, "str_choose_number_of_bots_for_team_reg0", 0),
      (overlay_set_color, reg0, 16777215),
      (position_set_x, pos1, 0),
      (position_set_y, pos1, ":var4"),
      (overlay_set_position, reg0, pos1),
      (val_sub, ":var4", 40),
      (assign, ":var5", -1),
      (try_for_range, ":var2", 0, ":var1"),
        (assign, ":var3", ":var2"),
        (val_mod, ":var3", 5),
        (this_or_next|lt, ":var2", 10),
        (eq, ":var3", 0),
        (assign, reg0, ":var2"),
        (str_store_string, s0, "str_reg0"),
        (create_button_overlay, ":var5", s0, 0),
        (overlay_set_color, ":var5", 16777215),
        (position_set_x, pos1, 100),
        (position_set_y, pos1, ":var4"),
        (overlay_set_position, ":var5", pos1),
        (val_sub, ":var4", 40),
      (try_end),
      (store_add, "$g_show_number_of_bots_list_button_list_end_index", ":var5", 1),
      (store_sub, "$g_show_number_of_bots_list_button_list_first_index", "$g_show_number_of_bots_list_button_list_end_index", ":var0"),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (try_for_range, ":var1", "$g_show_number_of_bots_list_button_list_first_index", "$g_show_number_of_bots_list_button_list_end_index"),
        (eq, ":var0", ":var1"),
        (store_sub, ":var2", ":var0", "$g_show_number_of_bots_list_button_list_first_index"),
        (try_begin),
          (lt, ":var2", 10),
          (assign, ":var3", ":var2"),
        (else_try),
          (store_sub, ":var3", ":var2", 8),
          (val_mul, ":var3", 5),
        (try_end),
        (presentation_set_duration, 0),
        (try_begin),
          (eq, "$g_multiplayer_number_of_bots_list_action_type", 2),
          (try_begin),
            (415, ":var4"),
            (ge, ":var4", 0),
            (391, 21, 4, "$g_multiplayer_poll_number_of_bots_team_1", ":var3"),
            (store_mission_timer_a, ":var5"),
            (val_add, ":var5", 900),
            (508, ":var4", 26, ":var5"),
          (try_end),
        (else_try),
          (assign, "$g_multiplayer_number_of_bots_list_action_type", 2),
          (assign, "$g_multiplayer_poll_number_of_bots_team_1", ":var3"),
          (start_presentation, "prsnt_multiplayer_show_number_of_bots_list"),
        (try_end),
        (assign, "$g_show_number_of_bots_list_button_list_end_index", 0),
      (try_end),
    ]),
    (ti_on_presentation_run,
    [
      (store_trigger_param_1, ":var0"),
      (try_begin),
        (key_clicked, key_escape),
        (gt, ":var0", 200),
        (presentation_set_duration, 0),
      (try_end),
    ]),
  ]),

  ("multiplayer_poll", prsntf_read_only|prsntf_manual_end_only, mesh_null,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (create_mesh_overlay, reg0, "mesh_white_plane"),
      (overlay_set_color, reg0, 0),
      (overlay_set_alpha, reg0, 0x44),
      (position_set_x, pos1, 50),
      (position_set_y, pos1, 50),
      (overlay_set_position, reg0, pos1),
      (position_set_x, pos1, 37500),
      (position_set_y, pos1, 4500),
      (overlay_set_size, reg0, pos1),
      (try_begin),
        (eq, "$g_multiplayer_poll_to_show", 0),
        (store_sub, ":var0", "$g_multiplayer_poll_value_to_show", "scn_multi_scene_1"),
        (val_add, ":var0", "str_multi_scene_1"),
        (str_store_string, s0, ":var0"),
        (create_text_overlay, reg0, "str_poll_change_map", 16),
      (else_try),
        (eq, "$g_multiplayer_poll_to_show", 1),
        (2350, 0, "$g_multiplayer_poll_value_to_show"),
        (create_text_overlay, reg0, "str_poll_kick_player", 16),
      (else_try),
        (eq, "$g_multiplayer_poll_to_show", 2),
        (2350, 0, "$g_multiplayer_poll_value_to_show"),
        (create_text_overlay, reg0, "str_poll_ban_player", 16),
      (else_try),
        (eq, "$g_multiplayer_poll_to_show", 3),
        (store_sub, ":var0", "$g_multiplayer_poll_value_to_show", "scn_multi_scene_1"),
        (val_add, ":var0", "str_multi_scene_1"),
        (str_store_string, s0, ":var0"),
        (str_store_faction_name, s1, "$g_multiplayer_poll_value_2_to_show"),
        (str_store_faction_name, s2, "$g_multiplayer_poll_value_3_to_show"),
        (create_text_overlay, reg0, "str_poll_change_map_with_faction", 131088),
      (else_try),
        (assign, reg0, "$g_multiplayer_poll_value_to_show"),
        (assign, reg1, "$g_multiplayer_poll_value_2_to_show"),
        (str_store_faction_name, s0, "$g_multiplayer_team_1_faction"),
        (str_store_faction_name, s1, "$g_multiplayer_team_2_faction"),
        (create_text_overlay, reg0, "str_poll_change_number_of_bots", 131088),
      (try_end),
      (overlay_set_color, reg0, 16777215),
      (try_begin),
        (neq, "$g_multiplayer_poll_to_show", 3),
        (neq, "$g_multiplayer_poll_to_show", 4),
        (position_set_x, pos1, 400),
        (position_set_y, pos1, 100),
        (overlay_set_position, reg0, pos1),
      (else_try),
        (position_set_x, pos1, 50),
        (position_set_y, pos1, 70),
        (overlay_set_position, reg0, pos1),
        (position_set_x, pos1, 750),
        (position_set_y, pos1, 60),
        (overlay_set_area_size, reg0, pos1),
      (try_end),
      (store_mission_timer_a, ":var1"),
      (store_sub, "$g_multiplayer_poll_last_written_seconds_left", "$g_multiplayer_poll_client_end_time", ":var1"),
      (assign, reg0, "$g_multiplayer_poll_last_written_seconds_left"),
      (create_text_overlay, "$g_presentation_obj_poll_1", "str_poll_time_left", 32776),
      (overlay_set_color, "$g_presentation_obj_poll_1", 16777215),
      (position_set_x, pos1, 790),
      (position_set_y, pos1, 60),
      (overlay_set_position, "$g_presentation_obj_poll_1", pos1),
      (77, 2),
      (77, 3),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_run,
    [
      (store_trigger_param_1, ":var0"),
      (try_begin),
        (this_or_next|key_clicked, key_escape),
        (key_clicked, key_2),
        (gt, ":var0", 500),
        (389, 22, 0),
        (78),
        (presentation_set_duration, 0),
      (else_try),
        (key_clicked, key_1),
        (gt, ":var0", 500),
        (389, 22, 1),
        (78),
        (presentation_set_duration, 0),
      (try_end),
      (store_mission_timer_a, ":var1"),
      (store_sub, ":var2", "$g_multiplayer_poll_client_end_time", ":var1"),
      (try_begin),
        (neq, ":var2", "$g_multiplayer_poll_last_written_seconds_left"),
        (try_begin),
          (lt, ":var2", 0),
          (78),
          (presentation_set_duration, 0),
        (else_try),
          (assign, "$g_multiplayer_poll_last_written_seconds_left", ":var2"),
          (assign, reg0, "$g_multiplayer_poll_last_written_seconds_left"),
          (overlay_set_text, "$g_presentation_obj_poll_1", "str_poll_time_left"),
        (try_end),
      (try_end),
    ]),
  ]),

  ("tutorial_show_mouse_movement", prsntf_read_only|prsntf_manual_end_only, mesh_null,
  [
    (ti_on_presentation_load,
    [
      (try_begin),
        (this_or_next|eq, "$g_tutorial_mouse_dir", -1),
        (eq, "$g_tutorial_mouse_click", -1),
        (presentation_set_duration, 0),
      (else_try),
        (set_fixed_point_multiplier, 1000),
        (assign, "$g_tutorial_displayed_mouse_dir", "$g_tutorial_mouse_dir"),
        (assign, "$g_tutorial_displayed_mouse_click", "$g_tutorial_mouse_click"),
        (store_add, ":var0", "$g_tutorial_mouse_dir", "mesh_mouse_arrow_down"),
        (create_mesh_overlay, reg0, ":var0"),
        (position_set_x, pos1, 800),
        (position_set_y, pos1, 800),
        (overlay_set_size, reg0, pos1),
        (position_set_x, pos1, 380),
        (position_set_y, pos1, 500),
        (overlay_set_position, reg0, pos1),
        (try_begin),
          (eq, "$g_tutorial_mouse_click", 0),
          (create_mesh_overlay, reg0, "mesh_mouse_left_click"),
        (else_try),
          (create_mesh_overlay, reg0, "mesh_mouse_right_click"),
        (try_end),
        (position_set_x, pos1, 800),
        (position_set_y, pos1, 800),
        (overlay_set_size, reg0, pos1),
        (position_set_x, pos1, 540),
        (position_set_y, pos1, 500),
        (overlay_set_position, reg0, pos1),
        (create_mesh_overlay, reg0, "mesh_mouse_arrow_plus"),
        (overlay_set_color, reg0, 16777215),
        (position_set_x, pos1, 600),
        (position_set_y, pos1, 600),
        (overlay_set_size, reg0, pos1),
        (position_set_x, pos1, 470),
        (position_set_y, pos1, 510),
        (overlay_set_position, reg0, pos1),
        (presentation_set_duration, 999999),
      (try_end),
    ]),
    (ti_on_presentation_run,
    [
      (try_begin),
        (this_or_next|neq, "$g_tutorial_displayed_mouse_dir", "$g_tutorial_mouse_dir"),
        (neq, "$g_tutorial_displayed_mouse_click", "$g_tutorial_mouse_click"),
        (presentation_set_duration, 0),
        (try_begin),
          (ge, "$g_tutorial_mouse_dir", 0),
          (ge, "$g_tutorial_mouse_click", 0),
          (start_presentation, "prsnt_tutorial_show_mouse_movement"),
        (try_end),
      (try_end),
    ]),
  ]),

  ("name_party", 0, mesh_load_window,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (str_store_string, s1, "@What will be the name of your party?"),
      (create_text_overlay, reg1, s1, 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 500),
      (overlay_set_position, reg1, pos1),
      (overlay_set_text, reg1, s1),
      (919, "$g_presentation_obj_name_kingdom_1"),
      (position_set_x, pos1, 400),
      (position_set_y, pos1, 400),
      (overlay_set_position, "$g_presentation_obj_name_kingdom_1", pos1),
      (str_store_party_name, s7, "p_main_party"),
      (overlay_set_text, "$g_presentation_obj_name_kingdom_1", s7),
      (create_button_overlay, "$g_presentation_obj_name_kingdom_2", "@Continue...", 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 300),
      (overlay_set_position, "$g_presentation_obj_name_kingdom_2", pos1),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (try_begin),
        (eq, ":var0", "$g_presentation_obj_name_kingdom_1"),
        (str_store_string, s7, s0),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_name_kingdom_2"),
        (party_set_name, "p_main_party", s7),
        (presentation_set_duration, 0),
      (try_end),
    ]),
  ]),

  ("name_old_ruins", 0, mesh_load_window,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (str_store_string, s1, "@What will be the name of your secret camp?"),
      (create_text_overlay, reg1, s1, 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 500),
      (overlay_set_position, reg1, pos1),
      (overlay_set_text, reg1, s1),
      (919, "$g_presentation_obj_name_kingdom_1"),
      (position_set_x, pos1, 400),
      (position_set_y, pos1, 400),
      (overlay_set_position, "$g_presentation_obj_name_kingdom_1", pos1),
      (str_store_party_name, s7, "p_old_ruins"),
      (overlay_set_text, "$g_presentation_obj_name_kingdom_1", s7),
      (create_button_overlay, "$g_presentation_obj_name_kingdom_2", "@Continue...", 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 300),
      (overlay_set_position, "$g_presentation_obj_name_kingdom_2", pos1),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (try_begin),
        (eq, ":var0", "$g_presentation_obj_name_kingdom_1"),
        (str_store_string, s7, s0),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_name_kingdom_2"),
        (party_set_name, "p_old_ruins", s7),
        (presentation_set_duration, 0),
      (try_end),
    ]),
  ]),

  ("name_stronghold", 0, mesh_load_window,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (str_store_string, s1, "@What shall be the new name of the Order stronghold?"),
      (create_text_overlay, reg1, s1, 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 500),
      (overlay_set_position, reg1, pos1),
      (overlay_set_text, reg1, s1),
      (919, "$g_presentation_obj_name_kingdom_1"),
      (position_set_x, pos1, 400),
      (position_set_y, pos1, 400),
      (overlay_set_position, "$g_presentation_obj_name_kingdom_1", pos1),
      (str_store_party_name, s7, "p_snake_stronghold"),
      (overlay_set_text, "$g_presentation_obj_name_kingdom_1", s7),
      (create_button_overlay, "$g_presentation_obj_name_kingdom_2", "@Continue...", 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 300),
      (overlay_set_position, "$g_presentation_obj_name_kingdom_2", pos1),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (try_begin),
        (eq, ":var0", "$g_presentation_obj_name_kingdom_1"),
        (str_store_string, s7, s0),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_name_kingdom_2"),
        (party_set_name, "p_snake_stronghold", s7),
        (presentation_set_duration, 0),
      (try_end),
    ]),
  ]),

  ("name_kingdom", 0, mesh_load_window,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (str_store_string, s1, "str_name_kingdom_text"),
      (create_text_overlay, reg1, s1, 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 500),
      (overlay_set_position, reg1, pos1),
      (overlay_set_text, reg1, s1),
      (919, "$g_presentation_obj_name_kingdom_1"),
      (position_set_x, pos1, 400),
      (position_set_y, pos1, 400),
      (overlay_set_position, "$g_presentation_obj_name_kingdom_1", pos1),
      (try_begin),
        (eq, "$players_kingdom_name_set", 1),
        (str_store_faction_name, s7, "fac_player_supporters_faction"),
        (overlay_set_text, "$g_presentation_obj_name_kingdom_1", s7),
      (else_try),
        (str_store_troop_name, s0, "trp_player"),
        (overlay_set_text, "$g_presentation_obj_name_kingdom_1", "str_default_kingdom_name"),
        (str_store_string, s7, "str_default_kingdom_name"),
      (try_end),
      (create_button_overlay, "$g_presentation_obj_name_kingdom_2", "@Continue...", 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 300),
      (overlay_set_position, "$g_presentation_obj_name_kingdom_2", pos1),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (try_begin),
        (eq, ":var0", "$g_presentation_obj_name_kingdom_1"),
        (str_store_string, s7, s0),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_name_kingdom_2"),
        (faction_set_name, "fac_player_supporters_faction", s7),
        (faction_set_color, "fac_player_supporters_faction", 3200456),
        (assign, "$players_kingdom_name_set", 1),
        (presentation_set_duration, 0),
      (try_end),
    ]),
  ]),

  ("set_vassal_title", 0, mesh_load_window,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (str_clear, s1),
      (str_clear, s2),
      (create_text_overlay, reg0, "@What shall be the title of your male vassals?", 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 600),
      (overlay_set_position, reg0, pos1),
      (create_text_overlay, reg0, "@What shall be the title of your female vassals?", 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 400),
      (overlay_set_position, reg0, pos1),
      (str_clear, s0),
      (919, "$g_presentation_obj_name_kingdom_1"),
      (position_set_x, pos1, 400),
      (position_set_y, pos1, 550),
      (overlay_set_position, "$g_presentation_obj_name_kingdom_1", pos1),
      (try_begin),
        (troop_slot_eq, "trp_heroes_end", 0, 1),
        (str_store_troop_name, s0, "trp_heroes_end"),
      (else_try),
        (try_begin),
          (faction_get_slot, ":var0", "fac_player_supporters_faction", 10),
          (try_begin),
            (store_add, ":var1", "fac_culture_6", 1),
            (neg|is_between, ":var0", "fac_culture_1", ":var1"),
            (store_sub, ":var0", "fac_culture_1", 1),
          (try_end),
          (store_sub, ":var2", ":var0", "fac_culture_1"),
          (val_add, ":var2", 1),
          (val_add, ":var2", "str_faction_title_male_player"),
          (str_store_string, s0, ":var2"),
        (else_try),
          (str_store_string, s0, "@{!}"),
          (str_store_string, s0, "str_faction_title_male_player"),
        (try_end),
      (try_end),
      (overlay_set_text, "$g_presentation_obj_name_kingdom_1", s0),
      (str_clear, s0),
      (919, reg0),
      (position_set_x, pos1, 400),
      (position_set_y, pos1, 350),
      (overlay_set_position, reg0, pos1),
      (try_begin),
        (troop_slot_eq, "trp_heroes_end", 1, 1),
        (str_store_troop_name_plural, s0, "trp_heroes_end"),
      (else_try),
        (try_begin),
          (faction_get_slot, ":var0", "fac_player_supporters_faction", 10),
          (try_begin),
            (store_add, ":var1", "fac_culture_6", 1),
            (neg|is_between, ":var0", "fac_culture_1", ":var1"),
            (store_sub, ":var0", "fac_culture_1", 1),
          (try_end),
          (store_sub, ":var2", ":var0", "fac_culture_1"),
          (val_add, ":var2", 1),
          (val_add, ":var2", "str_faction_title_female_player"),
          (str_store_string, s0, ":var2"),
        (else_try),
          (str_store_string, s0, "@{!}"),
          (str_store_string, s0, "str_faction_title_female_player"),
        (try_end),
      (try_end),
      (overlay_set_text, reg0, s0),
      (create_button_overlay, reg0, "@Use specified titles.", 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 200),
      (overlay_set_position, reg0, pos1),
      (create_button_overlay, reg0, "@Use titles default for your kingdom's culture.", 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 150),
      (overlay_set_position, reg0, pos1),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (try_begin),
        (eq, ":var0", "$g_presentation_obj_name_kingdom_1"),
        (str_store_string, s1, s0),
      (else_try),
        (store_add, ":var1", "$g_presentation_obj_name_kingdom_1", 1),
        (eq, ":var0", ":var1"),
        (str_store_string, s2, s0),
      (else_try),
        (val_add, ":var1", 1),
        (eq, ":var0", ":var1"),
        (try_begin),
          (neg|2318, 1),
          (1501, "trp_heroes_end", 1),
          (troop_set_slot, "trp_heroes_end", 0, 1),
          (try_for_range, ":var2", "trp_knight_1_1", "trp_kingdom_1_pretender"),
            (store_troop_faction, ":var3", ":var2"),
            (eq, ":var3", "fac_player_supporters_faction"),
            (call_script, "script_troop_set_title_according_to_faction", ":var2", ":var3"),
          (try_end),
        (try_end),
        (try_begin),
          (neg|2318, 2),
          (1502, "trp_heroes_end", 2),
          (troop_set_slot, "trp_heroes_end", 1, 1),
          (try_for_range, ":var2", "trp_knight_1_1_wife", "trp_heroes_end"),
            (store_troop_faction, ":var3", ":var2"),
            (eq, ":var3", "fac_player_supporters_faction"),
            (call_script, "script_troop_set_title_according_to_faction", ":var2", ":var3"),
          (try_end),
        (try_end),
        (try_begin),
          (neg|this_or_next|2318, 1),
          (neg|2318, 2),
          (try_for_range, ":var2", "trp_npc_adonja", "trp_kingdom_1_lord"),
            (store_troop_faction, ":var3", ":var2"),
            (eq, ":var3", "fac_player_supporters_faction"),
            (troop_slot_eq, ":var2", 2, 2),
            (call_script, "script_troop_set_title_according_to_faction", ":var2", ":var3"),
          (try_end),
        (try_end),
        (presentation_set_duration, 0),
      (else_try),
        (val_add, ":var1", 1),
        (eq, ":var0", ":var1"),
        (troop_set_slot, "trp_heroes_end", 0, 0),
        (troop_set_slot, "trp_heroes_end", 1, 0),
        (try_for_range, ":var2", "trp_knight_1_1", "trp_heroes_end"),
          (neg|is_between, ":var2", "trp_kingdom_1_pretender", "trp_knight_1_1_wife"),
          (store_troop_faction, ":var3", ":var2"),
          (eq, ":var3", "fac_player_supporters_faction"),
          (call_script, "script_troop_set_title_according_to_faction", ":var2", ":var3"),
        (try_end),
        (try_for_range, ":var2", "trp_npc_adonja", "trp_kingdom_1_lord"),
          (store_troop_faction, ":var3", ":var2"),
          (eq, ":var3", "fac_player_supporters_faction"),
          (troop_slot_eq, ":var2", 2, 2),
          (call_script, "script_troop_set_title_according_to_faction", ":var2", ":var3"),
        (try_end),
        (presentation_set_duration, 0),
      (try_end),
    ]),
  ]),

  ("name_order", 0, mesh_load_window,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (str_store_string, s1, "@What shall be the name of your Order?"),
      (create_text_overlay, reg1, s1, 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 550),
      (overlay_set_position, reg1, pos1),
      (overlay_set_text, reg1, s1),
      (str_store_string, s1, "@Order of the"),
      (create_text_overlay, reg1, s1, 16),
      (position_set_x, pos1, 400),
      (position_set_y, pos1, 500),
      (overlay_set_position, reg1, pos1),
      (overlay_set_text, reg1, s1),
      (919, "$g_presentation_obj_name_kingdom_1"),
      (position_set_x, pos1, 470),
      (position_set_y, pos1, 500),
      (overlay_set_position, "$g_presentation_obj_name_kingdom_1", pos1),
      (try_begin),
        (eq, "$players_order_name_set", 1),
        (str_store_faction_name, s7, "fac_player_knights"),
        (overlay_set_text, "$g_presentation_obj_name_kingdom_1", s7),
      (else_try),
        (str_store_troop_name, s0, "trp_player"),
        (overlay_set_text, "$g_presentation_obj_name_kingdom_1", "@Knights of {s0}"),
        (str_store_string, s7, "@Knights of {s0}"),
      (try_end),
      (str_store_string, s1, "@What shall be called your Order Knight (singular and plural)?"),
      (create_text_overlay, reg1, s1, 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 450),
      (overlay_set_position, reg1, pos1),
      (overlay_set_text, reg1, s1),
      (919, "$g_presentation_obj_name_order_knight"),
      (position_set_x, pos1, 250),
      (position_set_y, pos1, 400),
      (overlay_set_position, "$g_presentation_obj_name_order_knight", pos1),
      (str_store_troop_name, s8, "trp_player_knight"),
      (overlay_set_text, "$g_presentation_obj_name_order_knight", s8),
      (919, "$g_presentation_obj_name_order_knight_plural"),
      (position_set_x, pos1, 550),
      (position_set_y, pos1, 400),
      (overlay_set_position, "$g_presentation_obj_name_order_knight_plural", pos1),
      (str_store_troop_name_plural, s10, "trp_player_knight"),
      (overlay_set_text, "$g_presentation_obj_name_order_knight_plural", s10),
      (str_store_string, s1, "@What shall be called your Order Sergeant (singular and plural)?"),
      (create_text_overlay, reg1, s1, 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 350),
      (overlay_set_position, reg1, pos1),
      (overlay_set_text, reg1, s1),
      (919, "$g_presentation_obj_name_order_squire"),
      (position_set_x, pos1, 250),
      (position_set_y, pos1, 300),
      (overlay_set_position, "$g_presentation_obj_name_order_squire", pos1),
      (str_store_troop_name, s9, "trp_player_sergeant"),
      (overlay_set_text, "$g_presentation_obj_name_order_squire", s9),
      (919, "$g_presentation_obj_name_order_squire_plural"),
      (position_set_x, pos1, 550),
      (position_set_y, pos1, 300),
      (overlay_set_position, "$g_presentation_obj_name_order_squire_plural", pos1),
      (str_store_troop_name_plural, s11, "trp_player_sergeant"),
      (overlay_set_text, "$g_presentation_obj_name_order_squire_plural", s11),
      (create_button_overlay, "$g_presentation_obj_name_kingdom_2", "@Continue...", 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 200),
      (overlay_set_position, "$g_presentation_obj_name_kingdom_2", pos1),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (try_begin),
        (eq, ":var0", "$g_presentation_obj_name_kingdom_1"),
        (str_store_string, s7, s0),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_name_order_knight"),
        (str_store_string, s8, s0),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_name_order_knight_plural"),
        (str_store_string, s10, s0),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_name_order_squire"),
        (str_store_string, s9, s0),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_name_order_squire_plural"),
        (str_store_string, s11, s0),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_name_kingdom_2"),
        (faction_set_name, "fac_player_knights", s7),
        (1501, "trp_player_knight", 8),
        (1501, "trp_player_knight_save", 8),
        (1502, "trp_player_knight", 10),
        (1502, "trp_player_knight_save", 10),
        (1501, "trp_player_sergeant", 9),
        (1501, "trp_player_sergeant_save", 9),
        (1502, "trp_player_sergeant", 11),
        (1502, "trp_player_sergeant_save", 11),
        (assign, "$players_order_name_set", 1),
        (1277, ":var1", "$players_kingdom"),
        (call_script, "script_randomize_color", ":var1"),
        (faction_set_color, "fac_player_knights", reg0),
        (presentation_set_duration, 0),
      (try_end),
    ]),
  ]),

  ("banner_selection", 0, mesh_load_window,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (str_store_string, s1, "str_banner_selection_text"),
      (create_text_overlay, reg1, s1, 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 670),
      (overlay_set_position, reg1, pos1),
      (overlay_set_text, reg1, s1),
      (str_clear, s0),
      (create_text_overlay, reg1, s0, 8192),
      (position_set_x, pos1, 50),
      (position_set_y, pos1, 50),
      (overlay_set_position, reg1, pos1),
      (position_set_x, pos1, 850),
      (position_set_y, pos1, 585),
      (overlay_set_area_size, reg1, pos1),
      (945, reg1),
      (assign, ":var0", "mesh_banner_f21"),
      (assign, ":var1", 6),
      (val_sub, ":var0", ":var1"),
      (store_sub, ":var2", ":var0", "mesh_banner_a01"),
      (store_div, ":var3", ":var2", 12),
      (store_mod, ":var4", ":var2", 12),
      (val_min, ":var4", 1),
      (val_add, ":var3", ":var4"),
      (store_mul, ":var5", ":var3", 150),
      (val_sub, ":var5", 15),
      (assign, ":var6", 40),
      (assign, "$g_cur_slot_no", 0),
      (try_for_range, ":var7", "mesh_banner_a01", ":var0"),
        (create_image_button_overlay, reg1, ":var7", ":var7"),
        (position_set_x, pos1, ":var6"),
        (position_set_y, pos1, ":var5"),
        (overlay_set_position, reg1, pos1),
        (position_set_x, pos1, 60),
        (position_set_y, pos1, 60),
        (overlay_set_size, reg1, pos1),
        (troop_set_slot, "trp_temp_array_a", "$g_cur_slot_no", reg1),
        (troop_set_slot, "trp_temp_array_b", "$g_cur_slot_no", ":var7"),
        (val_add, "$g_cur_slot_no", 1),
        (val_add, ":var6", 70),
        (ge, ":var6", 880),
        (assign, ":var6", 40),
        (val_sub, ":var5", 150),
      (try_end),
      (945, -1),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (try_begin),
        (eq, ":var0", "$g_presentation_obj_banner_selection_1"),
        (start_presentation, "prsnt_banner_selection"),
      (else_try),
        (troop_get_slot, ":var1", "trp_player", 13),
        (try_begin),
          (le, ":var1", 0),
          (assign, ":var1", "spr_banner_f21"),
          (assign, ":var2", "icon_banner_136"),
        (else_try),
          (store_sub, ":var2", ":var1", 100),
        (try_end),
        (assign, ":var3", ":var0"),
        (val_sub, ":var3", 2),
        (store_add, ":var4", ":var3", "icon_banner_01"),
        (party_set_banner_icon, "p_main_party", ":var4"),
        (store_add, ":var5", ":var3", "spr_banner_a"),
        (troop_set_slot, "trp_player", 13, ":var5"),
        (presentation_set_duration, 0),
        (assign, ":var6", 0),
        (assign, ":var7", "trp_knight_1_1_wife"),
        (try_for_range, ":var8", "trp_npc_adonja", ":var7"),
          (troop_slot_eq, ":var8", 13, ":var5"),
          (assign, ":var6", ":var8"),
          (assign, ":var7", 0),
          (troop_set_slot, ":var8", 13, ":var1"),
          (troop_get_slot, ":var9", ":var8", 10),
          (gt, ":var9", 0),
          (party_set_banner_icon, ":var9", ":var2"),
        (try_end),
        (try_for_range, ":var10", "p_town_1", "p_salt_mine"),
          (try_begin),
            (party_slot_eq, ":var10", 7, "trp_player"),
            (party_set_banner_icon, ":var10", ":var4"),
          (else_try),
            (party_slot_eq, ":var10", 7, ":var6"),
            (party_set_banner_icon, ":var10", ":var2"),
          (try_end),
        (try_end),
      (try_end),
    ]),
    (ti_on_presentation_run,
    [
      (try_begin),
        (this_or_next|key_clicked, key_space),
        (this_or_next|key_clicked, key_enter),
        (this_or_next|key_clicked, key_escape),
        (key_clicked, key_back_space),
        (presentation_set_duration, 0),
      (try_end),
    ]),
  ]),

  ("custom_banner", 0, mesh_load_window,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (troop_get_slot, ":var0", "trp_player", 96),
      (val_max, ":var0", 0),
      (val_add, ":var0", "mesh_custom_banner_01"),
      (troop_get_slot, ":var1", "trp_player", 99),
      (val_max, ":var1", 0),
      (val_add, ":var1", "mesh_custom_map_banner_01"),
      (troop_get_slot, ":var2", "trp_player", 85),
      (troop_get_slot, ":var3", "trp_player", 86),
      (create_text_overlay, reg1, "str_color_no_1", 0),
      (position_set_x, pos1, 40),
      (position_set_y, pos1, 550),
      (overlay_set_position, reg1, pos1),
      (create_text_overlay, reg1, "str_color_no_2", 0),
      (position_set_x, pos1, 40),
      (position_set_y, pos1, 500),
      (overlay_set_position, reg1, pos1),
      (create_image_button_overlay_with_tableau_material, "$g_presentation_obj_custom_banner_22", "mesh_color_picker", "tableau_color_picker", ":var2"),
      (create_image_button_overlay_with_tableau_material, "$g_presentation_obj_custom_banner_23", "mesh_color_picker", "tableau_color_picker", ":var3"),
      (position_set_x, pos1, 200),
      (position_set_y, pos1, 565),
      (overlay_set_position, "$g_presentation_obj_custom_banner_22", pos1),
      (position_set_y, pos1, 515),
      (overlay_set_position, "$g_presentation_obj_custom_banner_23", pos1),
      (position_set_x, pos1, 250),
      (position_set_y, pos1, 250),
      (overlay_set_size, "$g_presentation_obj_custom_banner_22", pos1),
      (overlay_set_size, "$g_presentation_obj_custom_banner_23", pos1),
      (create_button_overlay, "$g_presentation_obj_custom_banner_2", "str_change", 16),
      (create_button_overlay, "$g_presentation_obj_custom_banner_3", "str_change", 16),
      (create_button_overlay, "$g_presentation_obj_custom_banner_4", "str_change_background", 16),
      (create_button_overlay, "$g_presentation_obj_custom_banner_5", "str_change", 16),
      (create_button_overlay, "$g_presentation_obj_custom_banner_19", "str_change", 16),
      (create_button_overlay, "$g_presentation_obj_custom_banner_20", "str_accept", 16),
      (troop_get_slot, ":var4", "trp_player", 97),
      (create_button_overlay, "$g_presentation_obj_custom_banner_16", "str_randomize", 16),
      (create_image_button_overlay_with_tableau_material, "$g_presentation_obj_custom_banner_17", ":var0", "tableau_custom_banner_default", "trp_player"),
      (try_begin),
        (eq, ":var1", "mesh_custom_map_banner_01"),
        (create_image_button_overlay_with_tableau_material, "$g_presentation_obj_custom_banner_18", ":var1", "tableau_custom_banner_square", "trp_player"),
      (else_try),
        (eq, ":var1", "mesh_custom_map_banner_02"),
        (create_image_button_overlay_with_tableau_material, "$g_presentation_obj_custom_banner_18", ":var1", "tableau_custom_banner_short", "trp_player"),
      (else_try),
        (create_image_button_overlay_with_tableau_material, "$g_presentation_obj_custom_banner_18", ":var1", "tableau_custom_banner_tall", "trp_player"),
      (try_end),
      (create_image_button_overlay_with_tableau_material, "$g_presentation_obj_custom_banner_1", -1, "tableau_custom_banner_square_no_mesh", "trp_player"),
      (create_text_overlay, reg1, "str_sample_banner", 16),
      (position_set_x, pos1, 825),
      (position_set_y, pos1, 650),
      (overlay_set_position, reg1, pos1),
      (create_text_overlay, reg1, "str_sample_map_banner", 16),
      (position_set_y, pos1, 500),
      (overlay_set_position, reg1, pos1),
      (position_set_x, pos1, 800),
      (position_set_y, pos1, 640),
      (overlay_set_position, "$g_presentation_obj_custom_banner_17", pos1),
      (position_set_x, pos1, 780),
      (position_set_y, pos1, 315),
      (overlay_set_position, "$g_presentation_obj_custom_banner_18", pos1),
      (position_set_x, pos1, 50),
      (position_set_y, pos1, 50),
      (overlay_set_size, "$g_presentation_obj_custom_banner_17", pos1),
      (position_set_x, pos1, 50),
      (position_set_y, pos1, 50),
      (overlay_set_size, "$g_presentation_obj_custom_banner_18", pos1),
      (create_text_overlay, reg1, "str_number_of_charges", 0),
      (position_set_x, pos1, 40),
      (position_set_y, pos1, 350),
      (overlay_set_position, reg1, pos1),
      (assign, reg1, ":var4"),
      (create_text_overlay, reg2, "str_reg1", 16),
      (position_set_x, pos1, 350),
      (position_set_y, pos1, 350),
      (overlay_set_position, reg2, pos1),
      (try_begin),
        (lt, ":var4", 4),
        (create_button_overlay, "$g_presentation_obj_custom_banner_15", "str_plus", 16),
        (position_set_x, pos1, 385),
        (position_set_y, pos1, 350),
        (overlay_set_position, "$g_presentation_obj_custom_banner_15", pos1),
      (else_try),
        (assign, "$g_presentation_obj_custom_banner_15", -1),
      (try_end),
      (try_begin),
        (gt, ":var4", 0),
        (create_button_overlay, "$g_presentation_obj_custom_banner_21", "str_minus", 16),
        (position_set_x, pos1, 370),
        (position_set_y, pos1, 350),
        (overlay_set_position, "$g_presentation_obj_custom_banner_21", pos1),
      (else_try),
        (assign, "$g_presentation_obj_custom_banner_21", -1),
      (try_end),
      (try_begin),
        (ge, ":var4", 1),
        (create_text_overlay, reg1, "str_charge", 16),
        (position_set_x, pos1, 300),
        (position_set_y, pos1, 300),
        (overlay_set_position, reg1, pos1),
        (create_text_overlay, reg1, "str_color", 16),
        (position_set_x, pos1, 550),
        (position_set_y, pos1, 300),
        (overlay_set_position, reg1, pos1),
        (create_button_overlay, "$g_presentation_obj_custom_banner_14", "str_change_charge_position", 16),
        (position_set_y, pos1, 350),
        (position_set_x, pos1, 550),
        (overlay_set_position, "$g_presentation_obj_custom_banner_14", pos1),
        (create_text_overlay, reg1, "str_charge_no_1", 0),
        (position_set_x, pos1, 40),
        (position_set_y, pos1, 240),
        (overlay_set_position, reg1, pos1),
        (create_button_overlay, "$g_presentation_obj_custom_banner_6", "str_change", 0),
        (position_set_x, pos1, 310),
        (overlay_set_position, "$g_presentation_obj_custom_banner_6", pos1),
        (create_button_overlay, "$g_presentation_obj_custom_banner_7", "str_change", 0),
        (position_set_x, pos1, 560),
        (overlay_set_position, "$g_presentation_obj_custom_banner_7", pos1),
        (troop_get_slot, ":var5", "trp_player", 92),
        (val_mod, ":var5", 256),
        (val_add, ":var5", "mesh_custom_banner_charge_01"),
        (create_image_button_overlay, "$g_presentation_obj_custom_banner_24", ":var5", ":var5"),
        (position_set_x, pos1, 260),
        (position_set_y, pos1, 255),
        (overlay_set_position, "$g_presentation_obj_custom_banner_24", pos1),
        (position_set_x, pos1, 50),
        (position_set_y, pos1, 50),
        (overlay_set_size, "$g_presentation_obj_custom_banner_24", pos1),
        (troop_get_slot, ":var6", "trp_player", 87),
        (create_image_button_overlay_with_tableau_material, "$g_presentation_obj_custom_banner_28", "mesh_color_picker", "tableau_color_picker", ":var6"),
        (position_set_x, pos1, 530),
        (position_set_y, pos1, 255),
        (overlay_set_position, "$g_presentation_obj_custom_banner_28", pos1),
        (position_set_x, pos1, 250),
        (position_set_y, pos1, 250),
        (overlay_set_size, "$g_presentation_obj_custom_banner_28", pos1),
        (create_button_overlay, "$g_presentation_obj_custom_banner_32", "str_flip_horizontal", 0),
        (position_set_x, pos1, 700),
        (position_set_y, pos1, 240),
        (overlay_set_position, "$g_presentation_obj_custom_banner_32", pos1),
        (create_button_overlay, "$g_presentation_obj_custom_banner_33", "str_flip_vertical", 0),
        (position_set_x, pos1, 800),
        (overlay_set_position, "$g_presentation_obj_custom_banner_33", pos1),
      (try_end),
      (try_begin),
        (ge, ":var4", 2),
        (create_text_overlay, reg1, "str_charge_no_2", 0),
        (position_set_x, pos1, 40),
        (position_set_y, pos1, 180),
        (overlay_set_position, reg1, pos1),
        (create_button_overlay, "$g_presentation_obj_custom_banner_8", "str_change", 0),
        (position_set_x, pos1, 310),
        (overlay_set_position, "$g_presentation_obj_custom_banner_8", pos1),
        (create_button_overlay, "$g_presentation_obj_custom_banner_9", "str_change", 0),
        (position_set_x, pos1, 560),
        (overlay_set_position, "$g_presentation_obj_custom_banner_9", pos1),
        (troop_get_slot, ":var5", "trp_player", 93),
        (val_mod, ":var5", 256),
        (val_add, ":var5", "mesh_custom_banner_charge_01"),
        (create_image_button_overlay, "$g_presentation_obj_custom_banner_25", ":var5", ":var5"),
        (position_set_x, pos1, 260),
        (position_set_y, pos1, 195),
        (overlay_set_position, "$g_presentation_obj_custom_banner_25", pos1),
        (position_set_x, pos1, 50),
        (position_set_y, pos1, 50),
        (overlay_set_size, "$g_presentation_obj_custom_banner_25", pos1),
        (troop_get_slot, ":var6", "trp_player", 88),
        (create_image_button_overlay_with_tableau_material, "$g_presentation_obj_custom_banner_29", "mesh_color_picker", "tableau_color_picker", ":var6"),
        (position_set_x, pos1, 530),
        (position_set_y, pos1, 195),
        (overlay_set_position, "$g_presentation_obj_custom_banner_29", pos1),
        (position_set_x, pos1, 250),
        (position_set_y, pos1, 250),
        (overlay_set_size, "$g_presentation_obj_custom_banner_29", pos1),
        (create_button_overlay, "$g_presentation_obj_custom_banner_34", "str_flip_horizontal", 0),
        (position_set_x, pos1, 700),
        (position_set_y, pos1, 180),
        (overlay_set_position, "$g_presentation_obj_custom_banner_34", pos1),
        (create_button_overlay, "$g_presentation_obj_custom_banner_35", "str_flip_vertical", 0),
        (position_set_x, pos1, 800),
        (overlay_set_position, "$g_presentation_obj_custom_banner_35", pos1),
      (try_end),
      (try_begin),
        (ge, ":var4", 3),
        (create_text_overlay, reg1, "str_charge_no_3", 0),
        (position_set_x, pos1, 40),
        (position_set_y, pos1, 120),
        (overlay_set_position, reg1, pos1),
        (create_button_overlay, "$g_presentation_obj_custom_banner_10", "str_change", 0),
        (position_set_x, pos1, 310),
        (overlay_set_position, "$g_presentation_obj_custom_banner_10", pos1),
        (create_button_overlay, "$g_presentation_obj_custom_banner_11", "str_change", 0),
        (position_set_x, pos1, 560),
        (overlay_set_position, "$g_presentation_obj_custom_banner_11", pos1),
        (troop_get_slot, ":var5", "trp_player", 94),
        (val_mod, ":var5", 256),
        (val_add, ":var5", "mesh_custom_banner_charge_01"),
        (create_image_button_overlay, "$g_presentation_obj_custom_banner_26", ":var5", ":var5"),
        (position_set_x, pos1, 260),
        (position_set_y, pos1, 135),
        (overlay_set_position, "$g_presentation_obj_custom_banner_26", pos1),
        (position_set_x, pos1, 50),
        (position_set_y, pos1, 50),
        (overlay_set_size, "$g_presentation_obj_custom_banner_26", pos1),
        (troop_get_slot, ":var6", "trp_player", 89),
        (create_image_button_overlay_with_tableau_material, "$g_presentation_obj_custom_banner_30", "mesh_color_picker", "tableau_color_picker", ":var6"),
        (position_set_x, pos1, 530),
        (position_set_y, pos1, 135),
        (overlay_set_position, "$g_presentation_obj_custom_banner_30", pos1),
        (position_set_x, pos1, 250),
        (position_set_y, pos1, 250),
        (overlay_set_size, "$g_presentation_obj_custom_banner_30", pos1),
        (create_button_overlay, "$g_presentation_obj_custom_banner_36", "str_flip_horizontal", 0),
        (position_set_x, pos1, 700),
        (position_set_y, pos1, 120),
        (overlay_set_position, "$g_presentation_obj_custom_banner_36", pos1),
        (create_button_overlay, "$g_presentation_obj_custom_banner_37", "str_flip_vertical", 0),
        (position_set_x, pos1, 800),
        (overlay_set_position, "$g_presentation_obj_custom_banner_37", pos1),
      (try_end),
      (try_begin),
        (ge, ":var4", 4),
        (create_text_overlay, reg1, "str_charge_no_4", 0),
        (position_set_x, pos1, 40),
        (position_set_y, pos1, 60),
        (overlay_set_position, reg1, pos1),
        (create_button_overlay, "$g_presentation_obj_custom_banner_12", "str_change", 0),
        (position_set_x, pos1, 310),
        (overlay_set_position, "$g_presentation_obj_custom_banner_12", pos1),
        (create_button_overlay, "$g_presentation_obj_custom_banner_13", "str_change", 0),
        (position_set_x, pos1, 560),
        (overlay_set_position, "$g_presentation_obj_custom_banner_13", pos1),
        (troop_get_slot, ":var5", "trp_player", 95),
        (val_mod, ":var5", 256),
        (val_add, ":var5", "mesh_custom_banner_charge_01"),
        (create_image_button_overlay, "$g_presentation_obj_custom_banner_27", ":var5", ":var5"),
        (position_set_x, pos1, 260),
        (position_set_y, pos1, 75),
        (overlay_set_position, "$g_presentation_obj_custom_banner_27", pos1),
        (position_set_x, pos1, 50),
        (position_set_y, pos1, 50),
        (overlay_set_size, "$g_presentation_obj_custom_banner_27", pos1),
        (troop_get_slot, ":var6", "trp_player", 90),
        (create_image_button_overlay_with_tableau_material, "$g_presentation_obj_custom_banner_31", "mesh_color_picker", "tableau_color_picker", ":var6"),
        (position_set_x, pos1, 530),
        (position_set_y, pos1, 75),
        (overlay_set_position, "$g_presentation_obj_custom_banner_31", pos1),
        (position_set_x, pos1, 250),
        (position_set_y, pos1, 250),
        (overlay_set_size, "$g_presentation_obj_custom_banner_31", pos1),
        (create_button_overlay, "$g_presentation_obj_custom_banner_38", "str_flip_horizontal", 0),
        (position_set_x, pos1, 700),
        (position_set_y, pos1, 60),
        (overlay_set_position, "$g_presentation_obj_custom_banner_38", pos1),
        (create_button_overlay, "$g_presentation_obj_custom_banner_39", "str_flip_vertical", 0),
        (position_set_x, pos1, 800),
        (overlay_set_position, "$g_presentation_obj_custom_banner_39", pos1),
      (try_end),
      (position_set_x, pos1, 350),
      (position_set_y, pos1, 400),
      (overlay_set_position, "$g_presentation_obj_custom_banner_1", pos1),
      (position_set_x, pos1, 275),
      (position_set_y, pos1, 550),
      (overlay_set_position, "$g_presentation_obj_custom_banner_2", pos1),
      (position_set_y, pos1, 500),
      (overlay_set_position, "$g_presentation_obj_custom_banner_3", pos1),
      (position_set_x, pos1, 175),
      (position_set_y, pos1, 600),
      (overlay_set_position, "$g_presentation_obj_custom_banner_4", pos1),
      (position_set_x, pos1, 880),
      (position_set_y, pos1, 575),
      (overlay_set_position, "$g_presentation_obj_custom_banner_5", pos1),
      (position_set_y, pos1, 400),
      (overlay_set_position, "$g_presentation_obj_custom_banner_19", pos1),
      (position_set_y, pos1, 650),
      (position_set_x, pos1, 175),
      (overlay_set_position, "$g_presentation_obj_custom_banner_16", pos1),
      (position_set_y, pos1, 150),
      (position_set_x, pos1, 850),
      (overlay_set_position, "$g_presentation_obj_custom_banner_20", pos1),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (troop_get_slot, ":var1", "trp_player", 97),
      (try_begin),
        (this_or_next|eq, ":var0", "$g_presentation_obj_custom_banner_2"),
        (eq, ":var0", "$g_presentation_obj_custom_banner_22"),
        (assign, "$g_presentation_next_presentation", "prsnt_custom_banner"),
        (assign, "$g_presentation_output_slot", 85),
        (start_presentation, "prsnt_color_selection"),
      (else_try),
        (this_or_next|eq, ":var0", "$g_presentation_obj_custom_banner_3"),
        (eq, ":var0", "$g_presentation_obj_custom_banner_23"),
        (assign, "$g_presentation_next_presentation", "prsnt_custom_banner"),
        (assign, "$g_presentation_output_slot", 86),
        (start_presentation, "prsnt_color_selection"),
      (else_try),
        (this_or_next|eq, ":var0", "$g_presentation_obj_custom_banner_4"),
        (eq, ":var0", "$g_presentation_obj_custom_banner_1"),
        (assign, "$g_presentation_next_presentation", "prsnt_custom_banner"),
        (start_presentation, "prsnt_banner_background_selection"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_custom_banner_5"),
        (assign, "$g_presentation_next_presentation", "prsnt_custom_banner"),
        (start_presentation, "prsnt_banner_flag_type_selection"),
      (else_try),
        (ge, ":var1", 1),
        (this_or_next|eq, ":var0", "$g_presentation_obj_custom_banner_6"),
        (eq, ":var0", "$g_presentation_obj_custom_banner_24"),
        (assign, "$g_presentation_next_presentation", "prsnt_custom_banner"),
        (assign, "$g_presentation_output_slot", 92),
        (start_presentation, "prsnt_banner_charge_selection"),
      (else_try),
        (ge, ":var1", 1),
        (this_or_next|eq, ":var0", "$g_presentation_obj_custom_banner_7"),
        (eq, ":var0", "$g_presentation_obj_custom_banner_28"),
        (assign, "$g_presentation_next_presentation", "prsnt_custom_banner"),
        (assign, "$g_presentation_output_slot", 87),
        (start_presentation, "prsnt_color_selection"),
      (else_try),
        (ge, ":var1", 2),
        (this_or_next|eq, ":var0", "$g_presentation_obj_custom_banner_8"),
        (eq, ":var0", "$g_presentation_obj_custom_banner_25"),
        (assign, "$g_presentation_next_presentation", "prsnt_custom_banner"),
        (assign, "$g_presentation_output_slot", 93),
        (start_presentation, "prsnt_banner_charge_selection"),
      (else_try),
        (ge, ":var1", 2),
        (this_or_next|eq, ":var0", "$g_presentation_obj_custom_banner_9"),
        (eq, ":var0", "$g_presentation_obj_custom_banner_29"),
        (assign, "$g_presentation_next_presentation", "prsnt_custom_banner"),
        (assign, "$g_presentation_output_slot", 88),
        (start_presentation, "prsnt_color_selection"),
      (else_try),
        (ge, ":var1", 3),
        (this_or_next|eq, ":var0", "$g_presentation_obj_custom_banner_10"),
        (eq, ":var0", "$g_presentation_obj_custom_banner_26"),
        (assign, "$g_presentation_next_presentation", "prsnt_custom_banner"),
        (assign, "$g_presentation_output_slot", 94),
        (start_presentation, "prsnt_banner_charge_selection"),
      (else_try),
        (ge, ":var1", 3),
        (this_or_next|eq, ":var0", "$g_presentation_obj_custom_banner_11"),
        (eq, ":var0", "$g_presentation_obj_custom_banner_30"),
        (assign, "$g_presentation_next_presentation", "prsnt_custom_banner"),
        (assign, "$g_presentation_output_slot", 89),
        (start_presentation, "prsnt_color_selection"),
      (else_try),
        (ge, ":var1", 4),
        (this_or_next|eq, ":var0", "$g_presentation_obj_custom_banner_12"),
        (eq, ":var0", "$g_presentation_obj_custom_banner_27"),
        (assign, "$g_presentation_next_presentation", "prsnt_custom_banner"),
        (assign, "$g_presentation_output_slot", 95),
        (start_presentation, "prsnt_banner_charge_selection"),
      (else_try),
        (ge, ":var1", 4),
        (this_or_next|eq, ":var0", "$g_presentation_obj_custom_banner_13"),
        (eq, ":var0", "$g_presentation_obj_custom_banner_31"),
        (assign, "$g_presentation_next_presentation", "prsnt_custom_banner"),
        (assign, "$g_presentation_output_slot", 90),
        (start_presentation, "prsnt_color_selection"),
      (else_try),
        (ge, ":var1", 1),
        (eq, ":var0", "$g_presentation_obj_custom_banner_14"),
        (assign, "$g_presentation_next_presentation", "prsnt_custom_banner"),
        (start_presentation, "prsnt_banner_charge_positioning"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_custom_banner_15"),
        (troop_get_slot, ":var1", "trp_player", 97),
        (val_add, ":var1", 1),
        (val_clamp, ":var1", 0, 5),
        (troop_set_slot, "trp_player", 97, ":var1"),
        (start_presentation, "prsnt_custom_banner"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_custom_banner_21"),
        (troop_get_slot, ":var1", "trp_player", 97),
        (val_sub, ":var1", 1),
        (val_clamp, ":var1", 0, 5),
        (troop_set_slot, "trp_player", 97, ":var1"),
        (start_presentation, "prsnt_custom_banner"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_custom_banner_16"),
        (call_script, "script_get_random_custom_banner", "trp_player"),
        (start_presentation, "prsnt_custom_banner"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_custom_banner_17"),
        (assign, "$g_presentation_next_presentation", "prsnt_custom_banner"),
        (start_presentation, "prsnt_banner_flag_type_selection"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_custom_banner_18"),
        (assign, "$g_presentation_next_presentation", "prsnt_custom_banner"),
        (start_presentation, "prsnt_banner_flag_map_type_selection"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_custom_banner_19"),
        (assign, "$g_presentation_next_presentation", "prsnt_custom_banner"),
        (start_presentation, "prsnt_banner_flag_map_type_selection"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_custom_banner_32"),
        (troop_get_slot, ":var2", "trp_player", 92),
        (store_mod, ":var3", ":var2", 256),
        (val_div, ":var2", 256),
        (store_mod, ":var4", ":var2", 2),
        (val_div, ":var2", 2),
        (val_add, ":var4", 1),
        (val_mod, ":var4", 2),
        (val_mul, ":var2", 2),
        (val_add, ":var2", ":var4"),
        (val_mul, ":var2", 256),
        (val_add, ":var2", ":var3"),
        (troop_set_slot, "trp_player", 92, ":var2"),
        (start_presentation, "prsnt_custom_banner"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_custom_banner_34"),
        (troop_get_slot, ":var2", "trp_player", 93),
        (store_mod, ":var3", ":var2", 256),
        (val_div, ":var2", 256),
        (store_mod, ":var4", ":var2", 2),
        (val_div, ":var2", 2),
        (val_add, ":var4", 1),
        (val_mod, ":var4", 2),
        (val_mul, ":var2", 2),
        (val_add, ":var2", ":var4"),
        (val_mul, ":var2", 256),
        (val_add, ":var2", ":var3"),
        (troop_set_slot, "trp_player", 93, ":var2"),
        (start_presentation, "prsnt_custom_banner"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_custom_banner_36"),
        (troop_get_slot, ":var2", "trp_player", 94),
        (store_mod, ":var3", ":var2", 256),
        (val_div, ":var2", 256),
        (store_mod, ":var4", ":var2", 2),
        (val_div, ":var2", 2),
        (val_add, ":var4", 1),
        (val_mod, ":var4", 2),
        (val_mul, ":var2", 2),
        (val_add, ":var2", ":var4"),
        (val_mul, ":var2", 256),
        (val_add, ":var2", ":var3"),
        (troop_set_slot, "trp_player", 94, ":var2"),
        (start_presentation, "prsnt_custom_banner"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_custom_banner_38"),
        (troop_get_slot, ":var2", "trp_player", 95),
        (store_mod, ":var3", ":var2", 256),
        (val_div, ":var2", 256),
        (store_mod, ":var4", ":var2", 2),
        (val_div, ":var2", 2),
        (val_add, ":var4", 1),
        (val_mod, ":var4", 2),
        (val_mul, ":var2", 2),
        (val_add, ":var2", ":var4"),
        (val_mul, ":var2", 256),
        (val_add, ":var2", ":var3"),
        (troop_set_slot, "trp_player", 95, ":var2"),
        (start_presentation, "prsnt_custom_banner"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_custom_banner_33"),
        (troop_get_slot, ":var2", "trp_player", 92),
        (store_div, ":var4", ":var2", 512),
        (val_add, ":var4", 1),
        (val_mod, ":var4", 2),
        (val_mul, ":var4", 512),
        (val_mod, ":var2", 512),
        (val_add, ":var2", ":var4"),
        (troop_set_slot, "trp_player", 92, ":var2"),
        (start_presentation, "prsnt_custom_banner"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_custom_banner_35"),
        (troop_get_slot, ":var2", "trp_player", 93),
        (store_div, ":var4", ":var2", 512),
        (val_add, ":var4", 1),
        (val_mod, ":var4", 2),
        (val_mul, ":var4", 512),
        (val_mod, ":var2", 512),
        (val_add, ":var2", ":var4"),
        (troop_set_slot, "trp_player", 93, ":var2"),
        (start_presentation, "prsnt_custom_banner"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_custom_banner_37"),
        (troop_get_slot, ":var2", "trp_player", 94),
        (store_div, ":var4", ":var2", 512),
        (val_add, ":var4", 1),
        (val_mod, ":var4", 2),
        (val_mul, ":var4", 512),
        (val_mod, ":var2", 512),
        (val_add, ":var2", ":var4"),
        (troop_set_slot, "trp_player", 94, ":var2"),
        (start_presentation, "prsnt_custom_banner"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_custom_banner_39"),
        (troop_get_slot, ":var2", "trp_player", 95),
        (store_div, ":var4", ":var2", 512),
        (val_add, ":var4", 1),
        (val_mod, ":var4", 2),
        (val_mul, ":var4", 512),
        (val_mod, ":var2", 512),
        (val_add, ":var2", ":var4"),
        (troop_set_slot, "trp_player", 95, ":var2"),
        (start_presentation, "prsnt_custom_banner"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_custom_banner_20"),
        (troop_get_slot, ":var5", "trp_player", 99),
        (try_begin),
          (ge, ":var5", 0),
          (val_add, ":var5", "icon_custom_banner_01"),
          (party_set_banner_icon, "p_main_party", ":var5"),
        (try_end),
        (presentation_set_duration, 0),
      (try_end),
    ]),
  ]),

  ("banner_charge_positioning", 0, mesh_load_window,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (create_text_overlay, reg1, "str_choose_position", 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 600),
      (overlay_set_position, reg1, pos1),
      (assign, ":var0", 125),
      (assign, ":var1", 400),
      (call_script, "script_get_troop_custom_banner_num_positionings", "trp_player"),
      (assign, ":var2", reg0),
      (store_mul, ":var3", ":var2", 125),
      (val_sub, ":var3", 25),
      (store_div, ":var0", ":var3", 2),
      (store_sub, ":var0", 500, ":var0"),
      (try_for_range, ":var4", 0, ":var2"),
        (create_image_button_overlay_with_tableau_material, reg1, -1, "tableau_positioning_selection", ":var4"),
        (position_set_x, pos1, ":var0"),
        (position_set_y, pos1, ":var1"),
        (val_add, ":var0", 125),
        (overlay_set_position, reg1, pos1),
        (troop_set_slot, "trp_temp_array_a", ":var4", reg1),
      (try_end),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (call_script, "script_get_troop_custom_banner_num_positionings", "trp_player"),
      (assign, ":var1", reg0),
      (try_for_range, ":var2", 0, ":var1"),
        (troop_slot_eq, "trp_temp_array_a", ":var2", ":var0"),
        (troop_set_slot, "trp_player", 98, ":var2"),
        (assign, ":var1", 0),
      (try_end),
      (try_begin),
        (gt, "$g_presentation_next_presentation", 0),
        (start_presentation, "$g_presentation_next_presentation"),
      (else_try),
        (presentation_set_duration, 0),
      (try_end),
    ]),
  ]),

  ("banner_charge_selection", 0, mesh_load_window,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (create_text_overlay, reg1, "str_choose_charge", 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 650),
      (overlay_set_position, reg1, pos1),
      (assign, ":var0", 100),
      (assign, ":var1", 600),
      (try_for_range, ":var2", "mesh_custom_banner_charge_01", "mesh_tableau_mesh_custom_banner"),
        (create_image_button_overlay, reg1, ":var2", ":var2"),
        (position_set_x, pos1, ":var0"),
        (position_set_y, pos1, ":var1"),
        (val_add, ":var0", 100),
        (try_begin),
          (gt, ":var0", 900),
          (assign, ":var0", 100),
          (val_sub, ":var1", 100),
        (try_end),
        (overlay_set_position, reg1, pos1),
        (position_set_x, pos1, 80),
        (position_set_y, pos1, 80),
        (overlay_set_size, reg1, pos1),
        (store_sub, ":var3", ":var2", "mesh_custom_banner_charge_01"),
        (troop_set_slot, "trp_temp_array_a", ":var3", reg1),
      (try_end),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (assign, ":var1", "mesh_tableau_mesh_custom_banner"),
      (val_sub, ":var1", "mesh_custom_banner_charge_01"),
      (try_for_range, ":var2", 0, ":var1"),
        (troop_slot_eq, "trp_temp_array_a", ":var2", ":var0"),
        (troop_set_slot, "trp_player", "$g_presentation_output_slot", ":var2"),
        (assign, ":var1", 0),
      (try_end),
      (try_begin),
        (gt, "$g_presentation_next_presentation", 0),
        (start_presentation, "$g_presentation_next_presentation"),
      (else_try),
        (presentation_set_duration, 0),
      (try_end),
    ]),
  ]),

  ("banner_background_selection", 0, mesh_load_window,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (create_text_overlay, reg1, "str_choose_background", 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 600),
      (overlay_set_position, reg1, pos1),
      (assign, ":var0", 75),
      (assign, ":var1", 450),
      (try_for_range, ":var2", "mesh_custom_banner_bg", "mesh_custom_banner_charge_01"),
        (store_sub, ":var3", ":var2", "mesh_custom_banner_bg"),
        (create_image_button_overlay_with_tableau_material, reg1, -1, "tableau_background_selection", ":var3"),
        (position_set_x, pos1, ":var0"),
        (position_set_y, pos1, ":var1"),
        (val_add, ":var0", 125),
        (try_begin),
          (gt, ":var0", 900),
          (assign, ":var0", 75),
          (val_sub, ":var1", 125),
        (try_end),
        (overlay_set_position, reg1, pos1),
        (troop_set_slot, "trp_temp_array_a", ":var3", reg1),
      (try_end),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (assign, ":var1", "mesh_custom_banner_charge_01"),
      (val_sub, ":var1", "mesh_custom_banner_bg"),
      (try_for_range, ":var2", 0, ":var1"),
        (troop_slot_eq, "trp_temp_array_a", ":var2", ":var0"),
        (troop_set_slot, "trp_player", 91, ":var2"),
        (assign, ":var1", 0),
      (try_end),
      (try_begin),
        (gt, "$g_presentation_next_presentation", 0),
        (start_presentation, "$g_presentation_next_presentation"),
      (else_try),
        (presentation_set_duration, 0),
      (try_end),
    ]),
  ]),

  ("banner_flag_type_selection", 0, mesh_load_window,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (create_text_overlay, reg1, "str_choose_flag_type", 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 600),
      (overlay_set_position, reg1, pos1),
      (assign, ":var0", 435),
      (assign, ":var1", 450),
      (try_for_range, ":var2", "mesh_custom_banner_01", "mesh_custom_banner_bg"),
        (store_sub, ":var3", ":var2", "mesh_custom_banner_01"),
        (troop_set_slot, "trp_player", 96, ":var3"),
        (create_image_button_overlay_with_tableau_material, reg1, ":var2", "tableau_custom_banner_default", "trp_player"),
        (position_set_x, pos1, ":var0"),
        (position_set_y, pos1, ":var1"),
        (val_add, ":var0", 130),
        (overlay_set_position, reg1, pos1),
        (position_set_x, pos1, 100),
        (position_set_y, pos1, 100),
        (overlay_set_size, reg1, pos1),
        (troop_set_slot, "trp_temp_array_a", ":var3", reg1),
      (try_end),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (assign, ":var1", "mesh_custom_banner_bg"),
      (val_sub, ":var1", "mesh_custom_banner_01"),
      (try_for_range, ":var2", 0, ":var1"),
        (troop_slot_eq, "trp_temp_array_a", ":var2", ":var0"),
        (troop_set_slot, "trp_player", 96, ":var2"),
        (assign, ":var1", 0),
      (try_end),
      (try_begin),
        (gt, "$g_presentation_next_presentation", 0),
        (start_presentation, "$g_presentation_next_presentation"),
      (else_try),
        (presentation_set_duration, 0),
      (try_end),
    ]),
  ]),

  ("banner_flag_map_type_selection", 0, mesh_load_window,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (create_text_overlay, reg1, "str_choose_map_flag_type", 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 600),
      (overlay_set_position, reg1, pos1),
      (troop_get_slot, ":var0", "trp_player", 91),
      (val_add, ":var0", "mesh_custom_banner_bg"),
      (assign, ":var1", 250),
      (assign, ":var2", 150),
      (try_for_range, ":var3", "mesh_custom_map_banner_01", "mesh_custom_banner_01"),
        (store_sub, ":var4", ":var3", "mesh_custom_map_banner_01"),
        (troop_set_slot, "trp_player", 99, ":var4"),
        (try_begin),
          (eq, ":var3", "mesh_custom_map_banner_01"),
          (create_image_button_overlay_with_tableau_material, reg1, ":var3", "tableau_custom_banner_square", "trp_player"),
        (else_try),
          (eq, ":var3", "mesh_custom_map_banner_02"),
          (create_image_button_overlay_with_tableau_material, reg1, ":var3", "tableau_custom_banner_short", "trp_player"),
        (else_try),
          (create_image_button_overlay_with_tableau_material, reg1, ":var3", "tableau_custom_banner_tall", "trp_player"),
        (try_end),
        (position_set_x, pos1, ":var1"),
        (position_set_y, pos1, ":var2"),
        (val_add, ":var1", 200),
        (overlay_set_position, reg1, pos1),
        (position_set_x, pos1, 100),
        (position_set_y, pos1, 100),
        (overlay_set_size, reg1, pos1),
        (troop_set_slot, "trp_temp_array_a", ":var4", reg1),
      (try_end),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (assign, ":var1", "mesh_custom_banner_01"),
      (val_sub, ":var1", "mesh_custom_map_banner_01"),
      (try_for_range, ":var2", 0, ":var1"),
        (troop_slot_eq, "trp_temp_array_a", ":var2", ":var0"),
        (troop_set_slot, "trp_player", 99, ":var2"),
        (assign, ":var1", 0),
      (try_end),
      (try_begin),
        (gt, "$g_presentation_next_presentation", 0),
        (start_presentation, "$g_presentation_next_presentation"),
      (else_try),
        (presentation_set_duration, 0),
      (try_end),
    ]),
  ]),

  ("color_selection", 0, mesh_load_window,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (create_text_overlay, reg1, "str_choose_color", 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 600),
      (overlay_set_position, reg1, pos1),
      (assign, ":var0", 125),
      (assign, ":var1", 450),
      (try_for_range, ":var2", 0, 42),
        (call_script, "script_get_custom_banner_color_from_index", ":var2"),
        (assign, ":var3", reg0),
        (create_image_button_overlay_with_tableau_material, reg1, "mesh_color_picker", "tableau_color_picker", ":var3"),
        (position_set_x, pos1, ":var0"),
        (position_set_y, pos1, ":var1"),
        (val_add, ":var0", 50),
        (try_begin),
          (store_mod, ":var4", ":var2", 7),
          (eq, ":var4", 6),
          (assign, ":var0", 125),
          (val_sub, ":var1", 50),
        (try_end),
        (overlay_set_position, reg1, pos1),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, 500),
        (overlay_set_size, reg1, pos1),
        (store_mul, ":var5", ":var2", 2),
        (store_add, ":var6", ":var5", 1),
        (troop_set_slot, "trp_temp_array_a", ":var5", reg1),
        (troop_set_slot, "trp_temp_array_a", ":var6", ":var3"),
      (try_end),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (assign, ":var1", 64),
      (try_for_range, ":var2", 0, ":var1"),
        (store_mul, ":var3", ":var2", 2),
        (troop_slot_eq, "trp_temp_array_a", ":var3", ":var0"),
        (store_add, ":var4", ":var3", 1),
        (troop_get_slot, ":var5", "trp_temp_array_a", ":var4"),
        (troop_set_slot, "trp_player", "$g_presentation_output_slot", ":var5"),
        (assign, ":var1", 0),
      (try_end),
      (try_begin),
        (gt, "$g_presentation_next_presentation", 0),
        (start_presentation, "$g_presentation_next_presentation"),
      (else_try),
        (presentation_set_duration, 0),
      (try_end),
    ]),
  ]),

  ("marshall_selection", 0, mesh_load_window,
  [
    (ti_on_presentation_load,
    [
      (assign, "$g_presentation_obj_marshall_selection_1", -1),
      (assign, "$g_presentation_obj_marshall_selection_2", -1),
      (assign, "$g_presentation_obj_marshall_selection_3", -1),
      (set_fixed_point_multiplier, 1000),
      (assign, "$g_presentation_next_presentation", -1),
      (store_add, ":var0", "$g_presentation_marshall_selection_max_renown_1", "$g_presentation_marshall_selection_max_renown_2"),
      (faction_get_slot, ":var1", "$players_kingdom", 11),
      (str_store_troop_name, s1, "$g_presentation_marshall_selection_max_renown_1_troop"),
      (create_text_overlay, reg1, "@Candidate #1: {s1}", 16),
      (position_set_x, pos1, 200),
      (position_set_y, pos1, 600),
      (overlay_set_position, reg1, pos1),
      (str_store_troop_name, s1, "$g_presentation_marshall_selection_max_renown_2_troop"),
      (create_text_overlay, reg1, "@Candidate #2: {s1}", 16),
      (position_set_x, pos1, 800),
      (position_set_y, pos1, 600),
      (overlay_set_position, reg1, pos1),
      (create_mesh_overlay_with_tableau_material, reg1, -1, "tableau_troop_note_mesh", "$g_presentation_marshall_selection_max_renown_1_troop"),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 500),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 100),
      (position_set_y, pos1, 300),
      (overlay_set_position, reg1, pos1),
      (create_mesh_overlay_with_tableau_material, reg1, -1, "tableau_troop_note_mesh", "$g_presentation_marshall_selection_max_renown_2_troop"),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 500),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 700),
      (position_set_y, pos1, 300),
      (overlay_set_position, reg1, pos1),
      (assign, ":var2", "$g_presentation_input"),
      (val_add, "$g_presentation_input", 1),
      (try_begin),
        (lt, ":var2", 0),
        (str_store_troop_name, s1, "$g_presentation_marshall_selection_max_renown_1_troop"),
        (str_store_troop_name, s2, "$g_presentation_marshall_selection_max_renown_2_troop"),
        (str_store_troop_name, s3, ":var1"),
        (str_store_faction_name, s4, "$players_kingdom"),
        (create_text_overlay, reg1, "@{s3} of {s4} wishes to select a new marshall and invites his vassals for a counsel. {s1} and {s2} are the likely candidates.", 16),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, 200),
        (overlay_set_position, reg1, pos1),
        (create_button_overlay, "$g_presentation_obj_marshall_selection_1", "@Continue...", 16),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, 100),
        (overlay_set_position, "$g_presentation_obj_marshall_selection_1", pos1),
        (assign, "$g_presentation_next_presentation", "prsnt_marshall_selection"),
      (else_try),
        (assign, ":var3", ":var2"),
        (try_for_range_backwards, ":var4", "trp_kingdom_heroes_including_player_begin", "trp_knight_1_1_wife"),
          (ge, ":var3", 0),
          (assign, ":var5", ":var4"),
          (assign, ":var6", 0),
          (try_begin),
            (eq, ":var4", "trp_kingdom_heroes_including_player_begin"),
            (assign, ":var5", "trp_player"),
            (try_begin),
              (eq, "$g_player_is_captive", 0),
              (assign, ":var6", 1),
            (try_end),
          (else_try),
            (store_troop_faction, ":var7", ":var5"),
            (eq, "$players_kingdom", ":var7"),
            (neg|troop_slot_ge, ":var5", 8, 0),
            (troop_slot_ge, ":var5", 10, 1),
            (troop_slot_eq, ":var5", 2, 2),
            (neg|faction_slot_eq, ":var7", 11, ":var5"),
            (assign, ":var6", 1),
          (try_end),
          (eq, ":var6", 1),
          (neq, "$g_presentation_marshall_selection_max_renown_1_troop", ":var5"),
          (neq, "$g_presentation_marshall_selection_max_renown_2_troop", ":var5"),
          (val_sub, ":var3", 1),
          (lt, ":var3", 0),
          (assign, "$g_presentation_next_presentation", "prsnt_marshall_selection"),
          (create_mesh_overlay_with_tableau_material, reg1, -1, "tableau_troop_note_mesh", ":var5"),
          (position_set_x, pos1, 300),
          (position_set_y, pos1, 300),
          (overlay_set_size, reg1, pos1),
          (position_set_x, pos1, 440),
          (position_set_y, pos1, 400),
          (overlay_set_position, reg1, pos1),
          (try_begin),
            (eq, ":var5", "trp_player"),
            (create_text_overlay, reg1, "@Who do you wish to support?", 16),
            (position_set_x, pos1, 500),
            (position_set_y, pos1, 200),
            (overlay_set_position, reg1, pos1),
            (str_store_troop_name, s1, "$g_presentation_marshall_selection_max_renown_1_troop"),
            (create_button_overlay, "$g_presentation_obj_marshall_selection_2", "@{!}{s1}", 16),
            (position_set_x, pos1, 300),
            (position_set_y, pos1, 100),
            (overlay_set_position, "$g_presentation_obj_marshall_selection_2", pos1),
            (str_store_troop_name, s1, "$g_presentation_marshall_selection_max_renown_2_troop"),
            (create_button_overlay, "$g_presentation_obj_marshall_selection_3", "@{!}{s1}", 16),
            (position_set_x, pos1, 700),
            (position_set_y, pos1, 100),
            (overlay_set_position, "$g_presentation_obj_marshall_selection_3", pos1),
          (else_try),
            (str_store_troop_name, s1, ":var5"),
            (store_random_in_range, ":var8", 0, ":var0"),
            (val_sub, ":var8", "$g_presentation_marshall_selection_max_renown_1"),
            (try_begin),
              (lt, ":var8", 0),
              (val_add, "$g_presentation_marshall_selection_1_vote", 1),
              (str_store_troop_name, s2, "$g_presentation_marshall_selection_max_renown_1_troop"),
            (else_try),
              (val_add, "$g_presentation_marshall_selection_2_vote", 1),
              (str_store_troop_name, s2, "$g_presentation_marshall_selection_max_renown_2_troop"),
            (try_end),
            (create_text_overlay, reg1, "@{s1} gives his support to {s2}.", 16),
            (position_set_x, pos1, 500),
            (position_set_y, pos1, 200),
            (overlay_set_position, reg1, pos1),
            (create_button_overlay, "$g_presentation_obj_marshall_selection_1", "@Continue...", 16),
            (position_set_x, pos1, 500),
            (position_set_y, pos1, 100),
            (overlay_set_position, "$g_presentation_obj_marshall_selection_1", pos1),
          (try_end),
        (try_end),
      (try_end),
      (assign, reg0, "$g_presentation_marshall_selection_1_vote"),
      (create_text_overlay, reg1, "@Number of Supporters: {reg0}", 16),
      (position_set_x, pos1, 200),
      (position_set_y, pos1, 550),
      (overlay_set_position, reg1, pos1),
      (assign, reg0, "$g_presentation_marshall_selection_2_vote"),
      (create_text_overlay, reg1, "@Number of Supporters: {reg0}", 16),
      (position_set_x, pos1, 800),
      (position_set_y, pos1, 550),
      (overlay_set_position, reg1, pos1),
      (try_begin),
        (lt, "$g_presentation_next_presentation", 0),
        (try_begin),
          (gt, "$g_presentation_marshall_selection_2_vote", "$g_presentation_marshall_selection_1_vote"),
          (assign, ":var9", "$g_presentation_marshall_selection_max_renown_1_troop"),
          (assign, "$g_presentation_marshall_selection_max_renown_1_troop", "$g_presentation_marshall_selection_max_renown_2_troop"),
          (assign, "$g_presentation_marshall_selection_max_renown_2_troop", ":var9"),
        (try_end),
        (str_store_troop_name, s1, "$g_presentation_marshall_selection_max_renown_1_troop"),
        (str_store_troop_name, s2, ":var1"),
        (str_store_faction_name, s3, "$players_kingdom"),
        (create_text_overlay, reg1, "@{s2} has heard his vassals' counsel. He selects {s1} as the marshall of {s3}.", 16),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, 200),
        (overlay_set_position, reg1, pos1),
        (create_button_overlay, "$g_presentation_obj_marshall_selection_1", "@Continue...", 16),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, 100),
        (overlay_set_position, "$g_presentation_obj_marshall_selection_1", pos1),
      (try_end),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (try_begin),
        (eq, ":var0", "$g_presentation_obj_marshall_selection_2"),
        (val_add, "$g_presentation_marshall_selection_1_vote", 1),
        (call_script, "script_change_player_relation_with_troop", "$g_presentation_marshall_selection_max_renown_1_troop", 2),
        (call_script, "script_change_player_relation_with_troop", "$g_presentation_marshall_selection_max_renown_2_troop", -2),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_marshall_selection_3"),
        (val_add, "$g_presentation_marshall_selection_2_vote", 1),
        (call_script, "script_change_player_relation_with_troop", "$g_presentation_marshall_selection_max_renown_1_troop", -2),
        (call_script, "script_change_player_relation_with_troop", "$g_presentation_marshall_selection_max_renown_2_troop", 2),
      (try_end),
      (try_begin),
        (this_or_next|eq, ":var0", "$g_presentation_obj_marshall_selection_1"),
        (this_or_next|eq, ":var0", "$g_presentation_obj_marshall_selection_2"),
        (eq, ":var0", "$g_presentation_obj_marshall_selection_3"),
        (try_begin),
          (ge, "$g_presentation_next_presentation", 0),
          (start_presentation, "$g_presentation_next_presentation"),
        (else_try),
          (try_begin),
            (neg|faction_slot_eq, "$players_kingdom", 8, "$g_presentation_marshall_selection_max_renown_1_troop"),
            (call_script, "script_check_and_finish_active_army_quests_for_faction", "$players_kingdom"),
          (try_end),
          (faction_get_slot, ":var1", "$players_kingdom", 8),
          (try_begin),
            (ge, ":var1", 0),
            (party_is_active, ":var1"),
            (1604, ":var1", 0),
          (try_end),
          (faction_set_slot, "$players_kingdom", 8, "$g_presentation_marshall_selection_max_renown_1_troop"),
          (try_begin),
            (eq, "$g_presentation_marshall_selection_max_renown_1_troop", "trp_player"),
            (call_script, "script_change_player_relation_with_troop", "$g_presentation_marshall_selection_max_renown_2_troop", -3),
          (try_end),
          (assign, "$g_recalculate_ais", 1),
          (assign, "$g_presentation_marshall_selection_ended", 1),
          (presentation_set_duration, 0),
        (try_end),
      (try_end),
    ]),
  ]),

  ("battle", 0, mesh_null,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (assign, "$g_formation_group0_selected", 0),
      (assign, "$g_formation_group1_selected", 0),
      (assign, "$g_formation_group2_selected", 0),
      (assign, "$g_formation_group3_selected", 0),
      (assign, "$g_formation_group4_selected", 0),
      (assign, "$g_formation_group5_selected", 0),
      (assign, "$g_formation_group6_selected", 0),
      (assign, "$g_formation_group7_selected", 0),
      (assign, "$g_formation_group8_selected", 0),
      (assign, "$g_presentation_obj_battle_but0", -1),
      (assign, "$g_presentation_obj_battle_but1", -1),
      (assign, "$g_presentation_obj_battle_but2", -1),
      (assign, "$g_presentation_obj_battle_but3", -1),
      (assign, "$g_presentation_obj_battle_but4", -1),
      (assign, "$g_presentation_obj_battle_but5", -1),
      (assign, "$g_presentation_obj_battle_but6", -1),
      (assign, "$g_presentation_obj_battle_but7", -1),
      (assign, "$g_presentation_obj_battle_but8", -1),
      (str_clear, s7),
      (try_for_agents, ":var0"),
        (agent_set_slot, ":var0", 10, 0),
      (try_end),
      (get_player_agent_no, ":var1"),
      (agent_get_troop_id, ":var2", ":var1"),
      (position_set_y, pos1, 700),
      (create_text_overlay, reg1, "@Action", 98320),
      (overlay_set_color, reg1, 4289374890),
      (position_set_x, pos1, 270),
      (overlay_set_position, reg1, pos1),
      (create_text_overlay, reg1, "@Mount", 98320),
      (overlay_set_color, reg1, 4289374890),
      (position_set_x, pos1, 410),
      (overlay_set_position, reg1, pos1),
      (create_text_overlay, reg1, "@Attack Order", 98320),
      (overlay_set_color, reg1, 4289374890),
      (position_set_x, pos1, 550),
      (overlay_set_position, reg1, pos1),
      (assign, "$group0_has_troops", 0),
      (assign, "$group1_has_troops", 0),
      (assign, "$group2_has_troops", 0),
      (assign, "$group3_has_troops", 0),
      (assign, "$group4_has_troops", 0),
      (assign, "$group5_has_troops", 0),
      (assign, "$group6_has_troops", 0),
      (assign, "$group7_has_troops", 0),
      (assign, "$group8_has_troops", 0),
      (party_get_num_companion_stacks, ":var3", "p_main_party"),
      (assign, "$num_classes", 0),
      (try_for_range, ":var4", 0, ":var3"),
        (party_stack_get_troop_id, ":var5", "p_main_party", ":var4"),
        (1516, ":var6", ":var5"),
        (neq, ":var2", ":var5"),
        (try_begin),
          (eq, ":var6", 0),
          (try_begin),
            (neq, "$group0_has_troops", 1),
            (val_add, "$num_classes", 1),
          (try_end),
          (assign, "$group0_has_troops", 1),
        (else_try),
          (eq, ":var6", 1),
          (try_begin),
            (neq, "$group1_has_troops", 1),
            (val_add, "$num_classes", 1),
          (try_end),
          (assign, "$group1_has_troops", 1),
        (else_try),
          (eq, ":var6", 2),
          (try_begin),
            (neq, "$group2_has_troops", 1),
            (val_add, "$num_classes", 1),
          (try_end),
          (assign, "$group2_has_troops", 1),
        (else_try),
          (eq, ":var6", 3),
          (try_begin),
            (neq, "$group3_has_troops", 1),
            (val_add, "$num_classes", 1),
          (try_end),
          (assign, "$group3_has_troops", 1),
        (else_try),
          (eq, ":var6", 4),
          (try_begin),
            (neq, "$group4_has_troops", 1),
            (val_add, "$num_classes", 1),
          (try_end),
          (assign, "$group4_has_troops", 1),
        (else_try),
          (eq, ":var6", 5),
          (try_begin),
            (neq, "$group5_has_troops", 1),
            (val_add, "$num_classes", 1),
          (try_end),
          (assign, "$group5_has_troops", 1),
        (else_try),
          (eq, ":var6", 6),
          (try_begin),
            (neq, "$group6_has_troops", 1),
            (val_add, "$num_classes", 1),
          (try_end),
          (assign, "$group6_has_troops", 1),
        (else_try),
          (eq, ":var6", 7),
          (try_begin),
            (neq, "$group7_has_troops", 1),
            (val_add, "$num_classes", 1),
          (try_end),
          (assign, "$group7_has_troops", 1),
        (else_try),
          (eq, ":var6", 8),
          (try_begin),
            (neq, "$group8_has_troops", 1),
            (val_add, "$num_classes", 1),
          (try_end),
          (assign, "$group8_has_troops", 1),
        (try_end),
      (try_end),
      (assign, ":var7", 0),
      (assign, ":var8", 653),
      (assign, ":var9", 20),
      (assign, ":var10", 662),
      (assign, ":var11", 50),
      (assign, ":var12", 660),
      (try_begin),
        (assign, ":var13", 15578182),
        (eq, "$group0_has_troops", 1),
        (create_image_button_overlay, "$g_presentation_obj_battle_but0", "mesh_white_plane", "mesh_white_plane"),
        (position_set_x, pos1, ":var7"),
        (position_set_y, pos1, ":var8"),
        (overlay_set_position, "$g_presentation_obj_battle_but0", pos1),
        (val_add, ":var8", -40),
        (position_set_x, pos1, 32500),
        (position_set_y, pos1, 2000),
        (overlay_set_size, "$g_presentation_obj_battle_but0", pos1),
        (overlay_set_alpha, "$g_presentation_obj_battle_but0", 0x00),
        (overlay_set_color, "$g_presentation_obj_battle_but0", ":var13"),
        (create_check_box_overlay, "$g_presentation_obj_battle_check0", "mesh_checkbox_off", "mesh_checkbox_on"),
        (position_set_x, pos2, ":var9"),
        (position_set_y, pos2, ":var10"),
        (overlay_set_position, "$g_presentation_obj_battle_check0", pos2),
        (val_add, ":var10", -40),
        (create_text_overlay, "$g_presentation_obj_battle_name0", s7, 0),
        (position_set_x, pos3, ":var11"),
        (position_set_y, pos3, ":var12"),
        (overlay_set_position, "$g_presentation_obj_battle_name0", pos3),
        (val_add, ":var12", -40),
        (create_text_overlay, "$g_presentation_but0_movement", s7, 16),
        (create_text_overlay, "$g_presentation_but0_riding", s7, 16),
        (create_text_overlay, "$g_presentation_but0_weapon_usage", s7, 16),
      (try_end),
      (try_begin),
        (eq, "$group1_has_troops", 1),
        (create_image_button_overlay, "$g_presentation_obj_battle_but1", "mesh_white_plane", "mesh_white_plane"),
        (position_set_x, pos1, ":var7"),
        (position_set_y, pos1, ":var8"),
        (overlay_set_position, "$g_presentation_obj_battle_but1", pos1),
        (val_add, ":var8", -40),
        (position_set_x, pos1, 32500),
        (position_set_y, pos1, 2000),
        (overlay_set_size, "$g_presentation_obj_battle_but1", pos1),
        (overlay_set_alpha, "$g_presentation_obj_battle_but1", 0x00),
        (overlay_set_color, "$g_presentation_obj_battle_but1", ":var13"),
        (create_check_box_overlay, "$g_presentation_obj_battle_check1", "mesh_checkbox_off", "mesh_checkbox_on"),
        (position_set_x, pos2, ":var9"),
        (position_set_y, pos2, ":var10"),
        (overlay_set_position, "$g_presentation_obj_battle_check1", pos2),
        (val_add, ":var10", -40),
        (create_text_overlay, "$g_presentation_obj_battle_name1", s7, 0),
        (position_set_x, pos3, ":var11"),
        (position_set_y, pos3, ":var12"),
        (overlay_set_position, "$g_presentation_obj_battle_name1", pos3),
        (val_add, ":var12", -40),
        (create_text_overlay, "$g_presentation_but1_movement", s7, 16),
        (create_text_overlay, "$g_presentation_but1_riding", s7, 16),
        (create_text_overlay, "$g_presentation_but1_weapon_usage", s7, 16),
      (try_end),
      (try_begin),
        (eq, "$group2_has_troops", 1),
        (create_image_button_overlay, "$g_presentation_obj_battle_but2", "mesh_white_plane", "mesh_white_plane"),
        (position_set_x, pos1, ":var7"),
        (position_set_y, pos1, ":var8"),
        (overlay_set_position, "$g_presentation_obj_battle_but2", pos1),
        (val_add, ":var8", -40),
        (position_set_x, pos1, 32500),
        (position_set_y, pos1, 2000),
        (overlay_set_size, "$g_presentation_obj_battle_but2", pos1),
        (overlay_set_alpha, "$g_presentation_obj_battle_but2", 0x00),
        (overlay_set_color, "$g_presentation_obj_battle_but2", ":var13"),
        (create_check_box_overlay, "$g_presentation_obj_battle_check2", "mesh_checkbox_off", "mesh_checkbox_on"),
        (position_set_x, pos2, ":var9"),
        (position_set_y, pos2, ":var10"),
        (overlay_set_position, "$g_presentation_obj_battle_check2", pos2),
        (val_add, ":var10", -40),
        (create_text_overlay, "$g_presentation_obj_battle_name2", s7, 0),
        (position_set_x, pos3, ":var11"),
        (position_set_y, pos3, ":var12"),
        (overlay_set_position, "$g_presentation_obj_battle_name2", pos3),
        (val_add, ":var12", -40),
        (create_text_overlay, "$g_presentation_but2_movement", s7, 16),
        (create_text_overlay, "$g_presentation_but2_riding", s7, 16),
        (create_text_overlay, "$g_presentation_but2_weapon_usage", s7, 16),
      (try_end),
      (try_begin),
        (eq, "$group3_has_troops", 1),
        (create_image_button_overlay, "$g_presentation_obj_battle_but3", "mesh_white_plane", "mesh_white_plane"),
        (position_set_x, pos1, ":var7"),
        (position_set_y, pos1, ":var8"),
        (overlay_set_position, "$g_presentation_obj_battle_but3", pos1),
        (val_add, ":var8", -40),
        (position_set_x, pos1, 32500),
        (position_set_y, pos1, 2000),
        (overlay_set_size, "$g_presentation_obj_battle_but3", pos1),
        (overlay_set_alpha, "$g_presentation_obj_battle_but3", 0x00),
        (overlay_set_color, "$g_presentation_obj_battle_but3", ":var13"),
        (create_check_box_overlay, "$g_presentation_obj_battle_check3", "mesh_checkbox_off", "mesh_checkbox_on"),
        (position_set_x, pos2, ":var9"),
        (position_set_y, pos2, ":var10"),
        (overlay_set_position, "$g_presentation_obj_battle_check3", pos2),
        (val_add, ":var10", -40),
        (create_text_overlay, "$g_presentation_obj_battle_name3", s7, 0),
        (position_set_x, pos3, ":var11"),
        (position_set_y, pos3, ":var12"),
        (overlay_set_position, "$g_presentation_obj_battle_name3", pos3),
        (val_add, ":var12", -40),
        (create_text_overlay, "$g_presentation_but3_movement", s7, 16),
        (create_text_overlay, "$g_presentation_but3_riding", s7, 16),
        (create_text_overlay, "$g_presentation_but3_weapon_usage", s7, 16),
      (try_end),
      (try_begin),
        (eq, "$group4_has_troops", 1),
        (create_image_button_overlay, "$g_presentation_obj_battle_but4", "mesh_white_plane", "mesh_white_plane"),
        (position_set_x, pos1, ":var7"),
        (position_set_y, pos1, ":var8"),
        (overlay_set_position, "$g_presentation_obj_battle_but4", pos1),
        (val_add, ":var8", -40),
        (position_set_x, pos1, 32500),
        (position_set_y, pos1, 2000),
        (overlay_set_size, "$g_presentation_obj_battle_but4", pos1),
        (overlay_set_alpha, "$g_presentation_obj_battle_but4", 0x00),
        (overlay_set_color, "$g_presentation_obj_battle_but4", ":var13"),
        (create_check_box_overlay, "$g_presentation_obj_battle_check4", "mesh_checkbox_off", "mesh_checkbox_on"),
        (position_set_x, pos2, ":var9"),
        (position_set_y, pos2, ":var10"),
        (overlay_set_position, "$g_presentation_obj_battle_check4", pos2),
        (val_add, ":var10", -40),
        (create_text_overlay, "$g_presentation_obj_battle_name4", s7, 0),
        (position_set_x, pos3, ":var11"),
        (position_set_y, pos3, ":var12"),
        (overlay_set_position, "$g_presentation_obj_battle_name4", pos3),
        (val_add, ":var12", -40),
        (create_text_overlay, "$g_presentation_but4_movement", s7, 16),
        (create_text_overlay, "$g_presentation_but4_riding", s7, 16),
        (create_text_overlay, "$g_presentation_but4_weapon_usage", s7, 16),
      (try_end),
      (try_begin),
        (eq, "$group5_has_troops", 1),
        (create_image_button_overlay, "$g_presentation_obj_battle_but5", "mesh_white_plane", "mesh_white_plane"),
        (position_set_x, pos1, ":var7"),
        (position_set_y, pos1, ":var8"),
        (overlay_set_position, "$g_presentation_obj_battle_but5", pos1),
        (val_add, ":var8", -40),
        (position_set_x, pos1, 32500),
        (position_set_y, pos1, 2000),
        (overlay_set_size, "$g_presentation_obj_battle_but5", pos1),
        (overlay_set_alpha, "$g_presentation_obj_battle_but5", 0x00),
        (overlay_set_color, "$g_presentation_obj_battle_but5", ":var13"),
        (create_check_box_overlay, "$g_presentation_obj_battle_check5", "mesh_checkbox_off", "mesh_checkbox_on"),
        (position_set_x, pos2, ":var9"),
        (position_set_y, pos2, ":var10"),
        (overlay_set_position, "$g_presentation_obj_battle_check5", pos2),
        (val_add, ":var10", -40),
        (create_text_overlay, "$g_presentation_obj_battle_name5", s7, 0),
        (position_set_x, pos3, ":var11"),
        (position_set_y, pos3, ":var12"),
        (overlay_set_position, "$g_presentation_obj_battle_name5", pos3),
        (val_add, ":var12", -40),
        (create_text_overlay, "$g_presentation_but5_movement", s7, 16),
        (create_text_overlay, "$g_presentation_but5_riding", s7, 16),
        (create_text_overlay, "$g_presentation_but5_weapon_usage", s7, 16),
      (try_end),
      (try_begin),
        (eq, "$group6_has_troops", 1),
        (create_image_button_overlay, "$g_presentation_obj_battle_but6", "mesh_white_plane", "mesh_white_plane"),
        (position_set_x, pos1, ":var7"),
        (position_set_y, pos1, ":var8"),
        (overlay_set_position, "$g_presentation_obj_battle_but6", pos1),
        (val_add, ":var8", -40),
        (position_set_x, pos1, 32500),
        (position_set_y, pos1, 2000),
        (overlay_set_size, "$g_presentation_obj_battle_but6", pos1),
        (overlay_set_alpha, "$g_presentation_obj_battle_but6", 0x00),
        (overlay_set_color, "$g_presentation_obj_battle_but6", ":var13"),
        (create_check_box_overlay, "$g_presentation_obj_battle_check6", "mesh_checkbox_off", "mesh_checkbox_on"),
        (position_set_x, pos2, ":var9"),
        (position_set_y, pos2, ":var10"),
        (overlay_set_position, "$g_presentation_obj_battle_check6", pos2),
        (val_add, ":var10", -40),
        (create_text_overlay, "$g_presentation_obj_battle_name6", s7, 0),
        (position_set_x, pos3, ":var11"),
        (position_set_y, pos3, ":var12"),
        (overlay_set_position, "$g_presentation_obj_battle_name6", pos3),
        (val_add, ":var12", -40),
        (create_text_overlay, "$g_presentation_but6_movement", s7, 16),
        (create_text_overlay, "$g_presentation_but6_riding", s7, 16),
        (create_text_overlay, "$g_presentation_but6_weapon_usage", s7, 16),
      (try_end),
      (try_begin),
        (eq, "$group7_has_troops", 1),
        (create_image_button_overlay, "$g_presentation_obj_battle_but7", "mesh_white_plane", "mesh_white_plane"),
        (position_set_x, pos1, ":var7"),
        (position_set_y, pos1, ":var8"),
        (overlay_set_position, "$g_presentation_obj_battle_but7", pos1),
        (val_add, ":var8", -40),
        (position_set_x, pos1, 32500),
        (position_set_y, pos1, 2000),
        (overlay_set_size, "$g_presentation_obj_battle_but7", pos1),
        (overlay_set_alpha, "$g_presentation_obj_battle_but7", 0x00),
        (overlay_set_color, "$g_presentation_obj_battle_but7", ":var13"),
        (create_check_box_overlay, "$g_presentation_obj_battle_check7", "mesh_checkbox_off", "mesh_checkbox_on"),
        (position_set_x, pos2, ":var9"),
        (position_set_y, pos2, ":var10"),
        (overlay_set_position, "$g_presentation_obj_battle_check7", pos2),
        (val_add, ":var10", -40),
        (create_text_overlay, "$g_presentation_obj_battle_name7", s7, 0),
        (position_set_x, pos3, ":var11"),
        (position_set_y, pos3, ":var12"),
        (overlay_set_position, "$g_presentation_obj_battle_name7", pos3),
        (val_add, ":var12", -40),
        (create_text_overlay, "$g_presentation_but7_movement", s7, 16),
        (create_text_overlay, "$g_presentation_but7_riding", s7, 16),
        (create_text_overlay, "$g_presentation_but7_weapon_usage", s7, 16),
      (try_end),
      (try_begin),
        (eq, "$group8_has_troops", 1),
        (create_image_button_overlay, "$g_presentation_obj_battle_but8", "mesh_white_plane", "mesh_white_plane"),
        (position_set_x, pos1, ":var7"),
        (position_set_y, pos1, ":var8"),
        (overlay_set_position, "$g_presentation_obj_battle_but8", pos1),
        (val_add, ":var8", -40),
        (position_set_x, pos1, 32500),
        (position_set_y, pos1, 2000),
        (overlay_set_size, "$g_presentation_obj_battle_but8", pos1),
        (overlay_set_alpha, "$g_presentation_obj_battle_but8", 0x00),
        (overlay_set_color, "$g_presentation_obj_battle_but8", ":var13"),
        (create_check_box_overlay, "$g_presentation_obj_battle_check8", "mesh_checkbox_off", "mesh_checkbox_on"),
        (position_set_x, pos2, ":var9"),
        (position_set_y, pos2, ":var10"),
        (overlay_set_position, "$g_presentation_obj_battle_check8", pos2),
        (val_add, ":var10", -40),
        (create_text_overlay, "$g_presentation_obj_battle_name8", s7, 0),
        (position_set_x, pos3, ":var11"),
        (position_set_y, pos3, ":var12"),
        (overlay_set_position, "$g_presentation_obj_battle_name8", pos3),
        (val_add, ":var12", -40),
        (create_text_overlay, "$g_presentation_but8_movement", s7, 16),
        (create_text_overlay, "$g_presentation_but8_riding", s7, 16),
        (create_text_overlay, "$g_presentation_but8_weapon_usage", s7, 16),
      (try_end),
      (get_player_agent_no, ":var1"),
      (agent_get_team, ":var14", ":var1"),
      (call_script, "script_update_order_panel", ":var14"),
      (assign, ":var15", 640),
      (assign, ":var16", "$num_classes"),
      (val_mul, ":var16", -40),
      (val_add, ":var15", ":var16"),
      (943, "$g_presentation_obj_battle_10", "str_space", 98320),
      (943, "$g_presentation_obj_battle_11", "str_space", 0),
      (943, "$g_presentation_obj_battle_12", "str_space", 0),
      (943, "$g_presentation_obj_battle_13", "str_space", 0),
      (overlay_set_color, "$g_presentation_obj_battle_10", 16777215),
      (overlay_set_color, "$g_presentation_obj_battle_11", 16777215),
      (overlay_set_color, "$g_presentation_obj_battle_12", 16777215),
      (overlay_set_color, "$g_presentation_obj_battle_13", 16777215),
      (overlay_add_item, "$g_presentation_obj_battle_10", "@Stand Ground"),
      (overlay_add_item, "$g_presentation_obj_battle_10", "@Charge"),
      (overlay_add_item, "$g_presentation_obj_battle_10", "@Follow Me"),
      (overlay_add_item, "$g_presentation_obj_battle_10", "@Hold This Position"),
      (create_button_overlay, "$g_presentation_obj_battle_14", "@Spread Out", 98320),
      (overlay_set_color, "$g_presentation_obj_battle_14", 4294967295),
      (create_button_overlay, "$g_presentation_obj_battle_15", "@Stand Closer", 98320),
      (overlay_set_color, "$g_presentation_obj_battle_15", 4294967295),
      (create_button_overlay, "$g_presentation_obj_battle_16", "@Fall Back", 98320),
      (overlay_set_color, "$g_presentation_obj_battle_16", 4294967295),
      (create_button_overlay, "$g_presentation_obj_battle_17", "@Advance", 98320),
      (overlay_set_color, "$g_presentation_obj_battle_17", 4294967295),
      (position_set_x, pos1, 600),
      (position_set_y, pos1, 600),
      (overlay_set_size, "$g_presentation_obj_battle_10", pos1),
      (val_add, ":var15", -35),
      (position_set_x, pos1, 205),
      (position_set_y, pos1, ":var15"),
      (val_add, ":var15", 35),
      (overlay_set_position, "$g_presentation_obj_battle_10", pos1),
      (overlay_set_alpha, "$g_presentation_obj_battle_10", 0x60),
      (overlay_set_val, "$g_presentation_obj_battle_10", "$g_latest_order_1"),
      (val_add, ":var15", -40),
      (position_set_x, pos1, 130),
      (position_set_y, pos1, ":var15"),
      (val_add, ":var15", 40),
      (overlay_set_position, "$g_presentation_obj_battle_14", pos1),
      (val_add, ":var15", -20),
      (position_set_x, pos1, 130),
      (position_set_y, pos1, ":var15"),
      (val_add, ":var15", 20),
      (overlay_set_position, "$g_presentation_obj_battle_15", pos1),
      (val_add, ":var15", 0),
      (position_set_x, pos1, 130),
      (position_set_y, pos1, ":var15"),
      (val_add, ":var15", 0),
      (overlay_set_position, "$g_presentation_obj_battle_16", pos1),
      (val_add, ":var15", 20),
      (position_set_x, pos1, 130),
      (position_set_y, pos1, ":var15"),
      (val_add, ":var15", -20),
      (overlay_set_position, "$g_presentation_obj_battle_17", pos1),
      (overlay_add_item, "$g_presentation_obj_battle_11", "@Dismount"),
      (overlay_add_item, "$g_presentation_obj_battle_11", "@Mount"),
      (position_set_x, pos1, 600),
      (position_set_y, pos1, 600),
      (overlay_set_size, "$g_presentation_obj_battle_11", pos1),
      (position_set_x, pos1, 350),
      (position_set_y, pos1, ":var15"),
      (overlay_set_position, "$g_presentation_obj_battle_11", pos1),
      (overlay_set_alpha, "$g_presentation_obj_battle_11", 0x60),
      (overlay_set_val, "$g_presentation_obj_battle_11", "$g_latest_order_2"),
      (overlay_add_item, "$g_presentation_obj_battle_12", "@Fire At Will"),
      (overlay_add_item, "$g_presentation_obj_battle_12", "@Hold Your Fire"),
      (position_set_x, pos1, 600),
      (position_set_y, pos1, 600),
      (overlay_set_size, "$g_presentation_obj_battle_12", pos1),
      (position_set_x, pos1, 495),
      (position_set_y, pos1, ":var15"),
      (overlay_set_position, "$g_presentation_obj_battle_12", pos1),
      (overlay_set_alpha, "$g_presentation_obj_battle_12", 0x60),
      (overlay_set_val, "$g_presentation_obj_battle_12", "$g_latest_order_3"),
      (overlay_add_item, "$g_presentation_obj_battle_13", "@Use Blunt Weapons"),
      (overlay_add_item, "$g_presentation_obj_battle_13", "@Use Any Weapon"),
      (position_set_x, pos1, 600),
      (position_set_y, pos1, 600),
      (overlay_set_size, "$g_presentation_obj_battle_13", pos1),
      (val_add, ":var15", -35),
      (position_set_x, pos1, 495),
      (position_set_y, pos1, ":var15"),
      (val_add, ":var15", 35),
      (overlay_set_position, "$g_presentation_obj_battle_13", pos1),
      (overlay_set_alpha, "$g_presentation_obj_battle_13", 0x60),
      (overlay_set_val, "$g_presentation_obj_battle_13", "$g_latest_order_4"),
      (overlay_set_color, "$g_presentation_obj_battle_10", 16777215),
      (overlay_set_color, "$g_presentation_obj_battle_11", 16777215),
      (overlay_set_color, "$g_presentation_obj_battle_12", 16777215),
      (overlay_set_color, "$g_presentation_obj_battle_13", 16777215),
      (overlay_set_hilight_color, "$g_presentation_obj_battle_10", 16777215),
      (overlay_set_hilight_color, "$g_presentation_obj_battle_11", 16777215),
      (overlay_set_hilight_color, "$g_presentation_obj_battle_12", 16777215),
      (overlay_set_hilight_color, "$g_presentation_obj_battle_13", 16777215),
      (create_text_overlay, "$g_presentation_obj_battle_22", "str_us_", 0),
      (create_text_overlay, "$g_presentation_obj_battle_23", "str_allies_", 0),
      (create_text_overlay, "$g_presentation_obj_battle_24", "str_enemies_", 0),
      (create_text_overlay, "$g_presentation_obj_battle_25", "@Ready", 16),
      (create_text_overlay, "$g_presentation_obj_battle_26", "@Wounded", 16),
      (create_text_overlay, "$g_presentation_obj_battle_28", "str_routed", 16),
      (create_text_overlay, "$g_presentation_obj_battle_27", "@Dead", 16),
      (overlay_set_color, "$g_presentation_obj_battle_22", 1660942),
      (overlay_set_color, "$g_presentation_obj_battle_23", 0),
      (overlay_set_color, "$g_presentation_obj_battle_24", 5770766),
      (overlay_set_color, "$g_presentation_obj_battle_25", 0),
      (overlay_set_color, "$g_presentation_obj_battle_26", 0),
      (overlay_set_color, "$g_presentation_obj_battle_27", 0),
      (overlay_set_color, "$g_presentation_obj_battle_28", 0),
      (create_text_overlay, "$g_battle_us_ready", s7, 16),
      (create_text_overlay, "$g_battle_us_wounded", s7, 16),
      (create_text_overlay, "$g_battle_us_routed", s7, 16),
      (create_text_overlay, "$g_battle_us_dead", s7, 16),
      (create_text_overlay, "$g_battle_enemies_ready", s7, 16),
      (create_text_overlay, "$g_battle_enemies_wounded", s7, 16),
      (create_text_overlay, "$g_battle_enemies_routed", s7, 16),
      (create_text_overlay, "$g_battle_enemies_dead", s7, 16),
      (create_text_overlay, "$g_battle_allies_ready", s7, 16),
      (create_text_overlay, "$g_battle_allies_wounded", s7, 16),
      (create_text_overlay, "$g_battle_allies_routed", s7, 16),
      (create_text_overlay, "$g_battle_allies_dead", s7, 16),
      (overlay_set_color, "$g_battle_us_ready", 0),
      (overlay_set_color, "$g_battle_us_wounded", 0),
      (overlay_set_color, "$g_battle_us_routed", 0),
      (overlay_set_color, "$g_battle_us_dead", 0),
      (overlay_set_color, "$g_battle_enemies_ready", 0),
      (overlay_set_color, "$g_battle_enemies_wounded", 0),
      (overlay_set_color, "$g_battle_enemies_routed", 0),
      (overlay_set_color, "$g_battle_enemies_dead", 0),
      (overlay_set_color, "$g_battle_allies_ready", 0),
      (overlay_set_color, "$g_battle_allies_wounded", 0),
      (overlay_set_color, "$g_battle_allies_routed", 0),
      (overlay_set_color, "$g_battle_allies_dead", 0),
      (create_image_button_overlay, "$g_battle_report_plane", "mesh_white_plane", "mesh_white_plane"),
      (overlay_set_color, "$g_battle_report_plane", 0),
      (position_set_x, pos1, 15500),
      (position_set_y, pos1, 6000),
      (overlay_set_size, "$g_battle_report_plane", pos1),
      (position_set_x, pos1, 672),
      (position_set_y, pos1, 275),
      (overlay_set_position, "$g_battle_report_plane", pos1),
      (overlay_set_alpha, "$g_battle_report_plane", 0x44),
      (overlay_set_color, "$g_battle_report_plane", 16777215),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, "$g_presentation_obj_battle_14", pos1),
      (overlay_set_size, "$g_presentation_obj_battle_15", pos1),
      (overlay_set_size, "$g_presentation_obj_battle_16", pos1),
      (overlay_set_size, "$g_presentation_obj_battle_17", pos1),
      (overlay_set_size, "$g_presentation_obj_battle_22", pos1),
      (overlay_set_size, "$g_presentation_obj_battle_23", pos1),
      (overlay_set_size, "$g_presentation_obj_battle_24", pos1),
      (overlay_set_size, "$g_presentation_obj_battle_25", pos1),
      (overlay_set_size, "$g_presentation_obj_battle_26", pos1),
      (overlay_set_size, "$g_presentation_obj_battle_27", pos1),
      (overlay_set_size, "$g_presentation_obj_battle_28", pos1),
      (overlay_set_size, "$g_battle_us_ready", pos1),
      (overlay_set_size, "$g_battle_us_wounded", pos1),
      (overlay_set_size, "$g_battle_us_routed", pos1),
      (overlay_set_size, "$g_battle_us_dead", pos1),
      (overlay_set_size, "$g_battle_enemies_ready", pos1),
      (overlay_set_size, "$g_battle_enemies_wounded", pos1),
      (overlay_set_size, "$g_battle_enemies_routed", pos1),
      (overlay_set_size, "$g_battle_enemies_dead", pos1),
      (overlay_set_size, "$g_battle_allies_ready", pos1),
      (overlay_set_size, "$g_battle_allies_wounded", pos1),
      (overlay_set_size, "$g_battle_allies_routed", pos1),
      (overlay_set_size, "$g_battle_allies_dead", pos1),
      (assign, ":var7", 675),
      (assign, ":var8", 280),
      (val_add, ":var7", 70),
      (val_add, ":var8", 90),
      (position_set_x, pos1, ":var7"),
      (position_set_y, pos1, ":var8"),
      (overlay_set_position, "$g_presentation_obj_battle_25", pos1),
      (val_add, ":var7", 70),
      (position_set_x, pos1, ":var7"),
      (overlay_set_position, "$g_presentation_obj_battle_26", pos1),
      (val_add, ":var7", 70),
      (position_set_x, pos1, ":var7"),
      (overlay_set_position, "$g_presentation_obj_battle_28", pos1),
      (val_add, ":var7", 70),
      (position_set_x, pos1, ":var7"),
      (overlay_set_position, "$g_presentation_obj_battle_27", pos1),
      (val_add, ":var7", -280),
      (val_add, ":var8", -30),
      (position_set_x, pos1, ":var7"),
      (position_set_y, pos1, ":var8"),
      (overlay_set_position, "$g_presentation_obj_battle_22", pos1),
      (val_add, ":var8", -30),
      (position_set_y, pos1, ":var8"),
      (overlay_set_position, "$g_presentation_obj_battle_23", pos1),
      (val_add, ":var8", -30),
      (position_set_y, pos1, ":var8"),
      (overlay_set_position, "$g_presentation_obj_battle_24", pos1),
      (get_scene_boundaries, pos2, pos3),
      (717, 4, 2, 3),
      (set_fixed_point_multiplier, 1000),
      (position_get_x, ":var17", pos4),
      (position_get_y, ":var18", pos4),
      (set_fixed_point_multiplier, 1000),
      (store_div, ":var19", ":var18", 100),
      (store_div, ":var19", ":var17", ":var19"),
      (try_begin),
        (gt, ":var19", 100),
        (assign, "$g_battle_map_width", 300),
        (store_div, "$g_battle_map_scale", ":var17", "$g_battle_map_width"),
        (store_div, "$g_battle_map_height", ":var18", "$g_battle_map_scale"),
      (else_try),
        (assign, "$g_battle_map_height", 300),
        (store_div, "$g_battle_map_scale", ":var18", "$g_battle_map_height"),
        (store_div, "$g_battle_map_width", ":var17", "$g_battle_map_scale"),
      (try_end),
      (scene_prop_get_num_instances, ":var20", "spr_inventory"),
      (try_begin),
        (gt, ":var20", 0),
        (create_mesh_overlay, reg1, "mesh_white_dot"),
        (position_set_x, pos1, 200),
        (position_set_y, pos1, 200),
        (overlay_set_size, reg1, pos1),
        (overlay_set_alpha, reg1, 0xFF),
        (overlay_set_color, reg1, 16777215),
        (assign, ":var21", reg1),
        (get_scene_boundaries, pos2, pos3),
        (scene_prop_get_instance, ":var22", "spr_inventory", 0),
        (prop_instance_get_position, pos1, ":var22"),
        (call_script, "script_convert_3d_pos_to_map_pos"),
        (overlay_set_position, ":var21", pos0),
      (try_end),
      (create_image_button_overlay, "$g_battle_map_plane", "mesh_white_plane", "mesh_white_plane"),
      (overlay_set_color, "$g_battle_map_plane", 0),
      (store_add, ":var23", "$g_battle_map_width", 20),
      (store_add, ":var24", "$g_battle_map_height", 20),
      (store_mul, ":var25", ":var23", 50),
      (store_mul, ":var26", ":var24", 50),
      (position_set_x, pos1, ":var25"),
      (position_set_y, pos1, ":var26"),
      (overlay_set_size, "$g_battle_map_plane", pos1),
      (store_sub, ":var27", 990, ":var23"),
      (store_sub, ":var28", 740, ":var24"),
      (position_set_x, pos1, ":var27"),
      (position_set_y, pos1, ":var28"),
      (overlay_set_position, "$g_battle_map_plane", pos1),
      (overlay_set_alpha, "$g_battle_map_plane", 0x99),
      (create_mesh_overlay, "$g_battle_map_infantry_order_flag", "mesh_flag_infantry"),
      (create_mesh_overlay, "$g_battle_map_archers_order_flag", "mesh_flag_archers"),
      (create_mesh_overlay, "$g_battle_map_cavalry_order_flag", "mesh_flag_cavalry"),
      (overlay_set_alpha, "$g_battle_map_infantry_order_flag", 0x00),
      (overlay_set_alpha, "$g_battle_map_archers_order_flag", 0x00),
      (overlay_set_alpha, "$g_battle_map_cavalry_order_flag", 0x00),
      (create_mesh_overlay, "$g_battle_map_spears_order_flag", "mesh_flag_spears"),
      (create_mesh_overlay, "$g_battle_map_skirmishers_order_flag", "mesh_flag_skirmishers"),
      (create_mesh_overlay, "$g_battle_map_horsemen_order_flag", "mesh_flag_horsemen"),
      (overlay_set_alpha, "$g_battle_map_spears_order_flag", 0x00),
      (overlay_set_alpha, "$g_battle_map_skirmishers_order_flag", 0x00),
      (overlay_set_alpha, "$g_battle_map_horsemen_order_flag", 0x00),
      (create_mesh_overlay, "$g_battle_map_d7_order_flag", "mesh_flag_d7"),
      (create_mesh_overlay, "$g_battle_map_d8_order_flag", "mesh_flag_d8"),
      (create_mesh_overlay, "$g_battle_map_d9_order_flag", "mesh_flag_d9"),
      (overlay_set_alpha, "$g_battle_map_d7_order_flag", 0x00),
      (overlay_set_alpha, "$g_battle_map_d8_order_flag", 0x00),
      (overlay_set_alpha, "$g_battle_map_d9_order_flag", 0x00),
      (call_script, "script_update_order_panel_checked_classes"),
      (call_script, "script_update_order_panel_statistics_and_map"),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (store_trigger_param_2, ":var1"),
      (get_player_agent_no, ":var2"),
      (agent_get_team, ":var3", ":var2"),
      (assign, ":var4", 0),
      (try_begin),
        (eq, "$group0_has_troops", 1),
        (eq, ":var0", "$g_presentation_obj_battle_check0"),
        (assign, ":var4", 1),
        (assign, "$g_formation_group0_selected", ":var1"),
        (try_begin),
          (eq, ":var1", 1),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but0", 250, 68),
        (else_try),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but0", 250, 0),
        (try_end),
      (else_try),
        (eq, "$group1_has_troops", 1),
        (eq, ":var0", "$g_presentation_obj_battle_check1"),
        (assign, ":var4", 1),
        (assign, "$g_formation_group1_selected", ":var1"),
        (try_begin),
          (eq, ":var1", 1),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but1", 250, 68),
        (else_try),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but1", 250, 0),
        (try_end),
      (else_try),
        (eq, "$group2_has_troops", 1),
        (eq, ":var0", "$g_presentation_obj_battle_check2"),
        (assign, ":var4", 1),
        (assign, "$g_formation_group2_selected", ":var1"),
        (try_begin),
          (eq, ":var1", 1),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but2", 250, 68),
        (else_try),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but2", 250, 0),
        (try_end),
      (else_try),
        (eq, "$group3_has_troops", 1),
        (eq, ":var0", "$g_presentation_obj_battle_check3"),
        (assign, ":var4", 1),
        (assign, "$g_formation_group3_selected", ":var1"),
        (try_begin),
          (eq, ":var1", 1),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but3", 250, 68),
        (else_try),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but3", 250, 0),
        (try_end),
      (else_try),
        (eq, "$group4_has_troops", 1),
        (eq, ":var0", "$g_presentation_obj_battle_check4"),
        (assign, ":var4", 1),
        (assign, "$g_formation_group4_selected", ":var1"),
        (try_begin),
          (eq, ":var1", 1),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but4", 250, 68),
        (else_try),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but4", 250, 0),
        (try_end),
      (else_try),
        (eq, "$group5_has_troops", 1),
        (eq, ":var0", "$g_presentation_obj_battle_check5"),
        (assign, ":var4", 1),
        (assign, "$g_formation_group5_selected", ":var1"),
        (try_begin),
          (eq, ":var1", 1),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but5", 250, 68),
        (else_try),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but5", 250, 0),
        (try_end),
      (else_try),
        (eq, "$group6_has_troops", 1),
        (eq, ":var0", "$g_presentation_obj_battle_check6"),
        (assign, ":var4", 1),
        (assign, "$g_formation_group6_selected", ":var1"),
        (try_begin),
          (eq, ":var1", 1),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but6", 250, 68),
        (else_try),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but6", 250, 0),
        (try_end),
      (else_try),
        (eq, "$group7_has_troops", 1),
        (eq, ":var0", "$g_presentation_obj_battle_check7"),
        (assign, ":var4", 1),
        (assign, "$g_formation_group7_selected", ":var1"),
        (try_begin),
          (eq, ":var1", 1),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but7", 250, 68),
        (else_try),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but7", 250, 0),
        (try_end),
      (else_try),
        (eq, "$group8_has_troops", 1),
        (eq, ":var0", "$g_presentation_obj_battle_check8"),
        (assign, ":var4", 1),
        (assign, "$g_formation_group8_selected", ":var1"),
        (try_begin),
          (eq, ":var1", 1),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but8", 250, 68),
        (else_try),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but8", 250, 0),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_battle_but0"),
        (assign, ":var4", 1),
        (assign, "$g_formation_group0_selected", 1),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but0", 250, 68),
        (overlay_set_val, "$g_presentation_obj_battle_check0", 1),
        (try_begin),
          (eq, "$group1_has_troops", 1),
          (assign, "$g_formation_group1_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check1", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but1", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group2_has_troops", 1),
          (assign, "$g_formation_group2_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check2", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but2", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group3_has_troops", 1),
          (assign, "$g_formation_group3_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check3", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but3", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group4_has_troops", 1),
          (assign, "$g_formation_group4_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check4", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but4", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group5_has_troops", 1),
          (assign, "$g_formation_group5_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check5", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but5", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group6_has_troops", 1),
          (assign, "$g_formation_group6_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check6", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but6", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group7_has_troops", 1),
          (assign, "$g_formation_group7_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check7", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but7", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group8_has_troops", 1),
          (assign, "$g_formation_group8_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check8", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but8", 250, 0),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_battle_but1"),
        (assign, ":var4", 1),
        (assign, "$g_formation_group1_selected", 1),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but1", 250, 68),
        (overlay_set_val, "$g_presentation_obj_battle_check1", 1),
        (try_begin),
          (eq, "$group0_has_troops", 1),
          (assign, "$g_formation_group0_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check0", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but0", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group2_has_troops", 1),
          (assign, "$g_formation_group2_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check2", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but2", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group3_has_troops", 1),
          (assign, "$g_formation_group3_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check3", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but3", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group4_has_troops", 1),
          (assign, "$g_formation_group4_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check4", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but4", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group5_has_troops", 1),
          (assign, "$g_formation_group5_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check5", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but5", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group6_has_troops", 1),
          (assign, "$g_formation_group6_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check6", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but6", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group7_has_troops", 1),
          (assign, "$g_formation_group7_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check7", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but7", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group8_has_troops", 1),
          (assign, "$g_formation_group8_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check8", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but8", 250, 0),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_battle_but2"),
        (assign, ":var4", 1),
        (assign, "$g_formation_group2_selected", 1),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but2", 250, 68),
        (overlay_set_val, "$g_presentation_obj_battle_check2", 1),
        (try_begin),
          (eq, "$group0_has_troops", 1),
          (assign, "$g_formation_group0_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check0", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but0", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group1_has_troops", 1),
          (assign, "$g_formation_group1_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check1", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but1", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group3_has_troops", 1),
          (assign, "$g_formation_group3_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check3", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but3", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group4_has_troops", 1),
          (assign, "$g_formation_group4_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check4", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but4", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group5_has_troops", 1),
          (assign, "$g_formation_group5_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check5", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but5", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group6_has_troops", 1),
          (assign, "$g_formation_group6_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check6", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but6", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group7_has_troops", 1),
          (assign, "$g_formation_group7_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check7", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but7", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group8_has_troops", 1),
          (assign, "$g_formation_group8_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check8", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but8", 250, 0),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_battle_but3"),
        (assign, ":var4", 1),
        (assign, "$g_formation_group3_selected", 1),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but3", 250, 68),
        (overlay_set_val, "$g_presentation_obj_battle_check3", 1),
        (try_begin),
          (eq, "$group0_has_troops", 1),
          (assign, "$g_formation_group0_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check0", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but0", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group1_has_troops", 1),
          (assign, "$g_formation_group1_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check1", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but1", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group2_has_troops", 1),
          (assign, "$g_formation_group2_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check2", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but2", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group4_has_troops", 1),
          (assign, "$g_formation_group4_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check4", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but4", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group5_has_troops", 1),
          (assign, "$g_formation_group5_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check5", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but5", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group6_has_troops", 1),
          (assign, "$g_formation_group6_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check6", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but6", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group7_has_troops", 1),
          (assign, "$g_formation_group7_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check7", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but7", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group8_has_troops", 1),
          (assign, "$g_formation_group8_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check8", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but8", 250, 0),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_battle_but4"),
        (assign, ":var4", 1),
        (assign, "$g_formation_group4_selected", 1),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but4", 250, 68),
        (overlay_set_val, "$g_presentation_obj_battle_check4", 1),
        (try_begin),
          (eq, "$group0_has_troops", 1),
          (assign, "$g_formation_group0_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check0", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but0", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group1_has_troops", 1),
          (assign, "$g_formation_group1_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check1", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but1", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group2_has_troops", 1),
          (assign, "$g_formation_group2_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check2", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but2", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group3_has_troops", 1),
          (assign, "$g_formation_group3_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check3", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but3", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group5_has_troops", 1),
          (assign, "$g_formation_group5_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check5", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but5", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group6_has_troops", 1),
          (assign, "$g_formation_group6_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check6", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but6", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group7_has_troops", 1),
          (assign, "$g_formation_group7_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check7", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but7", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group8_has_troops", 1),
          (assign, "$g_formation_group8_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check8", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but8", 250, 0),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_battle_but5"),
        (assign, ":var4", 1),
        (assign, "$g_formation_group5_selected", 1),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but5", 250, 68),
        (overlay_set_val, "$g_presentation_obj_battle_check5", 1),
        (try_begin),
          (eq, "$group0_has_troops", 1),
          (assign, "$g_formation_group0_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check0", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but0", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group1_has_troops", 1),
          (assign, "$g_formation_group1_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check1", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but1", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group2_has_troops", 1),
          (assign, "$g_formation_group2_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check2", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but2", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group3_has_troops", 1),
          (assign, "$g_formation_group3_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check3", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but3", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group4_has_troops", 1),
          (assign, "$g_formation_group4_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check4", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but4", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group6_has_troops", 1),
          (assign, "$g_formation_group6_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check6", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but6", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group7_has_troops", 1),
          (assign, "$g_formation_group7_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check7", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but7", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group8_has_troops", 1),
          (assign, "$g_formation_group8_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check8", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but8", 250, 0),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_battle_but6"),
        (assign, ":var4", 1),
        (assign, "$g_formation_group6_selected", 1),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but6", 250, 68),
        (overlay_set_val, "$g_presentation_obj_battle_check6", 1),
        (try_begin),
          (eq, "$group0_has_troops", 1),
          (assign, "$g_formation_group0_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check0", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but0", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group1_has_troops", 1),
          (assign, "$g_formation_group1_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check1", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but1", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group2_has_troops", 1),
          (assign, "$g_formation_group2_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check2", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but2", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group3_has_troops", 1),
          (assign, "$g_formation_group3_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check3", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but3", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group4_has_troops", 1),
          (assign, "$g_formation_group4_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check4", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but4", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group5_has_troops", 1),
          (assign, "$g_formation_group5_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check5", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but5", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group7_has_troops", 1),
          (assign, "$g_formation_group7_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check7", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but7", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group8_has_troops", 1),
          (assign, "$g_formation_group8_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check8", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but8", 250, 0),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_battle_but7"),
        (assign, ":var4", 1),
        (assign, "$g_formation_group7_selected", 1),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but7", 250, 68),
        (overlay_set_val, "$g_presentation_obj_battle_check7", 1),
        (try_begin),
          (eq, "$group0_has_troops", 1),
          (assign, "$g_formation_group0_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check0", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but0", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group1_has_troops", 1),
          (assign, "$g_formation_group1_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check1", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but1", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group2_has_troops", 1),
          (assign, "$g_formation_group2_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check2", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but2", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group3_has_troops", 1),
          (assign, "$g_formation_group3_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check3", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but3", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group4_has_troops", 1),
          (assign, "$g_formation_group4_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check4", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but4", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group5_has_troops", 1),
          (assign, "$g_formation_group5_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check5", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but5", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group6_has_troops", 1),
          (assign, "$g_formation_group6_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check6", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but6", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group8_has_troops", 1),
          (assign, "$g_formation_group8_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check8", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but8", 250, 0),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_battle_but8"),
        (assign, ":var4", 1),
        (assign, "$g_formation_group8_selected", 1),
        (overlay_animate_to_alpha, "$g_presentation_obj_battle_but8", 250, 68),
        (overlay_set_val, "$g_presentation_obj_battle_check8", 1),
        (try_begin),
          (eq, "$group0_has_troops", 1),
          (assign, "$g_formation_group0_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check0", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but0", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group1_has_troops", 1),
          (assign, "$g_formation_group1_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check1", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but1", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group2_has_troops", 1),
          (assign, "$g_formation_group2_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check2", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but2", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group3_has_troops", 1),
          (assign, "$g_formation_group3_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check3", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but3", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group4_has_troops", 1),
          (assign, "$g_formation_group4_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check4", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but4", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group5_has_troops", 1),
          (assign, "$g_formation_group5_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check5", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but5", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group6_has_troops", 1),
          (assign, "$g_formation_group6_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check6", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but6", 250, 0),
        (try_end),
        (try_begin),
          (eq, "$group7_has_troops", 1),
          (assign, "$g_formation_group7_selected", 0),
          (overlay_set_val, "$g_presentation_obj_battle_check7", 0),
          (overlay_animate_to_alpha, "$g_presentation_obj_battle_but7", 250, 0),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_battle_14"),
        (call_script, "script_team_give_order_from_order_panel", ":var2", 8),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_battle_15"),
        (call_script, "script_team_give_order_from_order_panel", ":var2", 7),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_battle_16"),
        (call_script, "script_team_give_order_from_order_panel", ":var2", 6),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_battle_17"),
        (call_script, "script_team_give_order_from_order_panel", ":var2", 5),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_battle_10"),
        (try_begin),
          (eq, ":var1", 3),
          (call_script, "script_team_give_order_from_order_panel", ":var2", 0),
          (call_script, "script_update_order_panel", ":var3"),
          (assign, "$g_latest_order_1", 3),
        (else_try),
          (eq, ":var1", 2),
          (call_script, "script_team_give_order_from_order_panel", ":var2", 1),
          (call_script, "script_update_order_panel", ":var3"),
          (assign, "$g_latest_order_1", 2),
        (else_try),
          (eq, ":var1", 1),
          (call_script, "script_team_give_order_from_order_panel", ":var2", 2),
          (call_script, "script_update_order_panel", ":var3"),
          (assign, "$g_latest_order_1", 1),
        (else_try),
          (eq, ":var1", 0),
          (call_script, "script_team_give_order_from_order_panel", ":var2", 11),
          (call_script, "script_update_order_panel", ":var3"),
          (assign, "$g_latest_order_1", 0),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_battle_11"),
        (try_begin),
          (eq, ":var1", 1),
          (call_script, "script_team_give_order_from_order_panel", ":var2", 3),
          (call_script, "script_update_order_panel", ":var3"),
          (assign, "$g_latest_order_2", 1),
        (else_try),
          (eq, ":var1", 0),
          (call_script, "script_team_give_order_from_order_panel", ":var2", 4),
          (call_script, "script_update_order_panel", ":var3"),
          (assign, "$g_latest_order_2", 0),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_battle_12"),
        (try_begin),
          (eq, ":var1", 1),
          (call_script, "script_team_give_order_from_order_panel", ":var2", 12),
          (call_script, "script_update_order_panel", ":var3"),
          (assign, "$g_latest_order_3", 1),
        (else_try),
          (eq, ":var1", 0),
          (call_script, "script_team_give_order_from_order_panel", ":var2", 13),
          (call_script, "script_update_order_panel", ":var3"),
          (assign, "$g_latest_order_3", 0),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_battle_13"),
        (try_begin),
          (eq, ":var1", 1),
          (call_script, "script_team_give_order_from_order_panel", ":var2", 10),
          (call_script, "script_update_order_panel", ":var3"),
          (assign, "$g_latest_order_4", 1),
        (else_try),
          (eq, ":var1", 0),
          (call_script, "script_team_give_order_from_order_panel", ":var2", 9),
          (call_script, "script_update_order_panel", ":var3"),
          (assign, "$g_latest_order_4", 0),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_battle_map_plane"),
        (get_scene_boundaries, pos2, pos3),
        (mouse_get_position, pos1),
        (set_fixed_point_multiplier, 1000),
        (position_get_x, ":var5", pos1),
        (position_get_y, ":var6", pos1),
        (store_sub, ":var7", 980, "$g_battle_map_width"),
        (store_sub, ":var8", 730, "$g_battle_map_height"),
        (val_sub, ":var5", ":var7"),
        (val_sub, ":var6", ":var8"),
        (val_clamp, ":var5", 0, "$g_battle_map_width"),
        (val_clamp, ":var6", 0, "$g_battle_map_height"),
        (val_mul, ":var5", "$g_battle_map_scale"),
        (val_mul, ":var6", "$g_battle_map_scale"),
        (set_fixed_point_multiplier, 1000),
        (position_set_x, pos1, ":var5"),
        (position_set_y, pos1, ":var6"),
        (position_transform_position_to_local, pos3, pos2, pos1),
        (try_begin),
          (eq, "$g_formation_group0_selected", 1),
          (team_give_order, ":var3", 0, 0),
          (team_set_order_position, ":var3", 0, pos3),
        (try_end),
        (try_begin),
          (eq, "$g_formation_group1_selected", 1),
          (team_give_order, ":var3", 1, 0),
          (team_set_order_position, ":var3", 1, pos3),
        (try_end),
        (try_begin),
          (eq, "$g_formation_group2_selected", 1),
          (team_give_order, ":var3", 2, 0),
          (team_set_order_position, ":var3", 2, pos3),
        (try_end),
        (try_begin),
          (eq, "$g_formation_group3_selected", 1),
          (team_give_order, ":var3", 3, 0),
          (team_set_order_position, ":var3", 3, pos3),
        (try_end),
        (try_begin),
          (eq, "$g_formation_group4_selected", 1),
          (team_give_order, ":var3", 4, 0),
          (team_set_order_position, ":var3", 4, pos3),
        (try_end),
        (try_begin),
          (eq, "$g_formation_group5_selected", 1),
          (team_give_order, ":var3", 5, 0),
          (team_set_order_position, ":var3", 5, pos3),
        (try_end),
        (try_begin),
          (eq, "$g_formation_group6_selected", 1),
          (team_give_order, ":var3", 6, 0),
          (team_set_order_position, ":var3", 6, pos3),
        (try_end),
        (try_begin),
          (eq, "$g_formation_group7_selected", 1),
          (team_give_order, ":var3", 7, 0),
          (team_set_order_position, ":var3", 7, pos3),
        (try_end),
        (try_begin),
          (eq, "$g_formation_group8_selected", 1),
          (team_give_order, ":var3", 8, 0),
          (team_set_order_position, ":var3", 8, pos3),
        (try_end),
        (try_begin),
          (eq, "$g_option_formations", 1),
          (eq, "$g_disciplined_faction", 1),
          (assign, ":var9", 1),
          (convert_to_fixed_point, ":var9"),
          (set_fixed_point_multiplier, 100),
          (call_script, "script_team_get_average_position_of_enemies_augmented", 60, "$fplayer_team_no", 9),
          (call_script, "script_point_y_toward_position", 3, 60),
          (try_begin),
            (eq, "$g_formation_group0_selected", 1),
            (neq, "$infantry_formation_type", 0),
            (assign, ":var10", 0),
            (try_for_agents, reg0),
              (call_script, "script_cf_valid_formation_member", "$fplayer_team_no", 0, "$fplayer_agent_no", reg0),
              (val_add, ":var10", 1),
            (try_end),
            (call_script, "script_get_centering_amount", "$infantry_formation_type", ":var10", "$infantry_space"),
            (copy_position, pos1, pos3),
            (position_move_x, pos1, reg0),
            (call_script, "script_set_formation_position", "$fplayer_team_no", 0, 1),
            (call_script, "script_form_infantry", "$fplayer_team_no", "$fplayer_agent_no", "$infantry_space", "$infantry_formation_type"),
            (assign, "$infantry_formation_move_order", 0),
          (try_end),
          (try_begin),
            (eq, "$g_formation_group1_selected", 1),
            (neq, "$archer_formation_type", 0),
            (assign, ":var10", 0),
            (try_for_agents, reg0),
              (call_script, "script_cf_valid_formation_member", "$fplayer_team_no", 1, "$fplayer_agent_no", reg0),
              (val_add, ":var10", 1),
            (try_end),
            (call_script, "script_get_centering_amount", 1, ":var10", "$archer_space"),
            (val_mul, reg0, -1),
            (copy_position, pos1, pos3),
            (position_move_x, pos1, reg0),
            (call_script, "script_set_formation_position", "$fplayer_team_no", 1, 1),
            (call_script, "script_form_archers", "$fplayer_team_no", "$fplayer_agent_no", "$archer_space", "$archer_formation_type"),
            (assign, "$archer_formation_move_order", 0),
          (try_end),
          (try_begin),
            (eq, "$g_formation_group2_selected", 1),
            (neq, "$cavalry_formation_type", 0),
            (copy_position, pos1, pos3),
            (call_script, "script_set_formation_position", "$fplayer_team_no", 2, 1),
            (call_script, "script_form_cavalry", "$fplayer_team_no", "$fplayer_agent_no", "$cavalry_space"),
            (assign, "$cavalry_formation_move_order", 0),
          (try_end),
          (set_fixed_point_multiplier, ":var9"),
        (try_end),
        (call_script, "script_update_order_flags_on_map"),
        (call_script, "script_update_order_panel", ":var3"),
      (try_end),
      (try_begin),
        (eq, ":var4", 1),
        (team_set_order_listener, ":var3", -1),
        (try_begin),
          (this_or_next|eq, "$g_formation_group0_selected", 1),
          (eq, "$group0_has_troops", 0),
          (this_or_next|eq, "$g_formation_group1_selected", 1),
          (eq, "$group1_has_troops", 0),
          (this_or_next|eq, "$g_formation_group2_selected", 1),
          (eq, "$group2_has_troops", 0),
          (this_or_next|eq, "$g_formation_group3_selected", 1),
          (eq, "$group3_has_troops", 0),
          (this_or_next|eq, "$g_formation_group4_selected", 1),
          (eq, "$group4_has_troops", 0),
          (this_or_next|eq, "$g_formation_group5_selected", 1),
          (eq, "$group5_has_troops", 0),
          (this_or_next|eq, "$g_formation_group6_selected", 1),
          (eq, "$group6_has_troops", 0),
          (this_or_next|eq, "$g_formation_group7_selected", 1),
          (eq, "$group7_has_troops", 0),
          (this_or_next|eq, "$g_formation_group8_selected", 1),
          (eq, "$group8_has_troops", 0),
          (team_set_order_listener, ":var3", 9),
        (else_try),
          (eq, "$g_formation_group0_selected", 1),
          (team_set_order_listener, ":var3", 0, 1),
        (else_try),
          (eq, "$g_formation_group1_selected", 1),
          (team_set_order_listener, ":var3", 1, 1),
        (else_try),
          (eq, "$g_formation_group2_selected", 1),
          (team_set_order_listener, ":var3", 2, 1),
        (else_try),
          (eq, "$g_formation_group3_selected", 1),
          (team_set_order_listener, ":var3", 3, 1),
        (else_try),
          (eq, "$g_formation_group4_selected", 1),
          (team_set_order_listener, ":var3", 4, 1),
        (else_try),
          (eq, "$g_formation_group5_selected", 1),
          (team_set_order_listener, ":var3", 5, 1),
        (else_try),
          (eq, "$g_formation_group6_selected", 1),
          (team_set_order_listener, ":var3", 6, 1),
        (else_try),
          (eq, "$g_formation_group7_selected", 1),
          (team_set_order_listener, ":var3", 7, 1),
        (else_try),
          (eq, "$g_formation_group8_selected", 1),
          (team_set_order_listener, ":var3", 8, 1),
        (try_end),
      (try_end),
    ]),
    (ti_on_presentation_mouse_enter_leave,
    [
      (store_trigger_param_1, ":var0"),
      (store_trigger_param_2, ":var1"),
      (try_begin),
        (eq, ":var0", "$g_presentation_obj_battle_but0"),
        (try_begin),
          (eq, ":var1", 0),
          (overlay_animate_to_color, "$g_presentation_but0_movement", 250, 16777215),
          (overlay_animate_to_color, "$g_presentation_but0_riding", 250, 16777215),
          (overlay_animate_to_color, "$g_presentation_but0_weapon_usage", 250, 16777215),
          (overlay_animate_to_color, "$g_presentation_obj_battle_name0", 250, 16777215),
        (else_try),
          (overlay_animate_to_color, "$g_presentation_but0_movement", 250, 0),
          (overlay_animate_to_color, "$g_presentation_but0_riding", 250, 0),
          (overlay_animate_to_color, "$g_presentation_but0_weapon_usage", 250, 0),
          (overlay_animate_to_color, "$g_presentation_obj_battle_name0", 250, 0),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_battle_but1"),
        (try_begin),
          (eq, ":var1", 0),
          (overlay_animate_to_color, "$g_presentation_but1_movement", 250, 16777215),
          (overlay_animate_to_color, "$g_presentation_but1_riding", 250, 16777215),
          (overlay_animate_to_color, "$g_presentation_but1_weapon_usage", 250, 16777215),
          (overlay_animate_to_color, "$g_presentation_obj_battle_name1", 250, 16777215),
        (else_try),
          (overlay_animate_to_color, "$g_presentation_but1_movement", 250, 0),
          (overlay_animate_to_color, "$g_presentation_but1_riding", 250, 0),
          (overlay_animate_to_color, "$g_presentation_but1_weapon_usage", 250, 0),
          (overlay_animate_to_color, "$g_presentation_obj_battle_name1", 250, 0),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_battle_but2"),
        (try_begin),
          (eq, ":var1", 0),
          (overlay_animate_to_color, "$g_presentation_but2_movement", 250, 16777215),
          (overlay_animate_to_color, "$g_presentation_but2_riding", 250, 16777215),
          (overlay_animate_to_color, "$g_presentation_but2_weapon_usage", 250, 16777215),
          (overlay_animate_to_color, "$g_presentation_obj_battle_name2", 250, 16777215),
        (else_try),
          (overlay_animate_to_color, "$g_presentation_but2_movement", 250, 0),
          (overlay_animate_to_color, "$g_presentation_but2_riding", 250, 0),
          (overlay_animate_to_color, "$g_presentation_but2_weapon_usage", 250, 0),
          (overlay_animate_to_color, "$g_presentation_obj_battle_name2", 250, 0),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_battle_but3"),
        (try_begin),
          (eq, ":var1", 0),
          (overlay_animate_to_color, "$g_presentation_but3_movement", 250, 16777215),
          (overlay_animate_to_color, "$g_presentation_but3_riding", 250, 16777215),
          (overlay_animate_to_color, "$g_presentation_but3_weapon_usage", 250, 16777215),
          (overlay_animate_to_color, "$g_presentation_obj_battle_name3", 250, 16777215),
        (else_try),
          (overlay_animate_to_color, "$g_presentation_but3_movement", 250, 0),
          (overlay_animate_to_color, "$g_presentation_but3_riding", 250, 0),
          (overlay_animate_to_color, "$g_presentation_but3_weapon_usage", 250, 0),
          (overlay_animate_to_color, "$g_presentation_obj_battle_name3", 250, 0),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_battle_but4"),
        (try_begin),
          (eq, ":var1", 0),
          (overlay_animate_to_color, "$g_presentation_but4_movement", 250, 16777215),
          (overlay_animate_to_color, "$g_presentation_but4_riding", 250, 16777215),
          (overlay_animate_to_color, "$g_presentation_but4_weapon_usage", 250, 16777215),
          (overlay_animate_to_color, "$g_presentation_obj_battle_name4", 250, 16777215),
        (else_try),
          (overlay_animate_to_color, "$g_presentation_but4_movement", 250, 0),
          (overlay_animate_to_color, "$g_presentation_but4_riding", 250, 0),
          (overlay_animate_to_color, "$g_presentation_but4_weapon_usage", 250, 0),
          (overlay_animate_to_color, "$g_presentation_obj_battle_name4", 250, 0),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_battle_but5"),
        (try_begin),
          (eq, ":var1", 0),
          (overlay_animate_to_color, "$g_presentation_but5_movement", 250, 16777215),
          (overlay_animate_to_color, "$g_presentation_but5_riding", 250, 16777215),
          (overlay_animate_to_color, "$g_presentation_but5_weapon_usage", 250, 16777215),
          (overlay_animate_to_color, "$g_presentation_obj_battle_name5", 250, 16777215),
        (else_try),
          (overlay_animate_to_color, "$g_presentation_but5_movement", 250, 0),
          (overlay_animate_to_color, "$g_presentation_but5_riding", 250, 0),
          (overlay_animate_to_color, "$g_presentation_but5_weapon_usage", 250, 0),
          (overlay_animate_to_color, "$g_presentation_obj_battle_name5", 250, 0),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_battle_but6"),
        (try_begin),
          (eq, ":var1", 0),
          (overlay_animate_to_color, "$g_presentation_but6_movement", 250, 16777215),
          (overlay_animate_to_color, "$g_presentation_but6_riding", 250, 16777215),
          (overlay_animate_to_color, "$g_presentation_but6_weapon_usage", 250, 16777215),
          (overlay_animate_to_color, "$g_presentation_obj_battle_name6", 250, 16777215),
        (else_try),
          (overlay_animate_to_color, "$g_presentation_but6_movement", 250, 0),
          (overlay_animate_to_color, "$g_presentation_but6_riding", 250, 0),
          (overlay_animate_to_color, "$g_presentation_but6_weapon_usage", 250, 0),
          (overlay_animate_to_color, "$g_presentation_obj_battle_name6", 250, 0),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_battle_but7"),
        (try_begin),
          (eq, ":var1", 0),
          (overlay_animate_to_color, "$g_presentation_but7_movement", 250, 16777215),
          (overlay_animate_to_color, "$g_presentation_but7_riding", 250, 16777215),
          (overlay_animate_to_color, "$g_presentation_but7_weapon_usage", 250, 16777215),
          (overlay_animate_to_color, "$g_presentation_obj_battle_name7", 250, 16777215),
        (else_try),
          (overlay_animate_to_color, "$g_presentation_but7_movement", 250, 0),
          (overlay_animate_to_color, "$g_presentation_but7_riding", 250, 0),
          (overlay_animate_to_color, "$g_presentation_but7_weapon_usage", 250, 0),
          (overlay_animate_to_color, "$g_presentation_obj_battle_name7", 250, 0),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_battle_but8"),
        (try_begin),
          (eq, ":var1", 0),
          (overlay_animate_to_color, "$g_presentation_but8_movement", 250, 16777215),
          (overlay_animate_to_color, "$g_presentation_but8_riding", 250, 16777215),
          (overlay_animate_to_color, "$g_presentation_but8_weapon_usage", 250, 16777215),
          (overlay_animate_to_color, "$g_presentation_obj_battle_name8", 250, 16777215),
        (else_try),
          (overlay_animate_to_color, "$g_presentation_but8_movement", 250, 0),
          (overlay_animate_to_color, "$g_presentation_but8_riding", 250, 0),
          (overlay_animate_to_color, "$g_presentation_but8_weapon_usage", 250, 0),
          (overlay_animate_to_color, "$g_presentation_obj_battle_name8", 250, 0),
        (try_end),
      (try_end),
    ]),
    (ti_on_presentation_run,
    [
      (store_trigger_param_1, ":var0"),
      (try_begin),
        (this_or_next|game_key_clicked, 30),
        (this_or_next|game_key_clicked, 31),
        (this_or_next|game_key_clicked, 32),
        (this_or_next|game_key_clicked, 33),
        (this_or_next|game_key_clicked, 34),
        (this_or_next|game_key_clicked, 35),
        (this_or_next|game_key_clicked, 36),
        (this_or_next|game_key_clicked, 37),
        (this_or_next|game_key_clicked, 38),
        (this_or_next|game_key_clicked, 29),
        (game_key_clicked, 39),
        (call_script, "script_update_order_panel_checked_classes"),
      (try_end),
      (try_begin),
        (this_or_next|game_key_clicked, 23),
        (this_or_next|game_key_clicked, 24),
        (this_or_next|game_key_clicked, 25),
        (this_or_next|game_key_clicked, 26),
        (this_or_next|game_key_clicked, 27),
        (game_key_clicked, 28),
        (get_player_agent_no, ":var1"),
        (agent_get_team, ":var2", ":var1"),
        (call_script, "script_update_order_panel", ":var2"),
      (try_end),
      (try_begin),
        (gt, ":var0", 200),
        (game_key_clicked, 22),
        (try_for_agents, ":var3"),
          (agent_set_slot, ":var3", 10, 0),
        (try_end),
        (presentation_set_duration, 0),
        (try_begin),
          (eq, "$g_option_show_killcount", 1),
          (eq, "$g_option_show_ratio_bar", 0),
          (start_presentation, "prsnt_killcount"),
        (else_try),
          (eq, "$g_option_show_killcount", 0),
          (eq, "$g_option_show_ratio_bar", 1),
          (start_presentation, "prsnt_troop_ratio_bar"),
        (else_try),
          (eq, "$g_option_show_killcount", 1),
          (eq, "$g_option_show_ratio_bar", 1),
          (start_presentation, "prsnt_killcount_and_troop_ratio_bar"),
        (try_end),
      (try_end),
    ]),
  ]),

  ("sliders", 0, mesh_null,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (create_slider_overlay, "$g_presentation_obj_sliders_1", 0, 100),
      (create_slider_overlay, "$g_presentation_obj_sliders_2", 0, 100),
      (create_slider_overlay, "$g_presentation_obj_sliders_3", 0, 100),
      (create_slider_overlay, "$g_presentation_obj_sliders_4", 0, 100),
      (assign, reg1, 25),
      (str_store_string, s1, "str_reg1"),
      (create_text_overlay, "$g_presentation_obj_sliders_5", s1),
      (create_text_overlay, "$g_presentation_obj_sliders_6", s1),
      (create_text_overlay, "$g_presentation_obj_sliders_7", s1),
      (create_text_overlay, "$g_presentation_obj_sliders_8", s1),
      (assign, "$g_presentation_obj_sliders_1_val", 25),
      (overlay_set_val, "$g_presentation_obj_sliders_1", 25),
      (assign, "$g_presentation_obj_sliders_2_val", 25),
      (overlay_set_val, "$g_presentation_obj_sliders_2", 25),
      (assign, "$g_presentation_obj_sliders_3_val", 25),
      (overlay_set_val, "$g_presentation_obj_sliders_3", 25),
      (assign, "$g_presentation_obj_sliders_4_val", 25),
      (overlay_set_val, "$g_presentation_obj_sliders_4", 25),
      (position_set_x, pos1, 600),
      (position_set_y, pos1, 200),
      (overlay_set_position, "$g_presentation_obj_sliders_1", pos1),
      (position_set_y, pos1, 300),
      (overlay_set_position, "$g_presentation_obj_sliders_2", pos1),
      (position_set_y, pos1, 400),
      (overlay_set_position, "$g_presentation_obj_sliders_3", pos1),
      (position_set_y, pos1, 500),
      (overlay_set_position, "$g_presentation_obj_sliders_4", pos1),
      (position_set_x, pos1, 800),
      (position_set_y, pos1, 200),
      (overlay_set_position, "$g_presentation_obj_sliders_5", pos1),
      (position_set_y, pos1, 300),
      (overlay_set_position, "$g_presentation_obj_sliders_6", pos1),
      (position_set_y, pos1, 400),
      (overlay_set_position, "$g_presentation_obj_sliders_7", pos1),
      (position_set_y, pos1, 500),
      (overlay_set_position, "$g_presentation_obj_sliders_8", pos1),
      (position_set_x, pos1, 500),
      (overlay_set_size, "$g_presentation_obj_sliders_3", pos1),
    ]),
    (ti_on_presentation_run,
    [
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (store_trigger_param_2, ":var1"),
      (assign, ":var2", 0),
      (try_begin),
        (eq, ":var0", "$g_presentation_obj_sliders_1"),
        (try_begin),
          (neq, "$g_presentation_obj_sliders_1_val", ":var1"),
          (assign, "$g_presentation_obj_sliders_1_val", ":var1"),
          (assign, ":var2", 1),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_sliders_2"),
        (try_begin),
          (neq, "$g_presentation_obj_sliders_2_val", ":var1"),
          (assign, "$g_presentation_obj_sliders_2_val", ":var1"),
          (assign, ":var2", 1),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_sliders_3"),
        (try_begin),
          (neq, "$g_presentation_obj_sliders_3_val", ":var1"),
          (assign, "$g_presentation_obj_sliders_3_val", ":var1"),
          (assign, ":var2", 1),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_sliders_4"),
        (try_begin),
          (neq, "$g_presentation_obj_sliders_4_val", ":var1"),
          (assign, "$g_presentation_obj_sliders_4_val", ":var1"),
          (assign, ":var2", 1),
        (try_end),
      (try_end),
      (try_begin),
        (eq, ":var2", 1),
        (assign, ":var3", 0),
        (val_add, ":var3", "$g_presentation_obj_sliders_1_val"),
        (val_add, ":var3", "$g_presentation_obj_sliders_2_val"),
        (val_add, ":var3", "$g_presentation_obj_sliders_3_val"),
        (val_add, ":var3", "$g_presentation_obj_sliders_4_val"),
        (store_sub, ":var4", 100, ":var3"),
        (assign, ":var5", "$g_presentation_obj_sliders_1_val"),
        (assign, ":var6", "$g_presentation_obj_sliders_2_val"),
        (assign, ":var7", "$g_presentation_obj_sliders_3_val"),
        (assign, ":var8", "$g_presentation_obj_sliders_4_val"),
        (assign, ":var9", 1),
        (assign, ":var10", 0),
        (assign, ":var11", 100),
        (try_begin),
          (lt, ":var4", 0),
          (val_mul, ":var4", -1),
          (assign, ":var9", -1),
          (assign, ":var10", 1),
          (assign, ":var11", 101),
        (try_end),
        (store_sub, ":var12", ":var3", ":var1"),
        (val_add, ":var12", 30),
        (try_for_range, ":var13", 0, ":var4"),
          (store_random_in_range, ":var14", 0, ":var12"),
          (try_begin),
            (neq, ":var0", "$g_presentation_obj_sliders_1"),
            (val_sub, ":var14", "$g_presentation_obj_sliders_1_val"),
            (val_sub, ":var14", 10),
            (lt, ":var14", 0),
            (is_between, ":var5", ":var10", ":var11"),
            (val_add, ":var5", ":var9"),
          (else_try),
            (neq, ":var0", "$g_presentation_obj_sliders_2"),
            (val_sub, ":var14", "$g_presentation_obj_sliders_2_val"),
            (val_sub, ":var14", 10),
            (lt, ":var14", 0),
            (is_between, ":var6", ":var10", ":var11"),
            (val_add, ":var6", ":var9"),
          (else_try),
            (neq, ":var0", "$g_presentation_obj_sliders_3"),
            (val_sub, ":var14", "$g_presentation_obj_sliders_3_val"),
            (val_sub, ":var14", 10),
            (lt, ":var14", 0),
            (is_between, ":var7", ":var10", ":var11"),
            (val_add, ":var7", ":var9"),
          (else_try),
            (is_between, ":var8", ":var10", ":var11"),
            (val_add, ":var8", ":var9"),
          (else_try),
            (val_add, ":var4", 1),
          (try_end),
        (try_end),
        (assign, "$g_presentation_obj_sliders_1_val", ":var5"),
        (assign, "$g_presentation_obj_sliders_2_val", ":var6"),
        (assign, "$g_presentation_obj_sliders_3_val", ":var7"),
        (assign, "$g_presentation_obj_sliders_4_val", ":var8"),
      (try_end),
      (overlay_set_val, "$g_presentation_obj_sliders_1", "$g_presentation_obj_sliders_1_val"),
      (overlay_set_val, "$g_presentation_obj_sliders_2", "$g_presentation_obj_sliders_2_val"),
      (overlay_set_val, "$g_presentation_obj_sliders_3", "$g_presentation_obj_sliders_3_val"),
      (overlay_set_val, "$g_presentation_obj_sliders_4", "$g_presentation_obj_sliders_4_val"),
      (assign, reg1, "$g_presentation_obj_sliders_1_val"),
      (str_store_string, s1, "str_reg1"),
      (overlay_set_text, "$g_presentation_obj_sliders_5", s1),
      (assign, reg1, "$g_presentation_obj_sliders_2_val"),
      (str_store_string, s1, "str_reg1"),
      (overlay_set_text, "$g_presentation_obj_sliders_6", s1),
      (assign, reg1, "$g_presentation_obj_sliders_3_val"),
      (str_store_string, s1, "str_reg1"),
      (overlay_set_text, "$g_presentation_obj_sliders_7", s1),
      (assign, reg1, "$g_presentation_obj_sliders_4_val"),
      (str_store_string, s1, "str_reg1"),
      (overlay_set_text, "$g_presentation_obj_sliders_8", s1),
    ]),
  ]),

  ("arena_training", prsntf_read_only|prsntf_manual_end_only, mesh_null,
  [
    (ti_on_presentation_load,
    [
      (presentation_set_duration, 999999),
      (set_fixed_point_multiplier, 1000),
      (get_player_agent_no, ":var0"),
      (agent_get_kill_count, reg1, ":var0", 1),
      (str_store_string, s1, "@Opponents knocked down: {reg1}"),
      (create_text_overlay, "$g_presentation_obj_arena_training_1", s1),
      (overlay_set_color, "$g_presentation_obj_arena_training_1", 16777215),
      (position_set_x, pos1, 10),
      (position_set_y, pos1, 700),
      (overlay_set_position, "$g_presentation_obj_arena_training_1", pos1),
      (assign, reg1, 0),
      (str_store_string, s1, "@Opponents left: {reg1}"),
      (create_text_overlay, "$g_presentation_obj_arena_training_2", s1),
      (overlay_set_color, "$g_presentation_obj_arena_training_2", 16777215),
      (position_set_x, pos1, 10),
      (position_set_y, pos1, 670),
      (overlay_set_position, "$g_presentation_obj_arena_training_2", pos1),
    ]),
    (ti_on_presentation_run,
    [
      (get_player_agent_no, ":var0"),
      (agent_get_kill_count, reg1, ":var0", 1),
      (str_store_string, s1, "@Opponents beaten: {reg1}"),
      (overlay_set_text, "$g_presentation_obj_arena_training_1", s1),
      (assign, ":var1", "$g_arena_training_max_opponents"),
      (try_for_agents, ":var2"),
        (agent_is_human, ":var2"),
        (neg|agent_is_alive, ":var2"),
        (neq, ":var2", ":var0"),
        (val_sub, ":var1", 1),
      (try_end),
      (assign, reg1, ":var1"),
      (str_store_string, s1, "@Opponents remaining: {reg1}"),
      (overlay_set_text, "$g_presentation_obj_arena_training_2", s1),
    ]),
  ]),

  ("retirement", 0, mesh_load_window,
  [
    (ti_on_presentation_load,
    [
      (presentation_set_duration, 999999),
      (set_fixed_point_multiplier, 1000),
      (create_button_overlay, "$g_presentation_obj_retirement_1", "@Remain in retirement.", 16),
      (create_button_overlay, "$g_presentation_obj_retirement_2", "@Go back to the adventuring.", 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 80),
      (overlay_set_position, "$g_presentation_obj_retirement_1", pos1),
      (position_set_y, pos1, 40),
      (overlay_set_position, "$g_presentation_obj_retirement_2", pos1),
      (assign, ":var0", 0),
      (store_troop_gold, ":var1", "trp_player"),
      (store_div, ":var2", ":var1", 200),
      (val_add, ":var0", ":var2"),
      (assign, ":var3", 0),
      (assign, ":var4", 0),
      (assign, ":var5", 0),
      (assign, ":var6", 0),
      (assign, ":var7", 0),
      (assign, ":var8", 0),
      (assign, ":var9", 0),
      (try_for_range, ":var10", "p_town_1", "p_salt_mine"),
        (party_get_slot, ":var11", ":var10", 0),
        (try_begin),
          (party_slot_eq, ":var10", 7, "trp_player"),
          (try_begin),
            (eq, ":var11", 3),
            (val_add, ":var3", 1),
          (else_try),
            (eq, ":var11", 2),
            (val_add, ":var4", 1),
          (else_try),
            (val_add, ":var5", 1),
          (try_end),
        (try_end),
        (party_get_slot, ":var12", ":var10", 26),
        (try_begin),
          (ge, ":var12", 40),
          (try_begin),
            (eq, ":var11", 3),
            (val_add, ":var6", 1),
          (else_try),
            (eq, ":var11", 4),
            (val_add, ":var7", 1),
          (try_end),
        (else_try),
          (le, ":var12", -40),
          (try_begin),
            (eq, ":var11", 3),
            (val_add, ":var8", 1),
          (else_try),
            (eq, ":var11", 4),
            (val_add, ":var9", 1),
          (try_end),
        (try_end),
      (try_end),
      (store_mul, ":var13", ":var3", 100),
      (store_mul, ":var14", ":var4", 50),
      (store_mul, ":var15", ":var5", 20),
      (store_add, ":var16", ":var3", ":var4"),
      (val_add, ":var16", ":var5"),
      (store_add, ":var17", ":var13", ":var14"),
      (val_add, ":var17", ":var15"),
      (val_add, ":var0", ":var17"),
      (store_mul, ":var18", ":var6", 20),
      (store_mul, ":var19", ":var7", 4),
      (store_add, ":var20", ":var6", ":var7"),
      (store_add, ":var21", ":var18", ":var19"),
      (val_add, ":var0", ":var21"),
      (store_mul, ":var22", ":var8", -40),
      (store_mul, ":var23", ":var9", -8),
      (store_add, ":var24", ":var8", ":var9"),
      (store_add, ":var25", ":var22", ":var23"),
      (val_add, ":var0", ":var25"),
      (assign, ":var26", 0),
      (troop_get_inventory_capacity, ":var27", "trp_player"),
      (try_for_range, ":var28", 0, ":var27"),
        (troop_get_inventory_slot, ":var29", "trp_player", ":var28"),
        (ge, ":var29", 0),
        (store_item_value, ":var30", ":var29"),
        (val_add, ":var26", ":var30"),
      (try_end),
      (store_div, ":var31", ":var26", 200),
      (val_add, ":var0", ":var31"),
      (troop_get_slot, ":var32", "trp_player", 7),
      (store_div, ":var33", ":var32", 1),
      (val_add, ":var0", ":var33"),
      (assign, ":var34", 0),
      (assign, ":var35", 0),
      (try_for_range, ":var36", "trp_npc_adonja", "trp_heroes_end"),
        (this_or_next|troop_slot_eq, ":var36", 2, 2),
        (troop_slot_eq, ":var36", 2, 6),
        (call_script, "script_troop_get_player_relation", ":var36"),
        (assign, ":var12", reg0),
        (try_begin),
          (ge, ":var12", 40),
          (val_add, ":var35", 1),
        (else_try),
          (le, ":var12", -40),
          (val_add, ":var34", 1),
        (try_end),
      (try_end),
      (store_mul, ":var37", ":var35", 10),
      (val_add, ":var0", ":var37"),
      (store_mul, ":var38", ":var34", -10),
      (val_add, ":var0", ":var38"),
      (store_current_day, ":var39"),
      (store_div, ":var40", ":var39", -1),
      (val_add, ":var0", ":var40"),
      (store_mul, ":var41", "$g_total_victories", 2),
      (val_add, ":var0", ":var41"),
      (store_mul, ":var42", "$g_total_defeats", -3),
      (val_add, ":var0", ":var42"),
      (store_mul, ":var43", "$g_total_quests_completed", 4),
      (val_add, ":var0", ":var43"),
      (troop_get_xp, ":var44", "trp_player"),
      (store_div, ":var45", ":var44", 5000),
      (val_add, ":var0", ":var45"),
      (assign, ":var46", 0),
      (assign, ":var47", 0),
      (try_for_range, ":var36", "trp_npc_adonja", "trp_kingdom_1_lord"),
        (try_begin),
          (troop_slot_eq, ":var36", 2, 5),
          (val_add, ":var46", 1),
        (else_try),
          (troop_slot_ge, ":var36", 82, 1),
          (val_add, ":var47", 1),
        (try_end),
      (try_end),
      (store_div, ":var48", ":var46", 2),
      (val_add, ":var0", ":var48"),
      (store_div, ":var49", ":var47", -4),
      (val_add, ":var0", ":var49"),
      (get_average_game_difficulty, ":var50"),
      (assign, ":var51", ":var0"),
      (val_mul, ":var0", ":var50"),
      (val_div, ":var0", 75),
      (val_mul, ":var0", ":var50"),
      (val_div, ":var0", 75),
      (store_sub, ":var51", ":var0", ":var51"),
      (assign, reg5, ":var39"),
      (store_character_level, reg4, "trp_player"),
      (create_text_overlay, reg1, "@You have retired at level {reg4} after {reg5} days of adventuring.", 16),
      (position_set_x, pos1, 700),
      (position_set_y, pos1, 700),
      (overlay_set_position, reg1, pos1),
      (position_set_x, pos1, 950),
      (position_set_y, pos1, 950),
      (overlay_set_size, reg1, pos1),
      (create_text_overlay, reg2, "@Effect on Score", 16),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg2, pos1),
      (position_set_x, pos1, 850),
      (position_set_y, pos1, 670),
      (overlay_set_position, reg2, pos1),
      (assign, reg0, ":var16"),
      (create_text_overlay, reg1, "@Settlements owned by you: {reg0}", 0),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 600),
      (position_set_y, pos1, 650),
      (overlay_set_position, reg1, pos1),
      (assign, reg0, ":var17"),
      (create_text_overlay, reg1, "@{!}{reg0?+:}{reg0}", 16),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 850),
      (position_set_y, pos1, 650),
      (overlay_set_position, reg1, pos1),
      (try_begin),
        (gt, reg0, 0),
        (overlay_set_color, reg1, 43520),
      (try_end),
      (assign, reg0, ":var20"),
      (create_text_overlay, reg1, "@Friendly Settlements: {reg0}", 0),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 600),
      (position_set_y, pos1, 630),
      (overlay_set_position, reg1, pos1),
      (assign, reg0, ":var21"),
      (create_text_overlay, reg1, "@{!}{reg0?+:}{reg0}", 16),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 850),
      (position_set_y, pos1, 630),
      (overlay_set_position, reg1, pos1),
      (try_begin),
        (gt, reg0, 0),
        (overlay_set_color, reg1, 43520),
      (try_end),
      (assign, reg0, ":var24"),
      (create_text_overlay, reg1, "@Hostile Settlements: {reg0}", 0),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 600),
      (position_set_y, pos1, 610),
      (overlay_set_position, reg1, pos1),
      (assign, reg0, ":var25"),
      (create_text_overlay, reg1, "@{!}{reg0}", 16),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 850),
      (position_set_y, pos1, 610),
      (overlay_set_position, reg1, pos1),
      (try_begin),
        (lt, reg0, 0),
        (overlay_set_color, reg1, 16711680),
      (try_end),
      (assign, reg0, ":var35"),
      (create_text_overlay, reg1, "@Friendly Lords: {reg0}", 0),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 600),
      (position_set_y, pos1, 590),
      (overlay_set_position, reg1, pos1),
      (assign, reg0, ":var37"),
      (create_text_overlay, reg1, "@{!}{reg0?+:}{reg0}", 16),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 850),
      (position_set_y, pos1, 590),
      (overlay_set_position, reg1, pos1),
      (try_begin),
        (gt, reg0, 0),
        (overlay_set_color, reg1, 43520),
      (try_end),
      (assign, reg0, ":var34"),
      (create_text_overlay, reg1, "@Enemy Lords: {reg0}", 0),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 600),
      (position_set_y, pos1, 570),
      (overlay_set_position, reg1, pos1),
      (assign, reg0, ":var38"),
      (create_text_overlay, reg1, "@{!}{reg0}", 16),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 850),
      (position_set_y, pos1, 570),
      (overlay_set_position, reg1, pos1),
      (try_begin),
        (lt, reg0, 0),
        (overlay_set_color, reg1, 16711680),
      (try_end),
      (assign, reg0, "$g_total_victories"),
      (create_text_overlay, reg1, "@Victories: {reg0}", 0),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 600),
      (position_set_y, pos1, 550),
      (overlay_set_position, reg1, pos1),
      (assign, reg0, ":var41"),
      (create_text_overlay, reg1, "@{!}{reg0?+:}{reg0}", 16),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 850),
      (position_set_y, pos1, 550),
      (overlay_set_position, reg1, pos1),
      (try_begin),
        (gt, reg0, 0),
        (overlay_set_color, reg1, 43520),
      (try_end),
      (assign, reg0, "$g_total_defeats"),
      (create_text_overlay, reg1, "@Defeats: {reg0}", 0),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 600),
      (position_set_y, pos1, 530),
      (overlay_set_position, reg1, pos1),
      (assign, reg0, ":var42"),
      (create_text_overlay, reg1, "@{!}{reg0}", 16),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 850),
      (position_set_y, pos1, 530),
      (overlay_set_position, reg1, pos1),
      (try_begin),
        (lt, reg0, 0),
        (overlay_set_color, reg1, 16711680),
      (try_end),
      (assign, reg0, "$g_total_quests_completed"),
      (create_text_overlay, reg1, "@Quests Completed: {reg0}", 0),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 600),
      (position_set_y, pos1, 510),
      (overlay_set_position, reg1, pos1),
      (assign, reg0, ":var43"),
      (create_text_overlay, reg1, "@{!}{reg0?+:}{reg0}", 16),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 850),
      (position_set_y, pos1, 510),
      (overlay_set_position, reg1, pos1),
      (try_begin),
        (gt, reg0, 0),
        (overlay_set_color, reg1, 43520),
      (try_end),
      (assign, reg0, ":var46"),
      (create_text_overlay, reg1, "@Companions Found: {reg0}", 0),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 600),
      (position_set_y, pos1, 490),
      (overlay_set_position, reg1, pos1),
      (assign, reg0, ":var48"),
      (create_text_overlay, reg1, "@{!}{reg0?+:}{reg0}", 16),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 850),
      (position_set_y, pos1, 490),
      (overlay_set_position, reg1, pos1),
      (try_begin),
        (gt, reg0, 0),
        (overlay_set_color, reg1, 43520),
      (try_end),
      (assign, reg0, ":var47"),
      (create_text_overlay, reg1, "@Companions Lost/Departed: {reg0}", 0),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 600),
      (position_set_y, pos1, 470),
      (overlay_set_position, reg1, pos1),
      (assign, reg0, ":var49"),
      (create_text_overlay, reg1, "@{!}{reg0}", 16),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 850),
      (position_set_y, pos1, 470),
      (overlay_set_position, reg1, pos1),
      (try_begin),
        (lt, reg0, 0),
        (overlay_set_color, reg1, 16711680),
      (try_end),
      (assign, reg0, ":var1"),
      (create_text_overlay, reg1, "@Wealth: {reg0} denars", 0),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 600),
      (position_set_y, pos1, 450),
      (overlay_set_position, reg1, pos1),
      (assign, reg0, ":var2"),
      (create_text_overlay, reg1, "@{!}{reg0?+:}{reg0}", 16),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 850),
      (position_set_y, pos1, 450),
      (overlay_set_position, reg1, pos1),
      (try_begin),
        (gt, reg0, 0),
        (overlay_set_color, reg1, 43520),
      (try_end),
      (assign, reg0, ":var26"),
      (create_text_overlay, reg1, "@Inventory: {reg0} denars", 0),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 600),
      (position_set_y, pos1, 430),
      (overlay_set_position, reg1, pos1),
      (assign, reg0, ":var31"),
      (create_text_overlay, reg1, "@{!}{reg0?+:}{reg0}", 16),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 850),
      (position_set_y, pos1, 430),
      (overlay_set_position, reg1, pos1),
      (try_begin),
        (gt, reg0, 0),
        (overlay_set_color, reg1, 43520),
      (try_end),
      (assign, reg0, ":var32"),
      (create_text_overlay, reg1, "@Renown: {reg0}", 0),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 600),
      (position_set_y, pos1, 410),
      (overlay_set_position, reg1, pos1),
      (assign, reg0, ":var33"),
      (create_text_overlay, reg1, "@{!}{reg0?+:}{reg0}", 16),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 850),
      (position_set_y, pos1, 410),
      (overlay_set_position, reg1, pos1),
      (try_begin),
        (gt, reg0, 0),
        (overlay_set_color, reg1, 43520),
      (try_end),
      (assign, reg0, ":var44"),
      (create_text_overlay, reg1, "@Experience: {reg0}", 0),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 600),
      (position_set_y, pos1, 390),
      (overlay_set_position, reg1, pos1),
      (assign, reg0, ":var45"),
      (create_text_overlay, reg1, "@{!}{reg0?+:}{reg0}", 16),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 850),
      (position_set_y, pos1, 390),
      (overlay_set_position, reg1, pos1),
      (try_begin),
        (gt, reg0, 0),
        (overlay_set_color, reg1, 43520),
      (try_end),
      (assign, reg0, ":var39"),
      (create_text_overlay, reg1, "@Days Passed: {reg0}", 0),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 600),
      (position_set_y, pos1, 370),
      (overlay_set_position, reg1, pos1),
      (assign, reg0, ":var40"),
      (create_text_overlay, reg1, "@{!}{reg0}", 16),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 850),
      (position_set_y, pos1, 370),
      (overlay_set_position, reg1, pos1),
      (try_begin),
        (lt, reg0, 0),
        (overlay_set_color, reg1, 16711680),
      (try_end),
      (assign, reg0, ":var50"),
      (create_text_overlay, reg1, "@Difficulty: {reg0}%", 0),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 600),
      (position_set_y, pos1, 350),
      (overlay_set_position, reg1, pos1),
      (assign, reg0, ":var51"),
      (assign, reg3, reg0),
      (val_max, reg3, 0),
      (create_text_overlay, reg1, "@{!}{reg3?+:}{reg0}", 16),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 850),
      (position_set_y, pos1, 350),
      (overlay_set_position, reg1, pos1),
      (try_begin),
        (gt, reg0, 0),
        (overlay_set_color, reg1, 43520),
      (else_try),
        (lt, reg0, 0),
        (overlay_set_color, reg1, 16711680),
      (try_end),
      (assign, reg0, ":var0"),
      (create_text_overlay, reg1, "@TOTAL SCORE: {reg0}", 16),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 320),
      (overlay_set_position, reg1, pos1),
      (assign, ":var52", 0),
      (assign, ":var53", 0),
      (assign, ":var54", 0),
      (assign, ":var55", 0),
      (assign, ":var56", 0),
      (assign, ":var57", 0),
      (try_for_range, ":var58", "p_town_1", "p_salt_mine"),
        (try_begin),
          (party_slot_eq, ":var58", 7, "trp_player"),
          (try_begin),
            (party_slot_eq, ":var58", 0, 3),
            (val_add, ":var54", 1),
          (else_try),
            (party_slot_eq, ":var58", 0, 2),
            (val_add, ":var53", 1),
          (else_try),
            (val_add, ":var52", 1),
          (try_end),
        (else_try),
          (party_get_slot, ":var59", ":var58", 26),
          (gt, ":var59", 0),
          (try_begin),
            (party_slot_eq, ":var58", 0, 3),
            (val_add, ":var57", ":var59"),
          (else_try),
            (party_slot_eq, ":var58", 0, 2),
            (val_add, ":var56", ":var59"),
          (else_try),
            (val_add, ":var55", ":var59"),
          (try_end),
        (try_end),
      (try_end),
      (try_begin),
        (gt, ":var54", 0),
        (store_random_in_range, ":var60", 0, ":var54"),
        (try_for_range, ":var58", "p_town_1", "p_castle_1"),
          (party_slot_eq, ":var58", 7, "trp_player"),
          (val_sub, ":var60", 1),
          (lt, ":var60", 0),
          (str_store_party_name, s9, ":var58"),
        (try_end),
      (else_try),
        (gt, ":var57", 0),
        (store_random_in_range, ":var61", 0, ":var57"),
        (try_for_range, ":var58", "p_town_1", "p_castle_1"),
          (party_get_slot, ":var59", ":var58", 26),
          (gt, ":var59", 0),
          (val_sub, ":var61", ":var59"),
          (lt, ":var61", 0),
          (str_store_party_name, s9, ":var58"),
        (try_end),
      (else_try),
        (store_random_in_range, ":var60", "p_town_1", "p_castle_1"),
        (str_store_party_name, s9, ":var60"),
      (try_end),
      (try_begin),
        (gt, ":var53", 0),
        (store_random_in_range, ":var62", 0, ":var53"),
        (try_for_range, ":var58", "p_castle_1", "p_village_1"),
          (party_slot_eq, ":var58", 7, "trp_player"),
          (val_sub, ":var62", 1),
          (lt, ":var62", 0),
          (str_store_party_name, s8, ":var58"),
        (try_end),
      (else_try),
        (gt, ":var56", 0),
        (store_random_in_range, ":var63", 0, ":var56"),
        (try_for_range, ":var58", "p_castle_1", "p_village_1"),
          (party_get_slot, ":var59", ":var58", 26),
          (gt, ":var59", 0),
          (val_sub, ":var63", ":var59"),
          (lt, ":var63", 0),
          (str_store_party_name, s8, ":var58"),
        (try_end),
      (else_try),
        (store_random_in_range, ":var62", "p_castle_1", "p_village_1"),
        (str_store_party_name, s8, ":var62"),
      (try_end),
      (try_begin),
        (gt, ":var52", 0),
        (store_random_in_range, ":var64", 0, ":var52"),
        (try_for_range, ":var58", "p_village_1", "p_salt_mine"),
          (party_slot_eq, ":var58", 7, "trp_player"),
          (val_sub, ":var64", 1),
          (lt, ":var64", 0),
          (str_store_party_name, s7, ":var58"),
        (try_end),
      (else_try),
        (gt, ":var55", 0),
        (store_random_in_range, ":var65", 0, ":var55"),
        (try_for_range, ":var58", "p_village_1", "p_salt_mine"),
          (party_get_slot, ":var59", ":var58", 26),
          (gt, ":var59", 0),
          (val_sub, ":var65", ":var59"),
          (lt, ":var65", 0),
          (str_store_party_name, s7, ":var58"),
        (try_end),
      (else_try),
        (store_random_in_range, ":var64", "p_village_1", "p_salt_mine"),
        (str_store_party_name, s7, ":var64"),
      (try_end),
      (assign, ":var66", 0),
      (str_clear, s15),
      (try_for_range_backwards, ":var67", "fac_player_supporters_faction", "fac_kingdoms_end"),
        (faction_slot_eq, ":var67", 21, 1),
        (neq, ":var67", "$players_kingdom"),
        (try_begin),
          (eq, ":var66", 0),
          (str_store_faction_name, s15, ":var67"),
          (str_store_string, s15, "@the {s15}"),
        (else_try),
          (eq, ":var66", 1),
          (str_store_faction_name, s16, ":var67"),
          (str_store_string, s15, "@the {s16} and {s15}"),
        (else_try),
          (str_store_faction_name, s16, ":var67"),
          (str_store_string, s15, "@the {s16}, {s15}"),
        (try_end),
        (val_add, ":var66", 1),
      (try_end),
      (try_begin),
        (gt, ":var66", 0),
        (str_store_string, s15, "@ conquered {s15},"),
      (try_end),
      (call_script, "script_gender_to_reg63"),
      (try_begin),
        (eq, "$pop_kingdom", 1),
        (str_store_string, s13, "@self-proclaimed {reg63?king:queen}"),
      (else_try),
        (gt, "$players_kingdom", 0),
        (str_store_string, s13, "@minor lord"),
      (else_try),
        (str_store_string, s13, "@mercenary captain"),
      (try_end),
      (try_begin),
        (assign, ":var68", 0),
        (try_begin),
          (eq, ":var66", 5),
          (assign, ":var68", 1),
        (else_try),
          (eq, ":var66", 4),
          (is_between, "$players_kingdom", "fac_kingdom_1", "fac_kingdoms_end"),
          (faction_slot_eq, "$players_kingdom", 21, 0),
          (assign, ":var68", 1),
        (try_end),
        (eq, ":var68", 1),
        (create_mesh_overlay_with_tableau_material, reg1, -1, "tableau_retirement_troop", 9),
        (str_store_string, s0, "str_retirement_text_10"),
      (else_try),
        (lt, ":var0", 250),
        (create_mesh_overlay_with_tableau_material, reg1, -1, "tableau_retirement_troop", 0),
        (str_store_string, s0, "str_retirement_text_1"),
      (else_try),
        (lt, ":var0", 500),
        (create_mesh_overlay_with_tableau_material, reg1, -1, "tableau_retirement_troop", 1),
        (str_store_string, s0, "str_retirement_text_2"),
      (else_try),
        (lt, ":var0", 1000),
        (create_mesh_overlay_with_tableau_material, reg1, -1, "tableau_retirement_troop", 2),
        (str_store_string, s0, "str_retirement_text_3"),
      (else_try),
        (lt, ":var0", 2000),
        (create_mesh_overlay_with_tableau_material, reg1, -1, "tableau_retirement_troop", 3),
        (str_store_string, s0, "str_retirement_text_4"),
      (else_try),
        (lt, ":var0", 4000),
        (create_mesh_overlay_with_tableau_material, reg1, -1, "tableau_retirement_troop", 4),
        (str_store_string, s0, "str_retirement_text_5"),
      (else_try),
        (lt, ":var0", 6500),
        (create_mesh_overlay_with_tableau_material, reg1, -1, "tableau_retirement_troop", 5),
        (str_store_string, s0, "str_retirement_text_6"),
      (else_try),
        (lt, ":var0", 9000),
        (create_mesh_overlay_with_tableau_material, reg1, -1, "tableau_retirement_troop", 6),
        (str_store_string, s0, "str_retirement_text_7"),
      (else_try),
        (lt, ":var0", 12000),
        (create_mesh_overlay_with_tableau_material, reg1, -1, "tableau_retirement_troop", 7),
        (str_store_string, s0, "str_retirement_text_8"),
      (else_try),
        (create_mesh_overlay_with_tableau_material, reg1, -1, "tableau_retirement_troop", 8),
        (str_store_string, s0, "str_retirement_text_9"),
      (try_end),
      (position_set_x, pos1, 0),
      (position_set_y, pos1, 120),
      (overlay_set_position, reg1, pos1),
      (create_text_overlay, reg1, s0, 10240),
      (position_set_x, pos1, 600),
      (position_set_y, pos1, 120),
      (overlay_set_position, reg1, pos1),
      (position_set_x, pos1, 360),
      (position_set_y, pos1, 190),
      (overlay_set_area_size, reg1, pos1),
      (position_set_x, pos1, 800),
      (position_set_y, pos1, 800),
      (overlay_set_size, reg1, pos1),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (try_begin),
        (eq, ":var0", "$g_presentation_obj_retirement_1"),
        (jump_to_menu, "mnu_end_game"),
        (start_presentation, "prsnt_game_credits"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_retirement_2"),
        (presentation_set_duration, 0),
        (change_screen_return),
      (try_end),
    ]),
  ]),

  ("budget_report", 0, mesh_load_window,
  [
    (ti_on_presentation_load,
    [
      (presentation_set_duration, 999999),
      (set_fixed_point_multiplier, 1000),
      (create_mesh_overlay, reg1, "mesh_pic_payment"),
      (position_set_x, pos1, 800),
      (position_set_y, pos1, 800),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 170),
      (position_set_y, pos1, 0),
      (overlay_set_position, reg1, pos1),
      (create_text_overlay, reg1, "str_weekly_budget", 16),
      (position_set_x, pos1, 1500),
      (position_set_y, pos1, 1500),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 260),
      (position_set_y, pos1, 650),
      (overlay_set_position, reg1, pos1),
      (str_clear, s0),
      (create_text_overlay, "$g_presentation_obj_bugdet_report_container", s0, 131072),
      (position_set_x, pos1, 0),
      (position_set_y, pos1, 100),
      (overlay_set_position, "$g_presentation_obj_bugdet_report_container", pos1),
      (position_set_x, pos1, 505),
      (position_set_y, pos1, 500),
      (overlay_set_area_size, "$g_presentation_obj_bugdet_report_container", pos1),
      (945, "$g_presentation_obj_bugdet_report_container"),
      (266, ":var0"),
      (try_begin),
        (eq, ":var0", 0),
        (assign, ":var1", 8),
        (assign, ":var2", 4),
      (else_try),
        (eq, ":var0", 1),
        (assign, ":var1", 10),
        (assign, ":var2", 3),
      (else_try),
        (eq, ":var0", 2),
        (assign, ":var1", 12),
        (assign, ":var2", 2),
      (try_end),
      (assign, ":var3", 0),
      (assign, ":var4", 0),
      (assign, ":var5", 0),
      (assign, ":var6", 0),
      (try_for_range, ":var7", "p_town_1", "p_salt_mine"),
        (try_begin),
          (party_slot_ge, ":var7", 137, 1),
          (val_add, ":var3", 1),
        (try_end),
        (party_slot_eq, ":var7", 7, "trp_player"),
        (val_add, ":var3", 1),
        (val_add, ":var4", 1),
        (try_begin),
          (is_between, ":var7", "p_town_1", "p_castle_1"),
          (val_add, ":var3", 1),
          (val_add, ":var4", 1),
        (try_end),
      (try_end),
      (try_begin),
        (gt, "$players_kingdom", 0),
        (neq, "$players_kingdom", "fac_player_supporters_faction"),
        (neq, "$players_kingdom", "fac_player_faction"),
        (eq, "$player_has_homage", 0),
        (val_add, ":var3", 1),
      (try_end),
      (try_begin),
        (gt, ":var4", ":var1"),
        (val_add, ":var3", 1),
      (try_end),
      (assign, ":var8", 0),
      (try_begin),
        (troop_get_slot, ":var9", "trp_player", 30),
        (gt, ":var9", 0),
        (troop_get_type, ":var10", ":var9"),
        (eq, ":var10", 0),
        (troop_slot_eq, ":var9", 2, 2),
        (assign, ":var8", 1),
      (try_end),
      (try_for_parties, ":var11"),
        (assign, ":var12", 0),
        (try_begin),
          (this_or_next|party_slot_eq, ":var11", 0, 3),
          (party_slot_eq, ":var11", 0, 2),
          (party_slot_eq, ":var11", 7, "trp_player"),
          (neq, ":var11", "p_old_ruins"),
          (neq, ":var11", "p_snake_stronghold"),
          (assign, ":var12", 1),
        (else_try),
          (this_or_next|party_slot_eq, ":var11", 0, 3),
          (party_slot_eq, ":var11", 0, 2),
          (neg|party_slot_ge, ":var11", 7, 1),
          (store_faction_of_party, ":var13", ":var11"),
          (eq, ":var13", "fac_player_supporters_faction"),
          (faction_slot_eq, "fac_player_supporters_faction", 11, "trp_player"),
          (assign, ":var12", 1),
        (else_try),
          (eq, ":var8", 1),
          (this_or_next|party_slot_eq, ":var11", 0, 3),
          (party_slot_eq, ":var11", 0, 2),
          (party_slot_eq, ":var11", 7, ":var9"),
          (assign, ":var12", 1),
        (else_try),
          (eq, ":var11", "p_old_ruins"),
          (party_slot_eq, "p_old_ruins", 268, 1),
          (assign, ":var12", 1),
        (else_try),
          (eq, ":var11", "p_snake_stronghold"),
          (quest_slot_ge, "qst_order_grandmaster", 11, 6),
          (troop_get_slot, ":var14", "trp_player", 162),
          (is_between, ":var14", "trp_dragon_knight", "trp_zombie"),
          (store_troop_faction, ":var15", ":var14"),
          (store_faction_of_party, ":var16", "p_snake_stronghold"),
          (eq, ":var15", ":var16"),
          (store_sub, ":var17", ":var14", "trp_dragon_knight"),
          (val_add, ":var17", "trp_dragon_drake"),
          (try_begin),
            (party_get_num_companions, ":var18", "p_snake_stronghold"),
            (neq, ":var18", 330),
            (assign, ":var12", 1),
          (else_try),
            (party_count_members_of_type, ":var19", "p_snake_stronghold", ":var14"),
            (neq, ":var19", 50),
            (assign, ":var12", 1),
          (else_try),
            (party_count_members_of_type, ":var20", "p_snake_stronghold", ":var17"),
            (neq, ":var20", 80),
            (assign, ":var12", 1),
          (else_try),
            (party_count_members_of_type, ":var21", "p_snake_stronghold", "trp_mercenary_armcrossbow"),
            (neq, ":var21", 100),
            (assign, ":var12", 1),
          (else_try),
            (party_count_members_of_type, ":var22", "p_snake_stronghold", "trp_mercenary_swordsman"),
            (neq, ":var22", 100),
            (assign, ":var12", 1),
          (try_end),
        (try_end),
        (this_or_next|eq, ":var11", "p_main_party"),
        (eq, ":var12", 1),
        (val_add, ":var3", 1),
      (try_end),
      (try_begin),
        (gt, "$g_player_debt_to_party_members", 0),
        (val_add, ":var3", 2),
      (try_end),
      (val_add, ":var3", 3),
      (store_mul, ":var23", 27, ":var3"),
      (assign, ":var24", 0),
      (try_for_range, ":var7", "p_town_1", "p_salt_mine"),
        (try_begin),
          (party_get_slot, ":var25", ":var7", 137),
          (gt, ":var25", 1),
          (neg|party_slot_ge, ":var7", 139, 1),
          (str_store_party_name, s0, ":var7"),
          (call_script, "script_process_player_enterprise", ":var25", ":var7"),
          (assign, ":var26", reg0),
          (assign, ":var27", reg4),
          (assign, ":var28", reg5),
          (assign, ":var29", reg10),
          (store_sub, ":var30", ":var7", "p_town_1"),
          (store_add, ":var31", ":var30", "trp_town_1_master_craftsman"),
          (item_get_slot, ":var32", ":var25", 55),
          (assign, ":var33", 0),
          (try_begin),
            (party_slot_eq, ":var7", 138, 1),
            (assign, ":var34", 0),
            (troop_get_inventory_capacity, ":var35", ":var31"),
            (try_for_range, ":var36", 0, ":var35"),
              (troop_get_inventory_slot, ":var37", ":var31", ":var36"),
              (lt, ":var37", 1),
              (val_add, ":var34", 1),
            (try_end),
            (assign, ":var33", ":var32"),
            (val_min, ":var33", ":var34"),
            (gt, ":var33", 0),
            (store_mul, ":var38", ":var27", ":var33"),
            (val_sub, ":var26", ":var38"),
            (val_sub, ":var32", ":var33"),
          (try_end),
          (try_begin),
            (eq, "$g_apply_budget_report_to_gold", 1),
            (troop_add_items, ":var31", ":var25", ":var33"),
            (store_sub, ":var39", ":var25", "itm_spice"),
            (val_add, ":var39", 301),
            (party_get_slot, ":var40", ":var7", ":var39"),
            (store_mul, ":var41", ":var32", 15),
            (val_sub, ":var40", ":var41"),
            (party_set_slot, ":var7", ":var39", ":var40"),
            (gt, "$cheat_mode", 0),
            (str_store_troop_name, s3, ":var31"),
            (assign, reg3, ":var33"),
          (try_end),
          (item_get_slot, ":var42", ":var25", 52),
          (try_begin),
            (item_slot_ge, ":var25", 57, 1),
            (assign, ":var43", ":var42"),
          (else_try),
            (assign, ":var43", 0),
          (try_end),
          (assign, ":var44", 0),
          (assign, ":var45", 0),
          (try_begin),
            (troop_get_inventory_capacity, ":var35", ":var31"),
            (try_for_range, ":var36", 0, ":var35"),
              (troop_get_inventory_slot, ":var46", ":var31", ":var36"),
              (lt, ":var44", ":var42"),
              (item_slot_eq, ":var25", 50, ":var46"),
              (val_add, ":var44", 1),
            (else_try),
              (lt, ":var45", ":var43"),
              (item_slot_eq, ":var25", 57, ":var46"),
              (val_add, ":var45", 1),
            (try_end),
            (try_begin),
              (gt, ":var44", 0),
              (val_sub, ":var42", ":var44"),
              (store_mul, ":var47", ":var28", ":var44"),
              (val_add, ":var26", ":var47"),
            (try_end),
            (try_begin),
              (gt, ":var45", 0),
              (val_sub, ":var43", ":var45"),
              (assign, ":var47", ":var29"),
              (val_add, ":var26", ":var47"),
            (try_end),
          (try_end),
          (try_begin),
            (eq, "$g_apply_budget_report_to_gold", 1),
            (item_get_slot, ":var48", ":var25", 50),
            (troop_remove_items, ":var31", ":var48", ":var44"),
            (item_get_slot, ":var49", ":var25", 57),
            (troop_remove_items, ":var31", ":var49", ":var45"),
            (store_sub, ":var39", ":var48", "itm_spice"),
            (val_add, ":var39", 301),
            (party_get_slot, ":var40", ":var7", ":var39"),
            (store_mul, ":var41", ":var32", 15),
            (val_add, ":var40", ":var41"),
            (party_set_slot, ":var7", ":var39", ":var40"),
            (try_begin),
              (gt, ":var43", 0),
              (store_sub, ":var39", ":var49", "itm_spice"),
              (val_add, ":var39", 301),
              (party_get_slot, ":var40", ":var7", ":var39"),
              (val_add, ":var40", 15),
              (party_set_slot, ":var7", ":var39", ":var40"),
            (try_end),
          (try_end),
          (call_script, "script_get_enterprise_name", ":var25"),
          (str_store_string, s5, reg0),
          (create_text_overlay, reg1, "str_enterprise_s5_at_s0", 0),
          (position_set_x, pos1, 900),
          (position_set_y, pos1, 900),
          (overlay_set_size, reg1, pos1),
          (position_set_x, pos1, 25),
          (position_set_y, pos1, ":var23"),
          (overlay_set_position, reg1, pos1),
          (assign, reg0, ":var26"),
          (try_begin),
            (store_faction_of_party, ":var50", ":var7"),
            (store_relation, ":var51", ":var50", "$players_kingdom"),
            (lt, ":var51", 0),
            (assign, reg0, 0),
            (assign, ":var26", 0),
            (create_text_overlay, reg1, "str_under_sequestration", 32776),
            (overlay_set_color, reg1, 16711680),
          (else_try),
            (ge, reg0, 0),
            (create_text_overlay, reg1, "@{!}{reg0}", 32776),
            (overlay_set_color, reg1, 43520),
          (else_try),
            (create_text_overlay, reg1, "@{!}{reg0}", 32776),
            (overlay_set_color, reg1, 16711680),
          (try_end),
          (val_add, ":var5", ":var26"),
          (val_add, ":var24", ":var26"),
          (position_set_x, pos1, 900),
          (position_set_y, pos1, 900),
          (overlay_set_size, reg1, pos1),
          (position_set_x, pos1, 500),
          (position_set_y, pos1, ":var23"),
          (overlay_set_position, reg1, pos1),
          (val_sub, ":var23", 27),
        (try_end),
        (party_slot_eq, ":var7", 7, "trp_player"),
        (party_get_slot, ":var52", ":var7", 47),
        (party_get_slot, ":var53", ":var7", 48),
        (store_add, ":var54", ":var52", ":var53"),
        (val_add, ":var5", ":var54"),
        (val_add, ":var6", ":var54"),
        (val_add, ":var24", ":var54"),
        (str_store_party_name, s0, ":var7"),
        (create_text_overlay, reg1, "str_rents_from_s0", 0),
        (position_set_x, pos1, 900),
        (position_set_y, pos1, 900),
        (overlay_set_size, reg1, pos1),
        (position_set_x, pos1, 25),
        (position_set_y, pos1, ":var23"),
        (overlay_set_position, reg1, pos1),
        (try_begin),
          (gt, ":var52", 0),
          (assign, reg0, ":var52"),
          (create_text_overlay, reg1, "@{!}{reg0}", 32776),
          (overlay_set_color, reg1, 43520),
        (else_try),
          (create_text_overlay, reg1, "@None", 32776),
        (try_end),
        (position_set_x, pos1, 900),
        (position_set_y, pos1, 900),
        (overlay_set_size, reg1, pos1),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, ":var23"),
        (overlay_set_position, reg1, pos1),
        (val_sub, ":var23", 27),
        (try_begin),
          (is_between, ":var7", "p_town_1", "p_castle_1"),
          (create_text_overlay, reg1, "str_tariffs_from_s0", 0),
          (position_set_x, pos1, 900),
          (position_set_y, pos1, 900),
          (overlay_set_size, reg1, pos1),
          (position_set_x, pos1, 25),
          (position_set_y, pos1, ":var23"),
          (overlay_set_position, reg1, pos1),
          (try_begin),
            (gt, ":var53", 0),
            (assign, reg0, ":var53"),
            (create_text_overlay, reg1, "@{!}{reg0}", 32776),
            (overlay_set_color, reg1, 43520),
          (else_try),
            (create_text_overlay, reg1, "@None", 32776),
          (try_end),
          (position_set_x, pos1, 900),
          (position_set_y, pos1, 900),
          (overlay_set_size, reg1, pos1),
          (position_set_x, pos1, 500),
          (position_set_y, pos1, ":var23"),
          (overlay_set_position, reg1, pos1),
          (val_sub, ":var23", 27),
        (try_end),
      (try_end),
      (try_begin),
        (gt, "$players_kingdom", 0),
        (neq, "$players_kingdom", "fac_player_supporters_faction"),
        (neq, "$players_kingdom", "fac_player_faction"),
        (eq, "$player_has_homage", 0),
        (str_store_faction_name, s0, "$players_kingdom"),
        (create_text_overlay, reg1, "str_mercenary_payment_from_s0", 0),
        (position_set_x, pos1, 900),
        (position_set_y, pos1, 900),
        (overlay_set_size, reg1, pos1),
        (position_set_x, pos1, 25),
        (position_set_y, pos1, ":var23"),
        (overlay_set_position, reg1, pos1),
        (call_script, "script_party_calculate_strength", "p_main_party", 0),
        (assign, ":var55", reg0),
        (val_div, ":var55", 2),
        (val_add, ":var55", 30),
        (call_script, "script_round_value", ":var55"),
        (val_add, ":var24", reg0),
        (create_text_overlay, reg1, "@{!}{reg0}", 32776),
        (position_set_x, pos1, 900),
        (position_set_y, pos1, 900),
        (overlay_set_size, reg1, pos1),
        (overlay_set_color, reg1, 43520),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, ":var23"),
        (overlay_set_position, reg1, pos1),
        (val_sub, ":var23", 27),
      (try_end),
      (try_begin),
        (gt, ":var4", ":var1"),
        (gt, ":var5", 0),
        (store_sub, ":var56", ":var4", ":var1"),
        (val_mul, ":var56", ":var2"),
        (val_min, ":var56", 65),
        (store_mul, ":var57", ":var6", ":var56"),
        (val_div, ":var57", 100),
        (val_sub, ":var24", ":var57"),
        (create_text_overlay, reg1, "str_loss_due_to_tax_inefficiency", 0),
        (position_set_x, pos1, 25),
        (position_set_y, pos1, ":var23"),
        (overlay_set_position, reg1, pos1),
        (position_set_x, pos1, 900),
        (position_set_y, pos1, 900),
        (overlay_set_size, reg1, pos1),
        (store_mul, reg0, ":var57", -1),
        (create_text_overlay, reg1, "@{!}{reg0}", 32776),
        (position_set_x, pos1, 900),
        (position_set_y, pos1, 900),
        (overlay_set_size, reg1, pos1),
        (overlay_set_color, reg1, 16711680),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, ":var23"),
        (overlay_set_position, reg1, pos1),
        (val_sub, ":var23", 27),
      (try_end),
      (try_for_parties, ":var11"),
        (assign, ":var12", 0),
        (assign, ":var58", 0),
        (try_begin),
          (this_or_next|party_slot_eq, ":var11", 0, 3),
          (party_slot_eq, ":var11", 0, 2),
          (party_slot_eq, ":var11", 7, "trp_player"),
          (neq, ":var11", "p_old_ruins"),
          (assign, ":var12", 1),
        (else_try),
          (this_or_next|party_slot_eq, ":var11", 0, 3),
          (party_slot_eq, ":var11", 0, 2),
          (neg|party_slot_ge, ":var11", 7, 1),
          (store_faction_of_party, ":var13", ":var11"),
          (eq, ":var13", "fac_player_supporters_faction"),
          (faction_slot_eq, "fac_player_supporters_faction", 11, "trp_player"),
          (assign, ":var12", 1),
        (else_try),
          (eq, ":var8", 1),
          (this_or_next|party_slot_eq, ":var11", 0, 3),
          (party_slot_eq, ":var11", 0, 2),
          (party_slot_eq, ":var11", 7, ":var9"),
          (assign, ":var12", 2),
        (else_try),
          (eq, ":var11", "p_old_ruins"),
          (party_slot_eq, "p_old_ruins", 268, 1),
          (assign, ":var12", 3),
        (else_try),
          (eq, ":var11", "p_snake_stronghold"),
          (quest_slot_ge, "qst_order_grandmaster", 11, 6),
          (troop_get_slot, ":var14", "trp_player", 162),
          (is_between, ":var14", "trp_dragon_knight", "trp_zombie"),
          (store_troop_faction, ":var15", ":var14"),
          (store_faction_of_party, ":var16", "p_snake_stronghold"),
          (eq, ":var15", ":var16"),
          (store_sub, ":var17", ":var14", "trp_dragon_knight"),
          (val_add, ":var17", "trp_dragon_drake"),
          (try_begin),
            (party_get_num_companions, ":var18", "p_snake_stronghold"),
            (neq, ":var18", 330),
            (assign, ":var12", 3),
          (else_try),
            (party_count_members_of_type, ":var19", "p_snake_stronghold", ":var14"),
            (neq, ":var19", 50),
            (assign, ":var12", 3),
          (else_try),
            (party_count_members_of_type, ":var20", "p_snake_stronghold", ":var17"),
            (neq, ":var20", 80),
            (assign, ":var12", 3),
          (else_try),
            (party_count_members_of_type, ":var21", "p_snake_stronghold", "trp_mercenary_armcrossbow"),
            (neq, ":var21", 100),
            (assign, ":var12", 3),
          (else_try),
            (party_count_members_of_type, ":var22", "p_snake_stronghold", "trp_mercenary_swordsman"),
            (neq, ":var22", 100),
            (assign, ":var12", 3),
          (try_end),
        (else_try),
          (troop_get_slot, ":var59", "trp_player", 161),
          (gt, ":var59", 0),
          (eq, ":var11", ":var59"),
          (party_is_active, ":var59"),
          (assign, ":var58", 1),
        (try_end),
        (this_or_next|eq, ":var11", "p_main_party"),
        (this_or_next|eq, ":var58", 1),
        (ge, ":var12", 1),
        (assign, ":var60", 0),
        (party_get_num_companion_stacks, ":var61", ":var11"),
        (try_for_range, ":var62", 0, ":var61"),
          (party_stack_get_troop_id, ":var63", ":var11", ":var62"),
          (party_stack_get_size, ":var64", ":var11", ":var62"),
          (call_script, "script_game_get_troop_wage", ":var63", ":var11"),
          (assign, ":var65", reg0),
          (val_mul, ":var65", ":var64"),
          (val_add, ":var60", ":var65"),
        (try_end),
        (try_begin),
          (eq, ":var12", 1),
          (val_div, ":var60", 2),
        (else_try),
          (eq, ":var12", 2),
          (val_div, ":var60", 4),
        (else_try),
          (eq, ":var12", 3),
          (val_mul, ":var60", 3),
          (val_div, ":var60", 4),
          (val_add, ":var60", 500),
        (else_try),
          (eq, ":var11", "p_main_party"),
          (store_sub, ":var66", 14, "$g_cur_week_half_daily_wage_payments"),
          (val_mul, ":var60", ":var66"),
          (val_div, ":var60", 14),
        (else_try),
          (eq, ":var58", 1),
          (val_mul, ":var60", 120),
          (val_div, ":var60", 100),
        (try_end),
        (val_mul, ":var60", -1),
        (val_add, ":var24", ":var60"),
        (str_store_party_name, s0, ":var11"),
        (try_begin),
          (eq, ":var11", "p_main_party"),
          (str_store_string, s0, "str_s0s_party"),
        (try_end),
        (create_text_overlay, reg1, "str_wages_for_s0", 0),
        (position_set_x, pos1, 900),
        (position_set_y, pos1, 900),
        (overlay_set_size, reg1, pos1),
        (position_set_x, pos1, 25),
        (position_set_y, pos1, ":var23"),
        (overlay_set_position, reg1, pos1),
        (try_begin),
          (lt, ":var60", 0),
          (assign, reg0, ":var60"),
          (create_text_overlay, reg1, "@{!}{reg0}", 32776),
          (overlay_set_color, reg1, 16711680),
        (else_try),
          (create_text_overlay, reg1, "@None", 32776),
        (try_end),
        (position_set_x, pos1, 900),
        (position_set_y, pos1, 900),
        (overlay_set_size, reg1, pos1),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, ":var23"),
        (overlay_set_position, reg1, pos1),
        (val_sub, ":var23", 27),
      (try_end),
      (try_begin),
        (gt, "$g_player_debt_to_party_members", 0),
        (val_sub, ":var24", "$g_player_debt_to_party_members"),
        (create_text_overlay, reg1, "str_earlier_debts", 0),
        (position_set_x, pos1, 900),
        (position_set_y, pos1, 900),
        (overlay_set_size, reg1, pos1),
        (position_set_x, pos1, 25),
        (position_set_y, pos1, ":var23"),
        (overlay_set_position, reg1, pos1),
        (store_mul, reg0, "$g_player_debt_to_party_members", -1),
        (create_text_overlay, reg1, "@{!}{reg0}", 32776),
        (position_set_x, pos1, 900),
        (position_set_y, pos1, 900),
        (overlay_set_size, reg1, pos1),
        (overlay_set_color, reg1, 16711680),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, ":var23"),
        (overlay_set_position, reg1, pos1),
        (val_sub, ":var23", 27),
      (try_end),
      (create_mesh_overlay, reg1, "mesh_white_plane"),
      (overlay_set_color, reg1, 0),
      (position_set_x, pos1, 24000),
      (position_set_y, pos1, 50),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 25),
      (store_add, ":var67", ":var23", 25),
      (position_set_y, pos1, ":var67"),
      (overlay_set_position, reg1, pos1),
      (create_text_overlay, reg1, "str_net_change", 0),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 25),
      (position_set_y, pos1, ":var23"),
      (overlay_set_position, reg1, pos1),
      (assign, reg0, ":var24"),
      (create_text_overlay, reg1, "@{!}{reg0}", 32776),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (try_begin),
        (gt, reg0, 0),
        (overlay_set_color, reg1, 43520),
      (else_try),
        (lt, reg0, 0),
        (overlay_set_color, reg1, 16711680),
      (try_end),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, ":var23"),
      (overlay_set_position, reg1, pos1),
      (val_sub, ":var23", 27),
      (create_text_overlay, reg1, "str_earlier_wealth", 0),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 25),
      (position_set_y, pos1, ":var23"),
      (overlay_set_position, reg1, pos1),
      (store_troop_gold, ":var68", "trp_player"),
      (assign, reg0, ":var68"),
      (create_text_overlay, reg1, "@{!}{reg0}", 32776),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, ":var23"),
      (overlay_set_position, reg1, pos1),
      (val_sub, ":var23", 27),
      (val_mul, ":var24", -1),
      (try_begin),
        (ge, ":var68", ":var24"),
        (assign, ":var69", ":var24"),
        (assign, ":var70", 0),
      (else_try),
        (assign, ":var69", ":var68"),
        (store_sub, ":var70", ":var24", ":var68"),
      (try_end),
      (create_text_overlay, reg1, "str_new_wealth", 0),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 25),
      (position_set_y, pos1, ":var23"),
      (overlay_set_position, reg1, pos1),
      (store_sub, reg0, ":var68", ":var69"),
      (create_text_overlay, reg1, "@{!}{reg0}", 32776),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, ":var23"),
      (overlay_set_position, reg1, pos1),
      (val_sub, ":var23", 27),
      (try_begin),
        (gt, ":var70", 0),
        (create_text_overlay, reg1, "str_new_debts", 0),
        (position_set_x, pos1, 900),
        (position_set_y, pos1, 900),
        (overlay_set_size, reg1, pos1),
        (position_set_x, pos1, 25),
        (position_set_y, pos1, ":var23"),
        (overlay_set_position, reg1, pos1),
        (assign, reg0, ":var70"),
        (create_text_overlay, reg1, "@{!}{reg0}", 32776),
        (position_set_x, pos1, 900),
        (position_set_y, pos1, 900),
        (overlay_set_size, reg1, pos1),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, ":var23"),
        (overlay_set_position, reg1, pos1),
        (val_sub, ":var23", 27),
        (neq, "$g_apply_budget_report_to_gold", 0),
        (call_script, "script_objectionable_action", 2, "str_men_unpaid"),
      (try_end),
      (945, -1),
      (create_button_overlay, "$g_presentation_obj_budget_report_1", "@Continue..."),
      (position_set_x, pos1, 225),
      (position_set_y, pos1, 60),
      (overlay_set_position, "$g_presentation_obj_budget_report_1", pos1),
      (try_begin),
        (eq, "$g_apply_budget_report_to_gold", 1),
        (assign, "$g_player_debt_to_party_members", ":var70"),
        (try_begin),
          (gt, ":var69", 0),
          (troop_remove_gold, "trp_player", ":var69"),
        (else_try),
          (val_mul, ":var69", -1),
          (troop_add_gold, "trp_player", ":var69"),
        (try_end),
        (try_for_range, ":var7", "p_town_1", "p_salt_mine"),
          (party_slot_eq, ":var7", 7, "trp_player"),
          (party_set_slot, ":var7", 47, 0),
          (party_set_slot, ":var7", 48, 0),
        (try_end),
        (assign, "$g_cur_week_half_daily_wage_payments", 0),
      (try_end),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (try_begin),
        (eq, ":var0", "$g_presentation_obj_budget_report_1"),
        (presentation_set_duration, 0),
      (try_end),
    ]),
  ]),

  ("game_before_quit", 0, mesh_load_window,
  [
    (ti_on_presentation_load,
    [
      (try_begin),
        (250),
        (set_fixed_point_multiplier, 1000),
        (create_mesh_overlay, reg0, "mesh_quit_adv"),
        (position_set_x, pos1, -1),
        (position_set_y, pos1, -1),
        (overlay_set_position, reg0, pos1),
        (position_set_x, pos1, 1002),
        (position_set_y, pos1, 1002),
        (overlay_set_size, reg0, pos1),
        (assign, "$g_game_before_quit_state", 0),
        (presentation_set_duration, 999999),
      (try_end),
    ]),
    (ti_on_presentation_run,
    [
      (store_trigger_param_1, ":var0"),
      (gt, ":var0", 500),
      (try_begin),
        (this_or_next|key_clicked, key_space),
        (this_or_next|key_clicked, key_enter),
        (this_or_next|key_clicked, key_escape),
        (this_or_next|key_clicked, key_back_space),
        (this_or_next|key_clicked, key_left_mouse_button),
        (key_clicked, key_right_mouse_button),
        (try_begin),
          (eq, "$g_game_before_quit_state", 0),
          (val_add, "$g_game_before_quit_state", 1),
          (create_mesh_overlay, reg0, "mesh_quit_adv_b"),
          (position_set_x, pos1, -1),
          (position_set_y, pos1, -1),
          (overlay_set_position, reg0, pos1),
          (position_set_x, pos1, 1002),
          (position_set_y, pos1, 1002),
          (overlay_set_size, reg0, pos1),
        (else_try),
          (presentation_set_duration, 0),
        (try_end),
      (try_end),
    ]),
  ]),

  ("multiplayer_duel_start_counter", prsntf_read_only|prsntf_manual_end_only, mesh_null,
  [
    (ti_on_presentation_load,
    [
      (set_fixed_point_multiplier, 1000),
      (assign, "$g_multiplayer_duel_start_counter_overlay", -1),
      (assign, "$g_multiplayer_last_duel_start_counter_value", -1),
      (str_clear, s0),
      (create_text_overlay, "$g_multiplayer_duel_start_counter_overlay", s0, 65552),
      (overlay_set_color, "$g_multiplayer_duel_start_counter_overlay", 16777215),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 600),
      (overlay_set_position, "$g_multiplayer_duel_start_counter_overlay", pos1),
      (position_set_x, pos1, 2000),
      (position_set_y, pos1, 2000),
      (overlay_set_size, "$g_multiplayer_duel_start_counter_overlay", pos1),
      (presentation_set_duration, 999999),
    ]),
    (ti_on_presentation_run,
    [
      (ge, "$g_multiplayer_duel_start_counter_overlay", 0),
      (store_mission_timer_a, ":var0"),
      (store_sub, ":var1", ":var0", "$g_multiplayer_duel_start_time"),
      (store_sub, ":var2", 3, ":var1"),
      (try_begin),
        (le, ":var2", 0),
        (presentation_set_duration, 0),
      (else_try),
        (neq, "$g_multiplayer_last_duel_start_counter_value", ":var2"),
        (assign, "$g_multiplayer_last_duel_start_counter_value", ":var2"),
        (assign, reg0, ":var2"),
        (str_store_string, s0, "str_duel_starts_in_reg0_seconds"),
        (overlay_set_text, "$g_multiplayer_duel_start_counter_overlay", s0),
      (try_end),
    ]),
  ]),

  ("achievement_report", 0, mesh_load_window,
  [
    (ti_on_presentation_load,
    [
      (presentation_set_duration, 999999),
      (set_fixed_point_multiplier, 1000),
      (assign, ":var0", 1000),
      (assign, ":var1", 45),
      (assign, ":var2", 0),
      (assign, ":var3", 300),
      (store_mul, ":var4", ":var3", 600),
      (val_div, ":var4", 1000),
      (assign, ":var5", ":var1"),
      (store_add, ":var6", ":var4", ":var1"),
      (store_sub, ":var6", ":var0", ":var6"),
      (store_add, ":var7", ":var1", ":var4"),
      (val_add, ":var7", ":var2"),
      (store_sub, ":var8", ":var6", ":var2"),
      (assign, ":var9", 505),
      (assign, ":var10", 600),
      (store_sub, ":var11", ":var10", 15),
      (assign, ":var12", 100),
      (assign, ":var13", 5),
      (store_current_day, ":var14"),
      (assign, reg5, ":var14"),
      (str_store_troop_name, s4, "trp_player"),
      (create_text_overlay, reg1, "@{s4}'s achievements after {reg5} days of adventuring (checked once a day).", 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 695),
      (overlay_set_position, reg1, pos1),
      (position_set_x, pos1, 1300),
      (position_set_y, pos1, 1300),
      (overlay_set_size, reg1, pos1),
      (call_script, "script_gender_to_reg63"),
      (try_begin),
        (assign, ":var15", 0),
        (assign, ":var16", 0),
        (assign, ":var17", -1),
        (store_mul, ":var18", "$g_achievement_page_no", ":var13"),
        (try_for_range, ":var19", 0, 28),
          (assign, ":var20", -1),
          (try_begin),
            (store_and, ":var16", "$g_achieve_bitfield", 1),
            (neq, ":var16", 0),
            (store_and, ":var16", ":var15", 1),
            (eq, ":var16", 0),
            (val_or, ":var15", 1),
            (assign, ":var20", 0),
            (str_store_string, s0, "@Deathbringer"),
            (assign, reg0, 50),
            (str_store_string, s1, "@(killed {reg0} enemies in a single battle)"),
          (else_try),
            (store_and, ":var16", "$g_achieve_bitfield", 2),
            (neq, ":var16", 0),
            (store_and, ":var16", ":var15", 2),
            (eq, ":var16", 0),
            (val_or, ":var15", 2),
            (assign, ":var20", 1),
            (str_store_string, s0, "@Masterful Warrior"),
            (assign, reg0, 5000),
            (str_store_string, s1, "@({reg0} enemies killed or wounded)"),
          (else_try),
            (store_and, ":var16", "$g_achieve_bitfield", 4),
            (neq, ":var16", 0),
            (store_and, ":var16", ":var15", 4),
            (eq, ":var16", 0),
            (val_or, ":var15", 4),
            (assign, ":var20", 2),
            (str_store_string, s0, "@Legendary Warrior"),
            (assign, reg0, 10000),
            (str_store_string, s1, "@({reg0} enemies killed or wounded)"),
          (else_try),
            (store_and, ":var16", "$g_achieve_bitfield", 8),
            (neq, ":var16", 0),
            (store_and, ":var16", ":var15", 8),
            (eq, ":var16", 0),
            (val_or, ":var15", 8),
            (assign, ":var20", 3),
            (str_store_string, s0, "@Battle Master"),
            (assign, reg0, 250),
            (str_store_string, s1, "@(won {reg0} victories)"),
          (else_try),
            (store_and, ":var16", "$g_achieve_bitfield", 16),
            (neq, ":var16", 0),
            (store_and, ":var16", ":var15", 16),
            (eq, ":var16", 0),
            (val_or, ":var15", 16),
            (assign, ":var20", 4),
            (str_store_string, s0, "@Great General"),
            (assign, reg0, 500),
            (str_store_string, s1, "@(won {reg0} victories)"),
          (else_try),
            (store_and, ":var16", "$g_achieve_bitfield", 32),
            (neq, ":var16", 0),
            (store_and, ":var16", ":var15", 32),
            (eq, ":var16", 0),
            (val_or, ":var15", 32),
            (assign, ":var20", 5),
            (str_store_string, s0, "@Defender of Pendor"),
            (assign, reg0, 7),
            (str_store_string, s1, "@(defeated {reg0} heroes)"),
          (else_try),
            (store_and, ":var16", "$g_achieve_bitfield", 64),
            (neq, ":var16", 0),
            (store_and, ":var16", ":var15", 64),
            (eq, ":var16", 0),
            (val_or, ":var15", 64),
            (assign, ":var20", 6),
            (str_store_string, s0, "@Guardian of Pendor"),
            (assign, reg0, 15),
            (str_store_string, s1, "@(defeated {reg0} heroes)"),
          (else_try),
            (store_and, ":var16", "$g_achieve_bitfield", 128),
            (neq, ":var16", 0),
            (store_and, ":var16", ":var15", 128),
            (eq, ":var16", 0),
            (val_or, ":var15", 128),
            (assign, ":var20", 7),
            (str_store_string, s0, "@Bane of Vejovis"),
            (str_store_string, s1, "@(wiped out a Mystmountain army)"),
          (else_try),
            (store_and, ":var16", "$g_achieve_bitfield", 256),
            (neq, ":var16", 0),
            (store_and, ":var16", ":var15", 256),
            (eq, ":var16", 0),
            (val_or, ":var15", 256),
            (assign, ":var20", 8),
            (str_store_string, s0, "@Cult Banisher"),
            (str_store_string, s1, "@(wiped out a Snake Cult army)"),
          (else_try),
            (store_and, ":var16", "$g_achieve_bitfield", 512),
            (neq, ":var16", 0),
            (store_and, ":var16", ":var15", 512),
            (eq, ":var16", 0),
            (val_or, ":var15", 512),
            (assign, ":var20", 9),
            (str_store_string, s0, "@Scourge of Jatu"),
            (str_store_string, s1, "@(wiped out a Jatu army)"),
          (else_try),
            (store_and, ":var16", "$g_achieve_bitfield", 1024),
            (neq, ":var16", 0),
            (store_and, ":var16", ":var15", 1024),
            (eq, ":var16", 0),
            (val_or, ":var15", 1024),
            (assign, ":var20", 10),
            (str_store_string, s0, "@Purger of Heresy"),
            (str_store_string, s1, "@(wiped out a Heretic army)"),
          (else_try),
            (store_and, ":var16", "$g_achieve_bitfield", 2048),
            (neq, ":var16", 0),
            (store_and, ":var16", ":var15", 2048),
            (eq, ":var16", 0),
            (val_or, ":var15", 2048),
            (assign, ":var20", 11),
            (str_store_string, s0, "@Arena Survivor"),
            (assign, reg0, 25),
            (str_store_string, s1, "@(won in {reg0} tournaments)"),
          (else_try),
            (store_and, ":var16", "$g_achieve_bitfield", 4096),
            (neq, ":var16", 0),
            (store_and, ":var16", ":var15", 4096),
            (eq, ":var16", 0),
            (val_or, ":var15", 4096),
            (assign, ":var20", 12),
            (str_store_string, s0, "@Tournament Champion"),
            (assign, reg0, 50),
            (str_store_string, s1, "@(won in {reg0} tournaments)"),
          (else_try),
            (store_and, ":var16", "$g_achieve_bitfield", 8192),
            (neq, ":var16", 0),
            (store_and, ":var16", ":var15", 8192),
            (eq, ":var16", 0),
            (val_or, ":var15", 8192),
            (assign, ":var20", 13),
            (str_store_string, s0, "@{reg63?Hero:Heroine} of Pendor"),
            (assign, reg0, 5000),
            (str_store_string, s1, "@(gained {reg0} renown)"),
          (else_try),
            (store_and, ":var16", "$g_achieve_bitfield", 16384),
            (neq, ":var16", 0),
            (store_and, ":var16", ":var15", 16384),
            (eq, ":var16", 0),
            (val_or, ":var15", 16384),
            (assign, ":var20", 14),
            (str_store_string, s0, "@{reg63?Lion:Lioness} of Pendor"),
            (assign, reg0, 7500),
            (str_store_string, s1, "@(gained {reg0} renown)"),
          (else_try),
            (store_and, ":var16", "$g_achieve_bitfield", 32768),
            (neq, ":var16", 0),
            (store_and, ":var16", ":var15", 32768),
            (eq, ":var16", 0),
            (val_or, ":var15", 32768),
            (assign, ":var20", 15),
            (str_store_string, s0, "@Chevalier of Pendor"),
            (assign, reg0, 500),
            (str_store_string, s1, "@(gained {reg0} honor)"),
          (else_try),
            (store_and, ":var16", "$g_achieve_bitfield", 65536),
            (neq, ":var16", 0),
            (store_and, ":var16", ":var15", 65536),
            (eq, ":var16", 0),
            (val_or, ":var15", 65536),
            (assign, ":var20", 16),
            (str_store_string, s0, "@Rogue {reg63?King:Queen}"),
            (str_store_string, s1, "@(declared a sovereign kingdom)"),
          (else_try),
            (store_and, ":var16", "$g_achieve_bitfield", 131072),
            (neq, ":var16", 0),
            (store_and, ":var16", ":var15", 131072),
            (eq, ":var16", 0),
            (val_or, ":var15", 131072),
            (assign, ":var20", 17),
            (str_store_string, s0, "@Great Persuader"),
            (assign, reg0, 30),
            (str_store_string, s1, "@(persuaded {reg0} lords to join kingdom)"),
          (else_try),
            (store_and, ":var16", "$g_achieve_bitfield", 262144),
            (neq, ":var16", 0),
            (store_and, ":var16", ":var15", 262144),
            (eq, ":var16", 0),
            (val_or, ":var15", 262144),
            (assign, ":var20", 18),
            (str_store_string, s0, "@Master Builder"),
            (assign, reg0, 30),
            (str_store_string, s1, "@(built {reg0} improvements)"),
          (else_try),
            (store_and, ":var16", "$g_achieve_bitfield", 524288),
            (neq, ":var16", 0),
            (store_and, ":var16", ":var15", 524288),
            (eq, ":var16", 0),
            (val_or, ":var15", 524288),
            (assign, ":var20", 19),
            (str_store_string, s0, "@Competent Aide"),
            (assign, reg0, 30),
            (str_store_string, s1, "@(completed {reg0} quests)"),
          (else_try),
            (store_and, ":var16", "$g_achieve_bitfield", 1048576),
            (neq, ":var16", 0),
            (store_and, ":var16", ":var15", 1048576),
            (eq, ":var16", 0),
            (val_or, ":var15", 1048576),
            (assign, ":var20", 20),
            (str_store_string, s0, "@Epitome of Ineptitude"),
            (assign, reg0, 10),
            (str_store_string, s1, "@(failed {reg0} quests)"),
          (else_try),
            (store_and, ":var16", "$g_achieve_bitfield", 2097152),
            (neq, ":var16", 0),
            (store_and, ":var16", ":var15", 2097152),
            (eq, ":var16", 0),
            (val_or, ":var15", 2097152),
            (assign, ":var20", 21),
            (str_store_string, s0, "@Slippery Fellow"),
            (assign, reg0, 10),
            (str_store_string, s1, "@(captured {reg0} times)"),
          (else_try),
            (store_and, ":var16", "$g_achieve_bitfield", 4194304),
            (neq, ":var16", 0),
            (store_and, ":var16", ":var15", 4194304),
            (eq, ":var16", 0),
            (val_or, ":var15", 4194304),
            (assign, ":var20", 22),
            (str_store_string, s0, "@Caravan Marauder"),
            (assign, reg0, 30),
            (str_store_string, s1, "@(raided {reg0} caravans)"),
          (else_try),
            (store_and, ":var16", "$g_achieve_bitfield", 8388608),
            (neq, ":var16", 0),
            (store_and, ":var16", ":var15", 8388608),
            (eq, ":var16", 0),
            (val_or, ":var15", 8388608),
            (assign, ":var20", 23),
            (str_store_string, s0, "@Village Plunderer"),
            (assign, reg0, 20),
            (str_store_string, s1, "@(raided {reg0} villages)"),
          (else_try),
            (store_and, ":var16", "$g_achieve_bitfield", 67108864),
            (neq, ":var16", 0),
            (store_and, ":var16", ":var15", 67108864),
            (eq, ":var16", 0),
            (val_or, ":var15", 67108864),
            (assign, ":var20", 24),
            (str_store_string, s0, "@Blatant Deceiver"),
            (str_store_string, s1, "@(cheated in battle)"),
          (else_try),
            (store_and, ":var16", "$g_achieve_bitfield", 134217728),
            (neq, ":var16", 0),
            (store_and, ":var16", ":var15", 134217728),
            (eq, ":var16", 0),
            (val_or, ":var15", 134217728),
            (assign, ":var20", 25),
            (str_store_string, s0, "@Order Grandmaster"),
            (str_store_string, s1, "@(became a leader of a Knighthood Order)"),
          (try_end),
          (try_begin),
            (neq, ":var20", -1),
            (try_begin),
              (ge, ":var18", 0),
              (val_sub, ":var18", 1),
            (try_end),
            (eq, ":var18", -1),
            (val_add, ":var17", 1),
            (lt, ":var17", ":var13"),
            (store_mod, ":var21", ":var17", 2),
            (store_mul, ":var22", ":var17", ":var12"),
            (store_sub, ":var22", ":var10", ":var22"),
            (try_begin),
              (eq, ":var21", 0),
              (create_text_overlay, reg1, s0, 4),
              (position_set_x, pos1, ":var7"),
            (else_try),
              (create_text_overlay, reg1, s0, 8),
              (position_set_x, pos1, ":var8"),
            (try_end),
            (position_set_y, pos1, ":var22"),
            (overlay_set_position, reg1, pos1),
            (store_mul, ":var22", ":var17", ":var12"),
            (store_sub, ":var22", ":var11", ":var22"),
            (try_begin),
              (eq, ":var21", 0),
              (create_text_overlay, reg1, s1, 4),
              (position_set_x, pos1, ":var7"),
            (else_try),
              (create_text_overlay, reg1, s1, 8),
              (position_set_x, pos1, ":var8"),
            (try_end),
            (position_set_y, pos1, ":var22"),
            (overlay_set_position, reg1, pos1),
            (position_set_x, pos1, 800),
            (position_set_y, pos1, 800),
            (overlay_set_size, reg1, pos1),
            (create_mesh_overlay_with_tableau_material, reg1, -1, "tableau_achievement_troop", ":var20"),
            (try_begin),
              (eq, ":var21", 0),
              (assign, ":var23", ":var5"),
            (else_try),
              (assign, ":var23", ":var6"),
            (try_end),
            (store_mul, ":var24", ":var17", ":var12"),
            (store_sub, ":var24", ":var9", ":var24"),
            (position_set_x, pos1, ":var23"),
            (position_set_y, pos1, ":var24"),
            (overlay_set_position, reg1, pos1),
            (position_set_x, pos1, ":var3"),
            (position_set_y, pos1, ":var3"),
            (overlay_set_size, reg1, pos1),
          (try_end),
        (try_end),
      (try_end),
      (create_button_overlay, "$g_presentation_obj_1", "@More.", 16),
      (position_set_x, pos1, 600),
      (position_set_y, pos1, 40),
      (overlay_set_position, "$g_presentation_obj_1", pos1),
      (create_button_overlay, "$g_presentation_obj_2", "@Back.", 16),
      (position_set_x, pos1, 400),
      (position_set_y, pos1, 40),
      (overlay_set_position, "$g_presentation_obj_2", pos1),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (try_begin),
        (eq, ":var0", "$g_presentation_obj_1"),
        (assign, ":var1", 5),
        (assign, ":var2", "$g_achieve_bitfield"),
        (assign, ":var3", 0),
        (assign, ":var4", 0),
        (assign, ":var5", 0),
        (try_begin),
          (store_and, ":var5", ":var2", 16777216),
          (neq, ":var5", 0),
          (val_sub, ":var2", 16777216),
        (try_end),
        (try_begin),
          (store_and, ":var5", ":var2", 33554432),
          (neq, ":var5", 0),
          (val_sub, ":var2", 33554432),
        (try_end),
        (try_for_range, ":var6", 0, 28),
          (store_mod, ":var7", ":var2", 2),
          (try_begin),
            (neq, ":var7", 0),
            (val_add, ":var4", 1),
          (try_end),
          (val_div, ":var2", 2),
        (try_end),
        (store_add, ":var3", "$g_achievement_page_no", 1),
        (val_mul, ":var3", ":var1"),
        (gt, ":var4", ":var3"),
        (val_add, "$g_achievement_page_no", 1),
        (start_presentation, "prsnt_achievement_report"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_2"),
        (assign, "$g_achievement_page_no", 0),
        (presentation_set_duration, 0),
        (change_screen_return),
      (try_end),
    ]),
  ]),

  ("achievement_notify", 0, mesh_load_window,
  [
    (ti_on_presentation_load,
    [
      (presentation_set_duration, 999999),
      (set_fixed_point_multiplier, 1000),
      (create_text_overlay, reg1, "@You have been awarded an Achievement!", 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 695),
      (overlay_set_position, reg1, pos1),
      (create_text_overlay, reg1, s11, 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 85),
      (overlay_set_position, reg1, pos1),
      (create_mesh_overlay_with_tableau_material, reg1, -1, "tableau_achievement_troop", reg11),
      (position_set_x, pos1, 200),
      (position_set_y, pos1, 180),
      (overlay_set_position, reg1, pos1),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (create_button_overlay, "$g_presentation_obj_1", "@Continue.", 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 35),
      (overlay_set_position, "$g_presentation_obj_1", pos1),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (try_begin),
        (eq, ":var0", "$g_presentation_obj_1"),
        (presentation_set_duration, 0),
        (change_screen_return),
      (try_end),
    ]),
  ]),

  ("order_founded", 0, mesh_load_window,
  [
    (ti_on_presentation_load,
    [
      (presentation_set_duration, 999999),
      (set_fixed_point_multiplier, 1000),
      (create_text_overlay, reg1, "@A Knighthood Order chapterhouse is founded", 16),
      (init_position, pos1),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 695),
      (overlay_set_position, reg1, pos1),
      (store_faction_of_party, ":var0", "$g_notification_menu_var2"),
      (party_get_slot, ":var1", "$g_notification_menu_var2", 7),
      (str_store_troop_name, s11, ":var1"),
      (str_store_faction_name, s12, ":var0"),
      (str_store_faction_name, s13, "$g_notification_menu_var1"),
      (str_store_party_name, s14, "$g_notification_menu_var2"),
      (create_text_overlay, reg1, "@{s11} of the {s12} has founded a chapterhouse of the Order of the {s13} in {s14}.", 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 85),
      (overlay_set_position, reg1, pos1),
      (create_mesh_overlay_with_tableau_material, reg1, -1, "tableau_achievement_troop", 101),
      (position_set_x, pos1, 200),
      (position_set_y, pos1, 180),
      (overlay_set_position, reg1, pos1),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (create_button_overlay, "$g_presentation_obj_1", "@Continue.", 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 35),
      (overlay_set_position, "$g_presentation_obj_1", pos1),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (try_begin),
        (eq, ":var0", "$g_presentation_obj_1"),
        (presentation_set_duration, 0),
        (change_screen_return),
      (try_end),
    ]),
  ]),

  ("victory_screen_simple", 0, mesh_load_window,
  [
    (ti_on_presentation_load,
    [
      (presentation_set_duration, 999999),
      (set_fixed_point_multiplier, 1000),
      (str_store_faction_name, s11, "$players_kingdom"),
      (create_text_overlay, reg1, "@Pendor :  Conquered by {s11}", 16),
      (init_position, pos1),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 695),
      (overlay_set_position, reg1, pos1),
      (create_text_overlay, reg1, "@The {s11} has defeated all rivals and stands as the sole kingdom.  The Prophecy of Madigan has been fulfilled!^^ An Alternate Probability has been created.", 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 85),
      (overlay_set_position, reg1, pos1),
      (create_mesh_overlay_with_tableau_material, reg1, -1, "tableau_achievement_troop", 100),
      (position_set_x, pos1, 200),
      (position_set_y, pos1, 180),
      (overlay_set_position, reg1, pos1),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (create_button_overlay, "$g_presentation_obj_1", "@Continue.", 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 35),
      (overlay_set_position, "$g_presentation_obj_1", pos1),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (try_begin),
        (eq, ":var0", "$g_presentation_obj_1"),
        (presentation_set_duration, 0),
        (change_screen_return),
      (try_end),
    ]),
  ]),

  ("group_photo", 0, mesh_load_window,
  [
    (ti_on_presentation_load,
    [
      (presentation_set_duration, 999999),
      (set_fixed_point_multiplier, 1000),
      (create_text_overlay, reg1, "@Pendor :  Conquered by One Kingdom", 16),
      (init_position, pos1),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 695),
      (overlay_set_position, reg1, pos1),
      (store_troop_faction, ":var0", "trp_player"),
      (str_store_faction_name, s11, ":var0"),
      (create_text_overlay, reg1, "@{s11} has defeated all rivals and stands as the sole kingdom.  The Prophecy of Madigan has been fulfilled!^^ An Alternate Probability has been created.", 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 85),
      (overlay_set_position, reg1, pos1),
      (create_mesh_overlay_with_tableau_material, reg1, -1, "tableau_group_companions"),
      (position_set_x, pos1, 50),
      (position_set_y, pos1, 20),
      (overlay_set_position, reg1, pos1),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (create_button_overlay, "$g_presentation_obj_1", "@Continue.", 16),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 35),
      (overlay_set_position, "$g_presentation_obj_1", pos1),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (try_begin),
        (eq, ":var0", "$g_presentation_obj_1"),
        (presentation_set_duration, 0),
        (change_screen_return),
      (try_end),
    ]),
  ]),

  ("world_map", 0, mesh_load_window,
  [
    (ti_on_presentation_load,
    [
      (presentation_set_duration, 999999),
      (set_fixed_point_multiplier, 1000),
      (assign, ":var0", 70),
      (assign, ":var1", 720),
      (assign, ":var2", -120000),
      (assign, ":var3", 100000),
      (assign, ":var4", -145000),
      (assign, ":var5", 100000),
      (assign, ":var6", ":var2"),
      (assign, ":var7", ":var5"),
      (assign, ":var8", 2000),
      (store_sub, ":var9", ":var3", ":var2"),
      (store_sub, ":var10", ":var5", ":var4"),
      (val_div, ":var9", ":var8"),
      (val_div, ":var10", ":var8"),
      (assign, ":var11", 4),
      (store_mul, ":var12", ":var11", 50),
      (position_set_x, pos2, ":var12"),
      (position_set_y, pos2, ":var12"),
      (assign, ":var13", ":var0"),
      (assign, ":var14", ":var1"),
      (assign, ":var15", ":var6"),
      (assign, ":var16", ":var7"),
      (try_for_range, ":var17", 0, ":var10"),
        (try_for_range, ":var18", 0, ":var9"),
          (assign, ":var19", 16777215),
          (position_set_x, pos3, ":var15"),
          (position_set_y, pos3, ":var16"),
          (party_set_position, "p_temp_party", pos3),
          (party_get_current_terrain, ":var20", "p_temp_party"),
          (try_begin),
            (neq, ":var20", 1),
            (neq, ":var20", 2),
            (neq, ":var20", 3),
            (neq, ":var20", 4),
            (neq, ":var20", 5),
            (neq, ":var20", 7),
            (neq, ":var20", 8),
            (neq, ":var20", 9),
            (neq, ":var20", 10),
            (neq, ":var20", 11),
            (neq, ":var20", 12),
            (neq, ":var20", 13),
            (assign, ":var19", 2852159231),
          (else_try),
            (call_script, "script_get_closest_center", "p_temp_party"),
            (assign, ":var21", reg0),
            (try_begin),
              (gt, ":var21", -1),
              (store_faction_of_party, ":var22", ":var21"),
              (is_between, ":var22", "fac_player_supporters_faction", "fac_kingdoms_end"),
              (1277, ":var19", ":var22"),
            (try_end),
          (try_end),
          (create_mesh_overlay, reg0, "mesh_white_plane"),
          (overlay_set_color, reg0, ":var19"),
          (position_set_x, pos1, ":var13"),
          (position_set_y, pos1, ":var14"),
          (overlay_set_position, reg0, pos1),
          (overlay_set_size, reg0, pos2),
          (store_add, ":var23", ":var12", 50),
          (assign, ":var24", 50),
          (try_begin),
            (this_or_next|party_slot_eq, ":var21", 0, 3),
            (party_slot_eq, ":var21", 0, 2),
            (assign, ":var25", ":var21"),
          (else_try),
            (party_slot_eq, ":var21", 0, 4),
            (party_get_slot, ":var25", ":var21", 120),
          (try_end),
          (try_begin),
            (store_sub, ":var26", ":var15", ":var8"),
            (assign, ":var27", ":var16"),
            (position_set_x, pos4, ":var26"),
            (position_set_y, pos4, ":var27"),
            (party_set_position, "p_temp_party", pos4),
            (party_get_current_terrain, ":var28", "p_temp_party"),
            (try_begin),
              (assign, ":var29", 0),
              (try_begin),
                (neq, ":var20", 0),
                (neq, ":var28", 0),
                (call_script, "script_get_closest_center", "p_temp_party"),
                (assign, ":var30", reg0),
                (try_begin),
                  (gt, ":var30", -1),
                  (try_begin),
                    (this_or_next|party_slot_eq, ":var30", 0, 3),
                    (party_slot_eq, ":var30", 0, 2),
                    (assign, ":var31", ":var30"),
                  (else_try),
                    (party_slot_eq, ":var30", 0, 4),
                    (party_get_slot, ":var31", ":var30", 120),
                  (try_end),
                  (neq, ":var31", ":var25"),
                  (assign, ":var29", 1),
                (try_end),
              (else_try),
                (neq, ":var20", ":var28"),
                (this_or_next|eq, ":var20", 0),
                (eq, ":var28", 0),
                (assign, ":var29", 1),
              (try_end),
              (eq, ":var29", 1),
              (create_mesh_overlay, reg0, "mesh_white_plane"),
              (overlay_set_color, reg0, 0),
              (position_set_x, pos1, ":var13"),
              (position_set_y, pos1, ":var14"),
              (overlay_set_position, reg0, pos1),
              (position_set_x, pos1, ":var24"),
              (position_set_y, pos1, ":var23"),
              (overlay_set_size, reg0, pos1),
            (try_end),
          (try_end),
          (try_begin),
            (assign, ":var26", ":var15"),
            (store_sub, ":var27", ":var16", ":var8"),
            (position_set_x, pos4, ":var26"),
            (position_set_y, pos4, ":var27"),
            (party_set_position, "p_temp_party", pos4),
            (party_get_current_terrain, ":var28", "p_temp_party"),
            (try_begin),
              (assign, ":var29", 0),
              (try_begin),
                (neq, ":var20", 0),
                (neq, ":var28", 0),
                (call_script, "script_get_closest_center", "p_temp_party"),
                (assign, ":var30", reg0),
                (try_begin),
                  (gt, ":var30", -1),
                  (try_begin),
                    (this_or_next|party_slot_eq, ":var30", 0, 3),
                    (party_slot_eq, ":var30", 0, 2),
                    (assign, ":var31", ":var30"),
                  (else_try),
                    (party_slot_eq, ":var30", 0, 4),
                    (party_get_slot, ":var31", ":var30", 120),
                  (try_end),
                  (neq, ":var31", ":var25"),
                  (assign, ":var29", 1),
                (try_end),
              (else_try),
                (neq, ":var20", ":var28"),
                (this_or_next|eq, ":var20", 0),
                (eq, ":var28", 0),
                (assign, ":var29", 1),
              (try_end),
              (eq, ":var29", 1),
              (create_mesh_overlay, reg0, "mesh_white_plane"),
              (overlay_set_color, reg0, 0),
              (position_set_x, pos1, ":var13"),
              (position_set_y, pos1, ":var14"),
              (overlay_set_position, reg0, pos1),
              (position_set_x, pos1, ":var23"),
              (position_set_y, pos1, ":var24"),
              (overlay_set_size, reg0, pos1),
            (try_end),
          (try_end),
          (val_add, ":var13", ":var11"),
          (val_add, ":var15", ":var8"),
        (try_end),
        (assign, ":var13", ":var0"),
        (val_sub, ":var14", ":var11"),
        (assign, ":var15", ":var6"),
        (val_sub, ":var16", ":var8"),
      (try_end),
      (assign, ":var32", 0),
      (try_for_range, ":var33", "p_town_1", "p_salt_mine"),
        (party_is_active, ":var33"),
        (party_get_position, pos4, ":var33"),
        (position_get_x, ":var34", pos4),
        (position_get_y, ":var35", pos4),
        (val_sub, ":var34", ":var6"),
        (val_sub, ":var35", ":var7"),
        (val_mul, ":var34", ":var11"),
        (val_mul, ":var35", ":var11"),
        (val_div, ":var34", ":var8"),
        (val_div, ":var35", ":var8"),
        (val_add, ":var34", ":var0"),
        (val_add, ":var35", ":var1"),
        (try_begin),
          (party_slot_eq, ":var33", 0, 3),
          (assign, ":var36", 8),
          (assign, ":var37", 3),
        (else_try),
          (party_slot_eq, ":var33", 0, 2),
          (assign, ":var36", 4),
          (assign, ":var37", 2),
        (else_try),
          (party_slot_eq, ":var33", 0, 4),
          (assign, ":var36", 2),
          (assign, ":var37", 4),
        (try_end),
        (store_div, ":var38", ":var36", 2),
        (val_sub, ":var34", ":var38"),
        (val_sub, ":var35", ":var38"),
        (val_mul, ":var36", 50),
        (create_mesh_overlay, reg0, "mesh_white_plane"),
        (overlay_set_color, reg0, 0),
        (position_set_x, pos1, ":var34"),
        (position_set_y, pos1, ":var35"),
        (overlay_set_position, reg0, pos1),
        (position_set_x, pos1, ":var36"),
        (position_set_y, pos1, ":var36"),
        (overlay_set_size, reg0, pos1),
        (str_store_party_name, s1, ":var33"),
        (create_text_overlay, reg1, s1, 16),
        (store_add, ":var39", ":var34", 0),
        (store_add, ":var40", ":var35", 10),
        (position_set_x, pos1, ":var39"),
        (position_set_y, pos1, ":var40"),
        (overlay_set_position, reg1, pos1),
        (947, reg1, 0),
        (troop_set_slot, "trp_temp_array_a", ":var32", reg0),
        (troop_set_slot, "trp_temp_array_b", ":var32", ":var37"),
        (troop_set_slot, "trp_temp_array_c", ":var32", reg1),
        (val_add, ":var32", 1),
      (try_end),
      (assign, "$temp", ":var32"),
      (create_text_overlay, reg0, "@Factions", 4096),
      (position_set_x, pos1, 790),
      (position_set_y, pos1, 700),
      (overlay_set_position, reg0, pos1),
      (assign, ":var13", 750),
      (assign, ":var14", 650),
      (try_for_range, ":var41", "fac_player_supporters_faction", "fac_kingdoms_end"),
        (faction_slot_eq, ":var41", 21, 0),
        (create_mesh_overlay, reg0, "mesh_white_plane"),
        (1277, ":var19", ":var41"),
        (overlay_set_color, reg0, ":var19"),
        (position_set_x, pos1, ":var13"),
        (position_set_y, pos1, ":var14"),
        (overlay_set_position, reg0, pos1),
        (position_set_x, pos1, 1750),
        (position_set_y, pos1, 1250),
        (overlay_set_size, reg0, pos1),
        (store_add, ":var39", ":var13", 40),
        (store_add, ":var40", ":var14", 12),
        (str_store_faction_name, s1, ":var41"),
        (create_text_overlay, reg0, s1, 4096),
        (position_set_x, pos1, ":var39"),
        (position_set_y, pos1, ":var40"),
        (overlay_set_position, reg0, pos1),
        (position_set_x, pos1, 900),
        (position_set_y, pos1, 900),
        (overlay_set_size, reg0, pos1),
        (val_sub, ":var14", 40),
      (try_end),
      (create_check_box_overlay, "$g_presentation_obj_1", "mesh_checkbox_off", "mesh_checkbox_on"),
      (position_set_x, pos1, 50),
      (position_set_y, pos1, 110),
      (overlay_set_position, "$g_presentation_obj_1", pos1),
      (overlay_set_val, "$g_presentation_obj_1", 1),
      (create_text_overlay, reg0, "@Show towns", 4096),
      (position_set_x, pos1, 80),
      (position_set_y, pos1, 120),
      (overlay_set_position, reg0, pos1),
      (create_check_box_overlay, "$g_presentation_obj_2", "mesh_checkbox_off", "mesh_checkbox_on"),
      (position_set_x, pos1, 250),
      (position_set_y, pos1, 110),
      (overlay_set_position, "$g_presentation_obj_2", pos1),
      (overlay_set_val, "$g_presentation_obj_2", 1),
      (create_text_overlay, reg0, "@Show castles", 4096),
      (position_set_x, pos1, 280),
      (position_set_y, pos1, 120),
      (overlay_set_position, reg0, pos1),
      (create_check_box_overlay, "$g_presentation_obj_3", "mesh_checkbox_off", "mesh_checkbox_on"),
      (position_set_x, pos1, 450),
      (position_set_y, pos1, 110),
      (overlay_set_position, "$g_presentation_obj_3", pos1),
      (overlay_set_val, "$g_presentation_obj_3", 1),
      (create_text_overlay, reg0, "@Show villages", 4096),
      (position_set_x, pos1, 480),
      (position_set_y, pos1, 120),
      (overlay_set_position, reg0, pos1),
      (create_text_overlay, reg0, "@Tip: move the mouse onto the black blocks to show their names.", 4096),
      (position_set_x, pos1, 50),
      (position_set_y, pos1, 95),
      (overlay_set_position, reg0, pos1),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 750),
      (overlay_set_size, reg0, pos1),
      (create_text_overlay, reg0, "@The World Map", 2064),
      (position_set_x, pos1, 380),
      (position_set_y, pos1, 30),
      (overlay_set_position, reg0, pos1),
      (position_set_x, pos1, 2000),
      (position_set_y, pos1, 2000),
      (overlay_set_size, reg0, pos1),
      (create_game_button_overlay, "$g_presentation_obj_5", "@Done"),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 25),
      (overlay_set_position, "$g_presentation_obj_5", pos1),
    ]),
    (ti_on_presentation_mouse_enter_leave,
    [
      (store_trigger_param_1, ":var0"),
      (store_trigger_param_2, ":var1"),
      (try_for_range, ":var2", 0, "$temp"),
        (troop_slot_eq, "trp_temp_array_a", ":var2", ":var0"),
        (store_sub, ":var3", 1, ":var1"),
        (troop_get_slot, ":var4", "trp_temp_array_c", ":var2"),
        (947, ":var4", ":var3"),
      (try_end),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (store_trigger_param_2, ":var1"),
      (try_begin),
        (eq, ":var0", "$g_presentation_obj_1"),
        (try_for_range, ":var2", 0, "$temp"),
          (troop_slot_eq, "trp_temp_array_b", ":var2", 3),
          (troop_get_slot, ":var3", "trp_temp_array_a", ":var2"),
          (947, ":var3", ":var1"),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_2"),
        (try_for_range, ":var2", 0, "$temp"),
          (troop_slot_eq, "trp_temp_array_b", ":var2", 2),
          (troop_get_slot, ":var3", "trp_temp_array_a", ":var2"),
          (947, ":var3", ":var1"),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_3"),
        (try_for_range, ":var2", 0, "$temp"),
          (troop_slot_eq, "trp_temp_array_b", ":var2", 4),
          (troop_get_slot, ":var3", "trp_temp_array_a", ":var2"),
          (947, ":var3", ":var1"),
        (try_end),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_5"),
        (presentation_set_duration, 0),
      (try_end),
    ]),
  ]),

  ("mod_options", 0, mesh_load_window,
  [
    (ti_on_presentation_load,
    [
      (presentation_set_duration, 999999),
      (set_fixed_point_multiplier, 1000),
      (create_mesh_overlay, reg1, "mesh_pic_pendor_gameoptions"),
      (position_set_x, pos1, -70),
      (position_set_y, pos1, 450),
      (overlay_set_position, reg1, pos1),
      (position_set_x, pos1, 400),
      (position_set_y, pos1, 400),
      (overlay_set_size, reg1, pos1),
      (overlay_set_alpha, reg1, 0x55),
      (create_text_overlay, reg1, "@P o P   O p t i o n s", 65552),
      (overlay_set_color, reg1, 16724787),
      (position_set_x, pos0, 500),
      (position_set_y, pos0, 685),
      (overlay_set_position, reg1, pos0),
      (create_text_overlay, reg1, "@Scroll down for more options", 16),
      (overlay_set_color, reg1, 5592405),
      (position_set_x, pos1, 800),
      (position_set_y, pos1, 800),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos0, 495),
      (position_set_y, pos0, 667),
      (overlay_set_position, reg1, pos0),
      (str_clear, s0),
      (create_text_overlay, reg1, s0, 8192),
      (position_set_x, pos1, 100),
      (position_set_y, pos1, 100),
      (overlay_set_position, reg1, pos1),
      (position_set_x, pos1, 800),
      (position_set_y, pos1, 555),
      (overlay_set_area_size, reg1, pos1),
      (945, reg1),
      (position_set_x, pos0, 400),
      (assign, ":var0", 790),
      (create_text_overlay, reg1, "@Battle options", 16),
      (overlay_set_color, reg1, 4473924),
      (position_set_x, pos1, 800),
      (position_set_y, pos1, 800),
      (overlay_set_size, reg1, pos1),
      (position_set_y, pos0, ":var0"),
      (overlay_set_position, reg1, pos0),
      (val_sub, ":var0", 31),
      (create_text_overlay, reg1, "@Battlefield size ", 8),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (position_set_y, pos0, ":var0"),
      (overlay_set_position, reg1, pos0),
      (create_combo_button_overlay, "$form_options_overlay_14"),
      (position_set_x, pos2, 700),
      (position_set_y, pos2, 700),
      (overlay_set_size, "$form_options_overlay_14", pos2),
      (overlay_add_item, "$form_options_overlay_14", "@840x840m"),
      (overlay_add_item, "$form_options_overlay_14", "@550x550m"),
      (overlay_add_item, "$form_options_overlay_14", "@240x240m"),
      (overlay_add_item, "$form_options_overlay_14", "@Adaptive"),
      (copy_position, pos1, pos0),
      (store_add, reg2, ":var0", 0),
      (position_set_y, pos1, reg2),
      (position_get_x, ":var1", pos1),
      (val_add, ":var1", 91),
      (position_set_x, pos1, ":var1"),
      (overlay_set_position, "$form_options_overlay_14", pos1),
      (overlay_set_val, "$form_options_overlay_14", "$bf_size_option"),
      (val_sub, ":var0", 31),
      (create_text_overlay, reg1, "@Battle reinforcement waves ", 8),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (position_set_y, pos0, ":var0"),
      (overlay_set_position, reg1, pos0),
      (create_combo_button_overlay, "$form_options_overlay_15"),
      (position_set_x, pos2, 700),
      (position_set_y, pos2, 700),
      (overlay_set_size, "$form_options_overlay_15", pos2),
      (overlay_add_item, "$form_options_overlay_15", "@Unlimited"),
      (overlay_add_item, "$form_options_overlay_15", "@18"),
      (overlay_add_item, "$form_options_overlay_15", "@16"),
      (overlay_add_item, "$form_options_overlay_15", "@14"),
      (overlay_add_item, "$form_options_overlay_15", "@12"),
      (overlay_add_item, "$form_options_overlay_15", "@10"),
      (overlay_add_item, "$form_options_overlay_15", "@8"),
      (overlay_add_item, "$form_options_overlay_15", "@6"),
      (overlay_add_item, "$form_options_overlay_15", "@4"),
      (overlay_add_item, "$form_options_overlay_15", "@2"),
      (overlay_add_item, "$form_options_overlay_15", "@0"),
      (copy_position, pos1, pos0),
      (store_add, reg2, ":var0", 0),
      (position_set_y, pos1, reg2),
      (position_get_x, ":var1", pos1),
      (val_add, ":var1", 91),
      (position_set_x, pos1, ":var1"),
      (overlay_set_position, "$form_options_overlay_15", pos1),
      (store_sub, ":var2", 20, "$g_defender_reinforcement_limit"),
      (val_div, ":var2", 2),
      (overlay_set_val, "$form_options_overlay_15", ":var2"),
      (val_sub, ":var0", 31),
      (create_text_overlay, reg1, "@Siege reinforcement waves ", 8),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (position_set_y, pos0, ":var0"),
      (overlay_set_position, reg1, pos0),
      (create_combo_button_overlay, "$form_options_overlay_16"),
      (position_set_x, pos2, 700),
      (position_set_y, pos2, 700),
      (overlay_set_size, "$form_options_overlay_16", pos2),
      (overlay_add_item, "$form_options_overlay_16", "@Unlimited"),
      (overlay_add_item, "$form_options_overlay_16", "@36"),
      (overlay_add_item, "$form_options_overlay_16", "@32"),
      (overlay_add_item, "$form_options_overlay_16", "@28"),
      (overlay_add_item, "$form_options_overlay_16", "@24"),
      (overlay_add_item, "$form_options_overlay_16", "@20"),
      (overlay_add_item, "$form_options_overlay_16", "@16"),
      (overlay_add_item, "$form_options_overlay_16", "@12"),
      (overlay_add_item, "$form_options_overlay_16", "@8"),
      (overlay_add_item, "$form_options_overlay_16", "@4"),
      (overlay_add_item, "$form_options_overlay_16", "@0"),
      (copy_position, pos1, pos0),
      (store_add, reg2, ":var0", 0),
      (position_set_y, pos1, reg2),
      (position_get_x, ":var1", pos1),
      (val_add, ":var1", 91),
      (position_set_x, pos1, ":var1"),
      (overlay_set_position, "$form_options_overlay_16", pos1),
      (store_sub, ":var3", 40, "$g_defender_reinforcement_limit_siege"),
      (val_div, ":var3", 4),
      (overlay_set_val, "$form_options_overlay_16", ":var3"),
      (val_sub, ":var0", 31),
      (create_text_overlay, reg1, "@Enhanced horse archers AI ", 8),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (position_set_y, pos0, ":var0"),
      (overlay_set_position, reg1, pos0),
      (create_combo_button_overlay, "$form_options_overlay_21"),
      (position_set_x, pos2, 700),
      (position_set_y, pos2, 700),
      (overlay_set_size, "$form_options_overlay_21", pos2),
      (overlay_add_item, "$form_options_overlay_21", "@Disabled"),
      (overlay_add_item, "$form_options_overlay_21", "@NPCs only"),
      (overlay_add_item, "$form_options_overlay_21", "@All units"),
      (copy_position, pos1, pos0),
      (store_add, reg2, ":var0", 0),
      (position_set_y, pos1, reg2),
      (position_get_x, ":var1", pos1),
      (val_add, ":var1", 91),
      (position_set_x, pos1, ":var1"),
      (overlay_set_position, "$form_options_overlay_21", pos1),
      (overlay_set_val, "$form_options_overlay_21", "$horse_archer_ai_state"),
      (val_sub, ":var0", 31),
      (create_text_overlay, reg1, "@Garrison left by AI in taken fief ", 8),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (position_set_y, pos0, ":var0"),
      (overlay_set_position, reg1, pos0),
      (create_combo_button_overlay, "$form_options_overlay_22"),
      (position_set_x, pos2, 700),
      (position_set_y, pos2, 700),
      (overlay_set_size, "$form_options_overlay_22", pos2),
      (overlay_add_item, "$form_options_overlay_22", "@Large (default)"),
      (overlay_add_item, "$form_options_overlay_22", "@Medium"),
      (overlay_add_item, "$form_options_overlay_22", "@Small"),
      (copy_position, pos1, pos0),
      (store_add, reg2, ":var0", 0),
      (position_set_y, pos1, reg2),
      (position_get_x, ":var1", pos1),
      (val_add, ":var1", 91),
      (position_set_x, pos1, ":var1"),
      (overlay_set_position, "$form_options_overlay_22", pos1),
      (overlay_set_val, "$form_options_overlay_22", "$garrison_left_AI"),
      (val_sub, ":var0", 31),
      (create_text_overlay, reg1, "@Disable troop routing ", 8),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (position_set_y, pos0, ":var0"),
      (overlay_set_position, reg1, pos0),
      (create_check_box_overlay, "$form_options_overlay_8", "mesh_checkbox_off", "mesh_checkbox_on"),
      (copy_position, pos1, pos0),
      (store_add, reg2, ":var0", 4),
      (position_set_y, pos1, reg2),
      (overlay_set_position, "$form_options_overlay_8", pos1),
      (overlay_set_val, "$form_options_overlay_8", "$g_option_routing"),
      (val_sub, ":var0", 31),
      (create_text_overlay, reg1, "@Enable Formations ", 8),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (position_set_y, pos0, ":var0"),
      (overlay_set_position, reg1, pos0),
      (create_check_box_overlay, "$form_options_overlay_3", "mesh_checkbox_off", "mesh_checkbox_on"),
      (copy_position, pos1, pos0),
      (store_add, reg2, ":var0", 4),
      (position_set_y, pos1, reg2),
      (overlay_set_position, "$form_options_overlay_3", pos1),
      (overlay_set_val, "$form_options_overlay_3", "$g_option_formations"),
      (val_sub, ":var0", 31),
      (create_text_overlay, reg1, "@Battle interface", 16),
      (overlay_set_color, reg1, 4473924),
      (position_set_x, pos1, 800),
      (position_set_y, pos1, 800),
      (overlay_set_size, reg1, pos1),
      (position_set_y, pos0, ":var0"),
      (overlay_set_position, reg1, pos0),
      (val_sub, ":var0", 31),
      (create_text_overlay, reg1, "@Show personal kill count ", 8),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (position_set_y, pos0, ":var0"),
      (overlay_set_position, reg1, pos0),
      (create_check_box_overlay, "$form_options_overlay_6", "mesh_checkbox_off", "mesh_checkbox_on"),
      (copy_position, pos1, pos0),
      (store_add, reg2, ":var0", 4),
      (position_set_y, pos1, reg2),
      (overlay_set_position, "$form_options_overlay_6", pos1),
      (overlay_set_val, "$form_options_overlay_6", "$g_option_show_killcount"),
      (val_sub, ":var0", 31),
      (create_text_overlay, reg1, "@Battle ratio bar ", 8),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (position_set_y, pos0, ":var0"),
      (overlay_set_position, reg1, pos0),
      (create_check_box_overlay, "$form_options_overlay_17", "mesh_checkbox_off", "mesh_checkbox_on"),
      (copy_position, pos1, pos0),
      (store_add, reg2, ":var0", 4),
      (position_set_y, pos1, reg2),
      (overlay_set_position, "$form_options_overlay_17", pos1),
      (overlay_set_val, "$form_options_overlay_17", "$g_option_show_ratio_bar"),
      (create_text_overlay, reg1, "@shows proportion of soldiers alive on each side", 4),
      (overlay_set_color, reg1, 7829367),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos3, 417),
      (position_set_y, pos3, ":var0"),
      (overlay_set_position, reg1, pos3),
      (val_sub, ":var0", 31),
      (create_text_overlay, reg1, "@Ratio bar shows reserve forces too ", 8),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (try_begin),
        (eq, "$g_option_show_ratio_bar", 1),
        (overlay_set_color, reg1, 0),
      (else_try),
        (overlay_set_color, reg1, 8947848),
      (try_end),
      (position_set_y, pos0, ":var0"),
      (overlay_set_position, reg1, pos0),
      (create_check_box_overlay, "$form_options_overlay_18", "mesh_checkbox_off", "mesh_checkbox_on"),
      (try_begin),
        (eq, "$g_option_show_ratio_bar", 1),
        (overlay_set_alpha, "$form_options_overlay_18", 0xFF),
      (else_try),
        (overlay_set_alpha, "$form_options_overlay_18", 0x44),
      (try_end),
      (copy_position, pos1, pos0),
      (store_add, reg2, ":var0", 4),
      (position_set_y, pos1, reg2),
      (overlay_set_position, "$form_options_overlay_18", pos1),
      (overlay_set_val, "$form_options_overlay_18", "$g_option_ratio_bar_is_global"),
      (create_text_overlay, reg1, "@reports global battle forces including reinforcements", 4),
      (overlay_set_color, reg1, 7829367),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos3, 417),
      (position_set_y, pos3, ":var0"),
      (overlay_set_position, reg1, pos3),
      (val_sub, ":var0", 31),
      (create_text_overlay, reg1, "@Display a message on ally death ", 8),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (position_set_y, pos0, ":var0"),
      (overlay_set_position, reg1, pos0),
      (create_check_box_overlay, "$form_options_overlay_19", "mesh_checkbox_off", "mesh_checkbox_on"),
      (copy_position, pos1, pos0),
      (store_add, reg2, ":var0", 4),
      (position_set_y, pos1, reg2),
      (overlay_set_position, "$form_options_overlay_19", pos1),
      (overlay_set_val, "$form_options_overlay_19", "$g_option_message_on_soldier_death"),
      (create_text_overlay, reg1, "@best with 'report casualties' ticked off", 4),
      (overlay_set_color, reg1, 7829367),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos3, 417),
      (position_set_y, pos3, ":var0"),
      (overlay_set_position, reg1, pos3),
      (val_sub, ":var0", 31),
      (create_text_overlay, reg1, "@Display a message on player kill ", 8),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (position_set_y, pos0, ":var0"),
      (overlay_set_position, reg1, pos0),
      (create_check_box_overlay, "$form_options_overlay_20", "mesh_checkbox_off", "mesh_checkbox_on"),
      (copy_position, pos1, pos0),
      (store_add, reg2, ":var0", 4),
      (position_set_y, pos1, reg2),
      (overlay_set_position, "$form_options_overlay_20", pos1),
      (overlay_set_val, "$form_options_overlay_20", "$g_option_message_on_player_kill"),
      (create_text_overlay, reg1, "@best with 'report casualties' ticked off", 4),
      (overlay_set_color, reg1, 7829367),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos3, 417),
      (position_set_y, pos3, ":var0"),
      (overlay_set_position, reg1, pos3),
      (val_sub, ":var0", 31),
      (create_text_overlay, reg1, "@Custom Knighthood Order", 16),
      (overlay_set_color, reg1, 4473924),
      (position_set_x, pos1, 800),
      (position_set_y, pos1, 800),
      (overlay_set_size, reg1, pos1),
      (position_set_y, pos0, ":var0"),
      (overlay_set_position, reg1, pos0),
      (val_sub, ":var0", 31),
      (create_text_overlay, reg1, "@Chance of stats upgrade during 18hr training session ", 8),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (position_set_y, pos0, ":var0"),
      (overlay_set_position, reg1, pos0),
      (create_combo_button_overlay, "$form_options_overlay_23"),
      (position_set_x, pos2, 700),
      (position_set_y, pos2, 700),
      (overlay_set_size, "$form_options_overlay_23", pos2),
      (overlay_add_item, "$form_options_overlay_23", "@1.5%"),
      (overlay_add_item, "$form_options_overlay_23", "@2%"),
      (overlay_add_item, "$form_options_overlay_23", "@3% (Default)"),
      (overlay_add_item, "$form_options_overlay_23", "@4%"),
      (overlay_add_item, "$form_options_overlay_23", "@5.5%"),
      (overlay_add_item, "$form_options_overlay_23", "@7.5%"),
      (overlay_add_item, "$form_options_overlay_23", "@10%"),
      (overlay_add_item, "$form_options_overlay_23", "@13%"),
      (overlay_add_item, "$form_options_overlay_23", "@17%"),
      (overlay_add_item, "$form_options_overlay_23", "@25%"),
      (overlay_add_item, "$form_options_overlay_23", "@50%"),
      (copy_position, pos1, pos0),
      (store_add, reg2, ":var0", 0),
      (position_set_y, pos1, reg2),
      (position_get_x, ":var1", pos1),
      (val_add, ":var1", 91),
      (position_set_x, pos1, ":var1"),
      (overlay_set_position, "$form_options_overlay_23", pos1),
      (try_begin),
        (eq, "$cko_training_time_var", 985),
        (overlay_set_val, "$form_options_overlay_23", 0),
      (else_try),
        (eq, "$cko_training_time_var", 980),
        (overlay_set_val, "$form_options_overlay_23", 1),
      (else_try),
        (eq, "$cko_training_time_var", 970),
        (overlay_set_val, "$form_options_overlay_23", 2),
      (else_try),
        (eq, "$cko_training_time_var", 960),
        (overlay_set_val, "$form_options_overlay_23", 3),
      (else_try),
        (eq, "$cko_training_time_var", 945),
        (overlay_set_val, "$form_options_overlay_23", 4),
      (else_try),
        (eq, "$cko_training_time_var", 925),
        (overlay_set_val, "$form_options_overlay_23", 5),
      (else_try),
        (eq, "$cko_training_time_var", 900),
        (overlay_set_val, "$form_options_overlay_23", 6),
      (else_try),
        (eq, "$cko_training_time_var", 870),
        (overlay_set_val, "$form_options_overlay_23", 7),
      (else_try),
        (eq, "$cko_training_time_var", 830),
        (overlay_set_val, "$form_options_overlay_23", 8),
      (else_try),
        (eq, "$cko_training_time_var", 750),
        (overlay_set_val, "$form_options_overlay_23", 9),
      (else_try),
        (eq, "$cko_training_time_var", 500),
        (overlay_set_val, "$form_options_overlay_23", 10),
      (else_try),
        (overlay_set_val, "$form_options_overlay_23", 2),
      (try_end),
      (val_sub, ":var0", 31),
      (create_text_overlay, reg1, "@Equipment cost ", 8),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (position_set_y, pos0, ":var0"),
      (overlay_set_position, reg1, pos0),
      (create_combo_button_overlay, "$form_options_overlay_24"),
      (position_set_x, pos2, 700),
      (position_set_y, pos2, 700),
      (overlay_set_size, "$form_options_overlay_24", pos2),
      (overlay_add_item, "$form_options_overlay_24", "@200%"),
      (overlay_add_item, "$form_options_overlay_24", "@150%"),
      (overlay_add_item, "$form_options_overlay_24", "@120%"),
      (overlay_add_item, "$form_options_overlay_24", "@110%"),
      (overlay_add_item, "$form_options_overlay_24", "@100% (Default)"),
      (overlay_add_item, "$form_options_overlay_24", "@ 90%"),
      (overlay_add_item, "$form_options_overlay_24", "@ 80%"),
      (overlay_add_item, "$form_options_overlay_24", "@ 60%"),
      (overlay_add_item, "$form_options_overlay_24", "@ 40%"),
      (overlay_add_item, "$form_options_overlay_24", "@ 20%"),
      (overlay_add_item, "$form_options_overlay_24", "@ 10%"),
      (copy_position, pos1, pos0),
      (store_add, reg2, ":var0", 0),
      (position_set_y, pos1, reg2),
      (position_get_x, ":var1", pos1),
      (val_add, ":var1", 91),
      (position_set_x, pos1, ":var1"),
      (overlay_set_position, "$form_options_overlay_24", pos1),
      (try_begin),
        (eq, "$cko_equip_cost_var", 200),
        (overlay_set_val, "$form_options_overlay_24", 0),
      (else_try),
        (eq, "$cko_equip_cost_var", 150),
        (overlay_set_val, "$form_options_overlay_24", 1),
      (else_try),
        (eq, "$cko_equip_cost_var", 120),
        (overlay_set_val, "$form_options_overlay_24", 2),
      (else_try),
        (eq, "$cko_equip_cost_var", 110),
        (overlay_set_val, "$form_options_overlay_24", 3),
      (else_try),
        (eq, "$cko_equip_cost_var", 100),
        (overlay_set_val, "$form_options_overlay_24", 4),
      (else_try),
        (eq, "$cko_equip_cost_var", 90),
        (overlay_set_val, "$form_options_overlay_24", 5),
      (else_try),
        (eq, "$cko_equip_cost_var", 80),
        (overlay_set_val, "$form_options_overlay_24", 6),
      (else_try),
        (eq, "$cko_equip_cost_var", 60),
        (overlay_set_val, "$form_options_overlay_24", 7),
      (else_try),
        (eq, "$cko_equip_cost_var", 40),
        (overlay_set_val, "$form_options_overlay_24", 8),
      (else_try),
        (eq, "$cko_equip_cost_var", 20),
        (overlay_set_val, "$form_options_overlay_24", 9),
      (else_try),
        (eq, "$cko_equip_cost_var", 10),
        (overlay_set_val, "$form_options_overlay_24", 10),
      (else_try),
        (overlay_set_val, "$form_options_overlay_24", 4),
      (try_end),
      (val_sub, ":var0", 31),
      (create_text_overlay, reg1, "@Equipping time ", 8),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (position_set_y, pos0, ":var0"),
      (overlay_set_position, reg1, pos0),
      (create_combo_button_overlay, "$form_options_overlay_25"),
      (position_set_x, pos2, 700),
      (position_set_y, pos2, 700),
      (overlay_set_size, "$form_options_overlay_25", pos2),
      (overlay_add_item, "$form_options_overlay_25", "@200%"),
      (overlay_add_item, "$form_options_overlay_25", "@150%"),
      (overlay_add_item, "$form_options_overlay_25", "@120%"),
      (overlay_add_item, "$form_options_overlay_25", "@110%"),
      (overlay_add_item, "$form_options_overlay_25", "@100% (Default)"),
      (overlay_add_item, "$form_options_overlay_25", "@ 90%"),
      (overlay_add_item, "$form_options_overlay_25", "@ 80%"),
      (overlay_add_item, "$form_options_overlay_25", "@ 60%"),
      (overlay_add_item, "$form_options_overlay_25", "@ 40%"),
      (overlay_add_item, "$form_options_overlay_25", "@ 20%"),
      (overlay_add_item, "$form_options_overlay_25", "@ 10%"),
      (copy_position, pos1, pos0),
      (store_add, reg2, ":var0", 0),
      (position_set_y, pos1, reg2),
      (position_get_x, ":var1", pos1),
      (val_add, ":var1", 91),
      (position_set_x, pos1, ":var1"),
      (overlay_set_position, "$form_options_overlay_25", pos1),
      (try_begin),
        (eq, "$cko_equip_time_var", 200),
        (overlay_set_val, "$form_options_overlay_25", 0),
      (else_try),
        (eq, "$cko_equip_time_var", 150),
        (overlay_set_val, "$form_options_overlay_25", 1),
      (else_try),
        (eq, "$cko_equip_time_var", 120),
        (overlay_set_val, "$form_options_overlay_25", 2),
      (else_try),
        (eq, "$cko_equip_time_var", 110),
        (overlay_set_val, "$form_options_overlay_25", 3),
      (else_try),
        (eq, "$cko_equip_time_var", 100),
        (overlay_set_val, "$form_options_overlay_25", 4),
      (else_try),
        (eq, "$cko_equip_time_var", 90),
        (overlay_set_val, "$form_options_overlay_25", 5),
      (else_try),
        (eq, "$cko_equip_time_var", 80),
        (overlay_set_val, "$form_options_overlay_25", 6),
      (else_try),
        (eq, "$cko_equip_time_var", 60),
        (overlay_set_val, "$form_options_overlay_25", 7),
      (else_try),
        (eq, "$cko_equip_time_var", 40),
        (overlay_set_val, "$form_options_overlay_25", 8),
      (else_try),
        (eq, "$cko_equip_time_var", 20),
        (overlay_set_val, "$form_options_overlay_25", 9),
      (else_try),
        (eq, "$cko_equip_time_var", 10),
        (overlay_set_val, "$form_options_overlay_25", 10),
      (else_try),
        (overlay_set_val, "$form_options_overlay_25", 4),
      (try_end),
      (val_sub, ":var0", 31),
      (create_text_overlay, reg1, "@Miscellaneous", 16),
      (overlay_set_color, reg1, 4473924),
      (position_set_x, pos1, 800),
      (position_set_y, pos1, 800),
      (overlay_set_size, reg1, pos1),
      (position_set_y, pos0, ":var0"),
      (overlay_set_position, reg1, pos0),
      (val_sub, ":var0", 31),
      (create_text_overlay, reg1, "@Fade from black ", 8),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (position_set_y, pos0, ":var0"),
      (overlay_set_position, reg1, pos0),
      (create_check_box_overlay, "$form_options_overlay_13", "mesh_checkbox_off", "mesh_checkbox_on"),
      (copy_position, pos1, pos0),
      (store_add, reg2, ":var0", 4),
      (position_set_y, pos1, reg2),
      (overlay_set_position, "$form_options_overlay_13", pos1),
      (overlay_set_val, "$form_options_overlay_13", "$fadefromblack"),
      (create_text_overlay, reg1, "@when entering a room", 4),
      (overlay_set_color, reg1, 7829367),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos3, 417),
      (position_set_y, pos3, ":var0"),
      (overlay_set_position, reg1, pos3),
      (val_sub, ":var0", 31),
      (create_text_overlay, reg1, "@Lords don't bring fiefs when joining player ", 8),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (position_set_y, pos0, ":var0"),
      (overlay_set_position, reg1, pos0),
      (create_check_box_overlay, "$form_options_overlay_9", "mesh_checkbox_off", "mesh_checkbox_on"),
      (copy_position, pos1, pos0),
      (store_add, reg2, ":var0", 4),
      (position_set_y, pos1, reg2),
      (overlay_set_position, "$form_options_overlay_9", pos1),
      (overlay_set_val, "$form_options_overlay_9", "$g_option_lord_no_land"),
      (val_sub, ":var0", 31),
      (create_text_overlay, reg1, "@No auto-defections ", 8),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (position_set_y, pos0, ":var0"),
      (overlay_set_position, reg1, pos0),
      (create_check_box_overlay, "$form_options_overlay_10", "mesh_checkbox_off", "mesh_checkbox_on"),
      (copy_position, pos1, pos0),
      (store_add, reg2, ":var0", 4),
      (position_set_y, pos1, reg2),
      (overlay_set_position, "$form_options_overlay_10", pos1),
      (overlay_set_val, "$form_options_overlay_10", "$g_option_no_defections"),
      (val_sub, ":var0", 31),
      (create_text_overlay, reg1, "@Village requests in notifications only ", 8),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (position_set_y, pos0, ":var0"),
      (overlay_set_position, reg1, pos0),
      (create_check_box_overlay, "$form_options_overlay_11", "mesh_checkbox_off", "mesh_checkbox_on"),
      (copy_position, pos1, pos0),
      (store_add, reg2, ":var0", 4),
      (position_set_y, pos1, reg2),
      (overlay_set_position, "$form_options_overlay_11", pos1),
      (overlay_set_val, "$form_options_overlay_11", "$notif_village_help"),
      (val_sub, ":var0", 31),
      (create_text_overlay, reg1, "@Village attacks in notifications only ", 8),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (position_set_y, pos0, ":var0"),
      (overlay_set_position, reg1, pos0),
      (create_check_box_overlay, "$form_options_overlay_12", "mesh_checkbox_off", "mesh_checkbox_on"),
      (copy_position, pos1, pos0),
      (store_add, reg2, ":var0", 4),
      (position_set_y, pos1, reg2),
      (overlay_set_position, "$form_options_overlay_12", pos1),
      (overlay_set_val, "$form_options_overlay_12", "$notif_village_attacked"),
      (val_sub, ":var0", 31),
      (create_text_overlay, reg1, "@Important news only ", 8),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (position_set_y, pos0, ":var0"),
      (overlay_set_position, reg1, pos0),
      (create_check_box_overlay, "$form_options_overlay_7", "mesh_checkbox_off", "mesh_checkbox_on"),
      (copy_position, pos1, pos0),
      (store_add, reg2, ":var0", 4),
      (position_set_y, pos1, reg2),
      (overlay_set_position, "$form_options_overlay_7", pos1),
      (overlay_set_val, "$form_options_overlay_7", "$g_option_important_news"),
      (val_sub, ":var0", 31),
      (create_text_overlay, reg1, "@Play companion dialogs ", 8),
      (position_set_x, pos1, 900),
      (position_set_y, pos1, 900),
      (overlay_set_size, reg1, pos1),
      (position_set_y, pos0, ":var0"),
      (overlay_set_position, reg1, pos0),
      (create_check_box_overlay, "$form_options_overlay_5", "mesh_checkbox_off", "mesh_checkbox_on"),
      (copy_position, pos1, pos0),
      (store_add, reg2, ":var0", 4),
      (position_set_y, pos1, reg2),
      (overlay_set_position, "$form_options_overlay_5", pos1),
      (overlay_set_val, "$form_options_overlay_5", "$g_option_companion_dialogs"),
      (val_sub, ":var0", 31),
      (945, -1),
      (assign, "$form_options_overlay_exit", 0),
      (create_game_button_overlay, "$form_options_overlay_exit", "str_done"),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 24),
      (overlay_set_position, "$form_options_overlay_exit", pos1),
    ]),
    (ti_on_presentation_run,
    [
      (try_begin),
        (this_or_next|key_clicked, key_escape),
        (key_clicked, key_xbox_start),
        (presentation_set_duration, 0),
      (try_end),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (store_trigger_param_2, ":var1"),
      (try_begin),
        (eq, ":var0", "$form_options_overlay_3"),
        (assign, "$g_option_formations", ":var1"),
      (else_try),
        (eq, ":var0", "$form_options_overlay_5"),
        (assign, "$g_option_companion_dialogs", ":var1"),
      (else_try),
        (eq, ":var0", "$form_options_overlay_6"),
        (assign, "$g_option_show_killcount", ":var1"),
      (else_try),
        (eq, ":var0", "$form_options_overlay_7"),
        (assign, "$g_option_important_news", ":var1"),
      (else_try),
        (eq, ":var0", "$form_options_overlay_8"),
        (assign, "$g_option_routing", ":var1"),
      (else_try),
        (eq, ":var0", "$form_options_overlay_9"),
        (assign, "$g_option_lord_no_land", ":var1"),
      (else_try),
        (eq, ":var0", "$form_options_overlay_10"),
        (assign, "$g_option_no_defections", ":var1"),
      (else_try),
        (eq, ":var0", "$form_options_overlay_11"),
        (assign, "$notif_village_help", ":var1"),
      (else_try),
        (eq, ":var0", "$form_options_overlay_12"),
        (assign, "$notif_village_attacked", ":var1"),
      (else_try),
        (eq, ":var0", "$form_options_overlay_13"),
        (assign, "$fadefromblack", ":var1"),
      (else_try),
        (eq, ":var0", "$form_options_overlay_14"),
        (assign, "$bf_size_option", ":var1"),
      (else_try),
        (eq, ":var0", "$form_options_overlay_15"),
        (val_mul, ":var1", 2),
        (store_sub, ":var2", 20, ":var1"),
        (try_begin),
          (eq, ":var2", 20),
          (assign, ":var2", 10000),
        (try_end),
        (assign, "$g_defender_reinforcement_limit", ":var2"),
        (assign, "$g_attacker_reinforcement_limit", ":var2"),
        (assign, reg0, "$g_attacker_reinforcement_limit"),
        (display_message, "@Reinforcement waves for normal battles have been set to {reg0}", 0x289128),
      (else_try),
        (eq, ":var0", "$form_options_overlay_16"),
        (val_mul, ":var1", 4),
        (store_sub, ":var3", 40, ":var1"),
        (try_begin),
          (eq, ":var3", 40),
          (assign, ":var3", 10000),
        (try_end),
        (assign, "$g_defender_reinforcement_limit_siege", ":var3"),
        (assign, "$g_attacker_reinforcement_limit_siege", ":var3"),
        (assign, reg0, "$g_defender_reinforcement_limit_siege"),
        (display_message, "@Reinforcement waves for siege battles have been set to {reg0}", 0x289128),
      (else_try),
        (eq, ":var0", "$form_options_overlay_17"),
        (assign, "$g_option_show_ratio_bar", ":var1"),
        (start_presentation, "prsnt_mod_options"),
      (else_try),
        (eq, ":var0", "$form_options_overlay_18"),
        (assign, "$g_option_ratio_bar_is_global", ":var1"),
      (else_try),
        (eq, ":var0", "$form_options_overlay_19"),
        (assign, "$g_option_message_on_soldier_death", ":var1"),
      (else_try),
        (eq, ":var0", "$form_options_overlay_20"),
        (assign, "$g_option_message_on_player_kill", ":var1"),
      (else_try),
        (eq, ":var0", "$form_options_overlay_21"),
        (assign, "$horse_archer_ai_state", ":var1"),
      (else_try),
        (eq, ":var0", "$form_options_overlay_22"),
        (assign, "$garrison_left_AI", ":var1"),
      (else_try),
        (eq, ":var0", "$form_options_overlay_23"),
        (try_begin),
          (eq, ":var1", 0),
          (assign, "$cko_training_time_var", 985),
        (else_try),
          (eq, ":var1", 1),
          (assign, "$cko_training_time_var", 980),
        (else_try),
          (eq, ":var1", 2),
          (assign, "$cko_training_time_var", 970),
        (else_try),
          (eq, ":var1", 3),
          (assign, "$cko_training_time_var", 960),
        (else_try),
          (eq, ":var1", 4),
          (assign, "$cko_training_time_var", 945),
        (else_try),
          (eq, ":var1", 5),
          (assign, "$cko_training_time_var", 925),
        (else_try),
          (eq, ":var1", 6),
          (assign, "$cko_training_time_var", 900),
        (else_try),
          (eq, ":var1", 7),
          (assign, "$cko_training_time_var", 870),
        (else_try),
          (eq, ":var1", 8),
          (assign, "$cko_training_time_var", 830),
        (else_try),
          (eq, ":var1", 9),
          (assign, "$cko_training_time_var", 750),
        (else_try),
          (eq, ":var1", 10),
          (assign, "$cko_training_time_var", 500),
        (else_try),
          (assign, "$cko_training_time_var", 970),
        (try_end),
      (else_try),
        (eq, ":var0", "$form_options_overlay_24"),
        (try_begin),
          (eq, ":var1", 0),
          (assign, "$cko_equip_cost_var", 200),
        (else_try),
          (eq, ":var1", 1),
          (assign, "$cko_equip_cost_var", 150),
        (else_try),
          (eq, ":var1", 2),
          (assign, "$cko_equip_cost_var", 120),
        (else_try),
          (eq, ":var1", 3),
          (assign, "$cko_equip_cost_var", 110),
        (else_try),
          (eq, ":var1", 4),
          (assign, "$cko_equip_cost_var", 100),
        (else_try),
          (eq, ":var1", 5),
          (assign, "$cko_equip_cost_var", 90),
        (else_try),
          (eq, ":var1", 6),
          (assign, "$cko_equip_cost_var", 80),
        (else_try),
          (eq, ":var1", 7),
          (assign, "$cko_equip_cost_var", 60),
        (else_try),
          (eq, ":var1", 8),
          (assign, "$cko_equip_cost_var", 40),
        (else_try),
          (eq, ":var1", 9),
          (assign, "$cko_equip_cost_var", 20),
        (else_try),
          (eq, ":var1", 10),
          (assign, "$cko_equip_cost_var", 10),
        (else_try),
          (assign, "$cko_equip_cost_var", 100),
        (try_end),
      (else_try),
        (eq, ":var0", "$form_options_overlay_25"),
        (try_begin),
          (eq, ":var1", 0),
          (assign, "$cko_equip_time_var", 200),
        (else_try),
          (eq, ":var1", 1),
          (assign, "$cko_equip_time_var", 150),
        (else_try),
          (eq, ":var1", 2),
          (assign, "$cko_equip_time_var", 120),
        (else_try),
          (eq, ":var1", 3),
          (assign, "$cko_equip_time_var", 110),
        (else_try),
          (eq, ":var1", 4),
          (assign, "$cko_equip_time_var", 100),
        (else_try),
          (eq, ":var1", 5),
          (assign, "$cko_equip_time_var", 90),
        (else_try),
          (eq, ":var1", 6),
          (assign, "$cko_equip_time_var", 80),
        (else_try),
          (eq, ":var1", 7),
          (assign, "$cko_equip_time_var", 60),
        (else_try),
          (eq, ":var1", 8),
          (assign, "$cko_equip_time_var", 40),
        (else_try),
          (eq, ":var1", 9),
          (assign, "$cko_equip_time_var", 20),
        (else_try),
          (eq, ":var1", 10),
          (assign, "$cko_equip_time_var", 10),
        (else_try),
          (assign, "$cko_equip_cost_var", 100),
        (try_end),
      (else_try),
        (eq, ":var0", "$form_options_overlay_exit"),
        (presentation_set_duration, 0),
      (try_end),
    ]),
  ]),

  ("faction_troop_trees", 0, mesh_null,
  [
    (ti_on_presentation_load,
    [
      (presentation_set_duration, 999999),
      (set_fixed_point_multiplier, 1000),
      (create_mesh_overlay, reg1, "mesh_load_window_snouz"),
      (position_set_x, pos1, 0),
      (position_set_y, pos1, 0),
      (overlay_set_position, reg1, pos1),
      (create_combo_button_overlay, "$g_presentation_obj_1"),
      (position_set_x, pos1, 500),
      (position_set_y, pos1, 690),
      (overlay_set_position, "$g_presentation_obj_1", pos1),
      (store_sub, ":var0", "fac_kingdoms_end", "fac_kingdom_1"),
      (store_add, ":var1", ":var0", 6),
      (overlay_add_item, "$g_presentation_obj_1", "@Others"),
      (overlay_add_item, "$g_presentation_obj_1", "@KOs Knights"),
      (overlay_add_item, "$g_presentation_obj_1", "@KOs Sergeants"),
      (overlay_add_item, "$g_presentation_obj_1", "@Mercenaries"),
      (overlay_add_item, "$g_presentation_obj_1", "@Adventurers"),
      (overlay_add_item, "$g_presentation_obj_1", "@Kingdom of Pendor"),
      (try_for_range_backwards, ":var2", 0, ":var0"),
        (store_add, ":var3", ":var2", "fac_kingdom_1"),
        (str_store_faction_name, s0, ":var3"),
        (overlay_add_item, "$g_presentation_obj_1", s0),
      (try_end),
      (store_sub, ":var4", ":var1", "$g_selected_page"),
      (val_sub, ":var4", 1),
      (overlay_set_val, "$g_presentation_obj_1", ":var4"),
      (create_game_button_overlay, "$g_presentation_obj_2", "@Close"),
      (position_set_x, pos1, 750),
      (position_set_y, pos1, 685),
      (overlay_set_position, "$g_presentation_obj_2", pos1),
      (create_text_overlay, reg1, "@Click the avatars to view details of them", 4),
      (position_set_x, pos1, 800),
      (position_set_y, pos1, 800),
      (overlay_set_size, reg1, pos1),
      (position_set_x, pos1, 60),
      (position_set_y, pos1, 690),
      (overlay_set_position, reg1, pos1),
      (try_begin),
        (is_between, "$g_selected_page", 0, ":var0"),
        (store_add, ":var5", "mesh_pic_arms_swadian", "$g_selected_page"),
        (create_mesh_overlay, reg1, ":var5"),
        (position_set_x, pos1, 60),
        (position_set_y, pos1, 60),
        (overlay_set_position, reg1, pos1),
        (position_set_x, pos1, 300),
        (position_set_y, pos1, 300),
        (overlay_set_size, reg1, pos1),
        (overlay_set_alpha, reg1, 0x11),
      (try_end),
      (assign, ":var6", 1),
      (try_for_range, ":var7", "trp_farmer", "trp_town_walker_1"),
        (neg|troop_is_hero, ":var7"),
        (troop_get_upgrade_troop, ":var8", ":var7", 0),
        (try_begin),
          (is_between, ":var7", "trp_dragon_drake", "trp_maiden_noble"),
          (store_sub, ":var9", "trp_dragon_drake", "trp_dragon_knight"),
          (store_sub, ":var8", ":var7", ":var9"),
        (else_try),
          (is_between, ":var7", "trp_dragon_knight", "trp_zombie"),
          (store_sub, ":var9", "trp_dragon_drake", "trp_dragon_knight"),
          (store_add, ":var8", ":var7", ":var9"),
        (try_end),
        (gt, ":var8", 0),
        (call_script, "script_get_page_no_of_troop_tree_for_troop_on", ":var7"),
        (assign, ":var10", reg0),
        (eq, ":var10", "$g_selected_page"),
        (assign, reg0, 1),
        (call_script, "script_troop_tree_recursive_detect_max_tier", ":var7", 1),
        (assign, ":var11", reg0),
        (try_begin),
          (gt, ":var11", ":var6"),
          (assign, ":var6", ":var11"),
        (try_end),
      (try_end),
      (val_sub, ":var6", 1),
      (val_max, ":var6", 1),
      (store_div, ":var12", 700, ":var6"),
      (val_min, ":var12", 120),
      (str_clear, s0),
      (create_text_overlay, reg1, s0, 8192),
      (position_set_x, pos1, 15),
      (position_set_y, pos1, 15),
      (overlay_set_position, reg1, pos1),
      (position_set_x, pos1, 800),
      (position_set_y, pos1, 660),
      (overlay_set_area_size, reg1, pos1),
      (945, reg1),
      (assign, "$g_cur_slot_no", 0),
      (assign, reg2, 75),
      (try_for_range, ":var7", "trp_farmer", "trp_town_walker_1"),
        (neg|troop_is_hero, ":var7"),
        (troop_get_upgrade_troop, ":var8", ":var7", 0),
        (try_begin),
          (is_between, ":var7", "trp_dragon_drake", "trp_maiden_noble"),
          (store_sub, ":var9", "trp_dragon_drake", "trp_dragon_knight"),
          (store_sub, ":var8", ":var7", ":var9"),
        (else_try),
          (is_between, ":var7", "trp_dragon_knight", "trp_zombie"),
          (store_sub, ":var9", "trp_dragon_drake", "trp_dragon_knight"),
          (store_add, ":var8", ":var7", ":var9"),
        (try_end),
        (gt, ":var8", 0),
        (call_script, "script_get_page_no_of_troop_tree_for_troop_on", ":var7"),
        (assign, ":var10", reg0),
        (eq, ":var10", "$g_selected_page"),
        (assign, ":var13", 1),
        (assign, ":var14", "trp_town_walker_1"),
        (try_for_range, ":var15", "trp_farmer", ":var14"),
          (neg|troop_is_hero, ":var15"),
          (call_script, "script_get_page_no_of_troop_tree_for_troop_on", ":var15"),
          (assign, ":var16", reg0),
          (eq, ":var16", "$g_selected_page"),
          (troop_get_upgrade_troop, ":var17", ":var15", 0),
          (troop_get_upgrade_troop, ":var18", ":var15", 1),
          (this_or_next|eq, ":var17", ":var7"),
          (eq, ":var18", ":var7"),
          (assign, ":var13", 0),
          (assign, ":var14", 0),
        (try_end),
        (eq, ":var13", 1),
        (call_script, "script_get_page_no_of_troop_tree_for_troop_on", ":var7"),
        (assign, ":var2", reg0),
        (neq, ":var2", 50),
        (call_script, "script_troop_tree_recursive_backtracking", ":var7", 50, reg2, ":var12"),
        (val_add, reg2, 160),
      (try_end),
      (945, -1),
      (try_begin),
        (gt, "$g_selected_troop", 0),
        (store_mul, ":var7", "$g_selected_troop", 2),
        (create_image_button_overlay_with_tableau_material, reg1, -1, "tableau_game_party_window", ":var7"),
        (position_set_x, pos1, 450),
        (position_set_y, pos1, 600),
        (overlay_set_size, reg1, pos1),
        (position_set_x, pos1, 810),
        (position_set_y, pos1, 550),
        (overlay_set_position, reg1, pos1),
        (position_set_x, pos2, 750),
        (position_set_y, pos2, 750),
        (position_set_x, pos3, 900),
        (position_set_y, pos3, 900),
        (str_store_troop_name, s1, "$g_selected_troop"),
        (create_text_overlay, reg1, s1, 16),
        (position_set_x, pos1, 900),
        (position_set_y, pos1, 710),
        (overlay_set_position, reg1, pos1),
        (overlay_set_size, reg1, pos2),
        (store_character_level, reg3, "$g_selected_troop"),
        (assign, ":var19", 35),
        (store_skill_level, ":var20", "skl_ironflesh", "$g_selected_troop"),
        (store_attribute_level, ":var21", "$g_selected_troop", ca_strength),
        (val_mul, ":var20", 2),
        (val_add, ":var19", ":var20"),
        (val_add, ":var19", ":var21"),
        (assign, reg4, ":var19"),
        (create_text_overlay, reg1, "@Level: {reg3}^Health: {reg4}", 4),
        (position_set_x, pos1, 900),
        (position_set_y, pos1, 665),
        (overlay_set_position, reg1, pos1),
        (overlay_set_size, reg1, pos2),
        (create_text_overlay, reg1, "@Attributes", 4),
        (position_set_x, pos1, 900),
        (position_set_y, pos1, 632),
        (overlay_set_position, reg1, pos1),
        (overlay_set_size, reg1, pos3),
        (create_text_overlay, reg1, "@STR^AGI^INT^CHA", 4),
        (position_set_x, pos1, 900),
        (position_set_y, pos1, 570),
        (overlay_set_position, reg1, pos1),
        (overlay_set_size, reg1, pos2),
        (try_for_range, ":var22", 0, 4),
          (try_begin),
            (eq, ":var22", 0),
            (store_attribute_level, reg2, "$g_selected_troop", ":var22"),
            (str_store_string, s1, "@{reg2}"),
          (else_try),
            (store_attribute_level, reg2, "$g_selected_troop", ":var22"),
            (str_store_string, s1, "@{s1}^{reg2}"),
          (try_end),
        (try_end),
        (create_text_overlay, reg1, s1, 8),
        (position_set_x, pos1, 980),
        (position_set_y, pos1, 570),
        (overlay_set_position, reg1, pos1),
        (overlay_set_size, reg1, pos2),
        (create_text_overlay, reg1, "@Skills", 4),
        (position_set_x, pos1, 840),
        (position_set_y, pos1, 535),
        (overlay_set_position, reg1, pos1),
        (overlay_set_size, reg1, pos3),
        (create_text_overlay, reg1, "@Ironflesh^Power Strike^Power Throw^Power Draw^Shield^Athletics^Riding^Horse Archery", 4),
        (position_set_x, pos1, 840),
        (position_set_y, pos1, 415),
        (overlay_set_position, reg1, pos1),
        (overlay_set_size, reg1, pos2),
        (try_for_range_backwards, ":var23", 0, 42),
          (try_begin),
            (eq, ":var23", "skl_ironflesh"),
            (store_skill_level, reg2, ":var23", "$g_selected_troop"),
            (str_store_string, s1, "@{reg2}"),
          (else_try),
            (this_or_next|eq, ":var23", "skl_power_strike"),
            (this_or_next|eq, ":var23", "skl_power_throw"),
            (this_or_next|eq, ":var23", "skl_power_draw"),
            (this_or_next|eq, ":var23", "skl_shield"),
            (this_or_next|eq, ":var23", "skl_athletics"),
            (this_or_next|eq, ":var23", "skl_riding"),
            (eq, ":var23", "skl_horse_archery"),
            (store_skill_level, reg2, ":var23", "$g_selected_troop"),
            (str_store_string, s1, "@{s1}^{reg2}"),
          (try_end),
        (try_end),
        (create_text_overlay, reg1, s1, 8),
        (position_set_x, pos1, 980),
        (position_set_y, pos1, 415),
        (overlay_set_position, reg1, pos1),
        (overlay_set_size, reg1, pos2),
        (create_text_overlay, reg1, "@Proficiencies", 4),
        (position_set_x, pos1, 840),
        (position_set_y, pos1, 378),
        (overlay_set_position, reg1, pos1),
        (overlay_set_size, reg1, pos3),
        (create_text_overlay, reg1, "@1H Weapons^2H Weapons^Polearms^Archery^Crossbows^Throwing^Firearms", 4),
        (position_set_x, pos1, 840),
        (position_set_y, pos1, 272),
        (overlay_set_position, reg1, pos1),
        (overlay_set_size, reg1, pos2),
        (try_for_range, ":var24", 0, 7),
          (try_begin),
            (eq, ":var24", 0),
            (store_proficiency_level, reg2, "$g_selected_troop", ":var24"),
            (str_store_string, s1, "@{reg2}"),
          (else_try),
            (is_between, ":var24", 1, 7),
            (store_proficiency_level, reg2, "$g_selected_troop", ":var24"),
            (str_store_string, s1, "@{s1}^{reg2}"),
          (try_end),
        (try_end),
        (create_text_overlay, reg1, s1, 8),
        (position_set_x, pos1, 980),
        (position_set_y, pos1, 272),
        (overlay_set_position, reg1, pos1),
        (overlay_set_size, reg1, pos2),
        (create_text_overlay, reg1, "@Equipment", 4),
        (position_set_x, pos1, 840),
        (position_set_y, pos1, 235),
        (overlay_set_position, reg1, pos1),
        (overlay_set_size, reg1, pos3),
        (str_clear, s0),
        (create_text_overlay, "$g_presentation_obj_3", s0, 8192),
        (position_set_x, pos1, 840),
        (position_set_y, pos1, 30),
        (overlay_set_position, "$g_presentation_obj_3", pos1),
        (position_set_x, pos1, 138),
        (position_set_y, pos1, 190),
        (overlay_set_area_size, "$g_presentation_obj_3", pos1),
        (945, "$g_presentation_obj_3"),
        (troop_clear_inventory, "trp_temp_array_a"),
        (troop_get_inventory_capacity, ":var25", "$g_selected_troop"),
        (try_for_range, ":var26", 0, ":var25"),
          (troop_get_inventory_slot, ":var27", "$g_selected_troop", ":var26"),
          (gt, ":var27", -1),
          (troop_get_inventory_slot_modifier, ":var28", "$g_selected_troop", ":var26"),
          (troop_add_item, "trp_temp_array_a", ":var27", ":var28"),
        (try_end),
        (assign, ":var29", 0),
        (assign, ":var30", 280),
        (assign, ":var31", 10),
        (try_for_range, ":var32", 0, 65),
          (try_for_range, ":var33", 0, 3),
            (create_mesh_overlay, reg1, "mesh_mp_inventory_choose"),
            (position_set_x, pos1, 320),
            (position_set_y, pos1, 320),
            (overlay_set_size, reg1, pos1),
            (position_set_x, pos1, ":var29"),
            (position_set_y, pos1, ":var30"),
            (overlay_set_position, reg1, pos1),
            (troop_set_slot, "trp_temp_array_a", ":var31", reg1),
            (create_mesh_overlay, reg1, "mesh_inv_slot"),
            (position_set_x, pos1, 400),
            (position_set_y, pos1, 400),
            (overlay_set_size, reg1, pos1),
            (position_set_x, pos1, ":var29"),
            (position_set_y, pos1, ":var30"),
            (overlay_set_position, reg1, pos1),
            (troop_get_inventory_slot, ":var34", "trp_temp_array_a", ":var31"),
            (val_max, ":var34", 0),
            (944, reg1, ":var34"),
            (position_set_x, pos1, 400),
            (position_set_y, pos1, 400),
            (overlay_set_size, reg1, pos1),
            (store_add, ":var35", ":var29", 20),
            (store_add, ":var36", ":var30", 20),
            (position_set_x, pos1, ":var35"),
            (position_set_y, pos1, ":var36"),
            (overlay_set_position, reg1, pos1),
            (troop_set_slot, "trp_temp_array_b", ":var31", reg1),
            (val_add, ":var29", 40),
            (val_add, ":var31", 1),
          (try_end),
          (assign, ":var29", 0),
          (val_sub, ":var30", 40),
        (try_end),
        (945, -1),
      (try_end),
    ]),
    (ti_on_presentation_mouse_enter_leave,
    [
      (store_trigger_param_1, ":var0"),
      (store_trigger_param_2, ":var1"),
      (try_begin),
        (gt, "$g_selected_troop", 0),
        (try_begin),
          (eq, ":var1", 0),
          (try_for_range, ":var2", 10, 106),
            (troop_slot_eq, "trp_temp_array_a", ":var2", ":var0"),
            (troop_get_inventory_slot, ":var3", "trp_temp_array_a", ":var2"),
            (troop_get_inventory_slot_modifier, ":var4", "trp_temp_array_a", ":var2"),
            (try_begin),
              (gt, ":var3", -1),
              (troop_get_slot, ":var5", "trp_temp_array_b", ":var2"),
              (946, 0, ":var5"),
              (972, ":var3", ":var4", 0, 100),
              (assign, "$g_current_opened_item_details", ":var2"),
            (try_end),
          (try_end),
        (else_try),
          (try_for_range, ":var2", 10, 106),
            (troop_slot_eq, "trp_temp_array_a", ":var2", ":var0"),
            (try_begin),
              (eq, "$g_current_opened_item_details", ":var2"),
              (971),
            (try_end),
          (try_end),
        (try_end),
      (try_end),
    ]),
    (ti_on_presentation_event_state_change,
    [
      (store_trigger_param_1, ":var0"),
      (store_trigger_param_2, ":var1"),
      (try_for_range, ":var2", 0, "$g_cur_slot_no"),
        (troop_slot_eq, "trp_stack_selection_amounts", ":var2", ":var0"),
        (troop_get_slot, "$g_selected_troop", "trp_stack_selection_ids", ":var2"),
        (start_presentation, "prsnt_faction_troop_trees"),
      (try_end),
      (try_begin),
        (eq, ":var0", "$g_presentation_obj_1"),
        (store_sub, ":var3", "fac_kingdoms_end", "fac_kingdom_1"),
        (val_add, ":var3", 6),
        (store_sub, "$g_selected_page", ":var3", ":var1"),
        (val_sub, "$g_selected_page", 1),
        (assign, "$g_selected_troop", 0),
        (start_presentation, "prsnt_faction_troop_trees"),
      (else_try),
        (eq, ":var0", "$g_presentation_obj_2"),
        (assign, "$g_selected_troop", 0),
        (assign, "$g_selected_page", 0),
        (presentation_set_duration, 0),
      (try_end),
    ]),
  ]),

  ("fade_from_black", prsntf_read_only, mesh_null,
  [
    (ti_on_presentation_load,
    [
      (2008, 4278190080),
    ]),
    (ti_on_presentation_run,
    [
      (store_trigger_param_1, ":var0"),
      (set_fixed_point_multiplier, 1000),
      (presentation_set_duration, 1000000),
      (try_begin),
        (gt, ":var0", 0),
        (2009, 0, 1100),
      (else_try),
        (gt, ":var0", 3000),
        (presentation_set_duration, 0),
      (try_end),
    ]),
  ]),

  ("troop_ratio_bar", prsntf_read_only, mesh_null,
  [
    (ti_on_presentation_load,
    [
      (presentation_set_duration, 999999),
      (assign, "$presentation_troop_ratio_bar_active", 1),
      (set_fixed_point_multiplier, 1000),
      (create_mesh_overlay, "$g_presentation_obj_1", "mesh_status_troop_ratio_bar"),
      (overlay_set_alpha, "$g_presentation_obj_1", 0x33),
      (position_set_x, pos1, 700),
      (position_set_y, pos1, 700),
      (overlay_set_position, "$g_presentation_obj_1", pos1),
      (position_set_x, pos1, 705),
      (position_set_y, pos1, 713),
      (create_mesh_overlay, "$g_presentation_obj_2", "mesh_white_plane"),
      (overlay_set_color, "$g_presentation_obj_2", 11149087),
      (overlay_set_position, "$g_presentation_obj_2", pos1),
      (create_mesh_overlay, "$g_presentation_obj_3", "mesh_white_plane"),
      (overlay_set_color, "$g_presentation_obj_3", 2039722),
      (overlay_set_position, "$g_presentation_obj_3", pos1),
      (create_mesh_overlay, "$g_presentation_obj_4", "mesh_white_plane"),
      (overlay_set_color, "$g_presentation_obj_4", 2075167),
      (overlay_set_position, "$g_presentation_obj_4", pos1),
      (create_mesh_overlay, "$g_presentation_obj_7", "mesh_status_troop_ratio_bar_button"),
      (create_mesh_overlay, "$g_presentation_obj_8", "mesh_status_troop_ratio_bar_button"),
    ]),
    (ti_on_presentation_run,
    [
      (store_trigger_param_1, ":var0"),
      (set_fixed_point_multiplier, 1000),
      (assign, ":var1", 0),
      (assign, ":var2", 0),
      (assign, ":var3", 0),
      (assign, ":var4", 0),
      (try_begin),
        (neq, "$g_option_ratio_bar_is_global", 1),
        (try_for_agents, ":var5"),
          (agent_is_human, ":var5"),
          (agent_is_alive, ":var5"),
          (agent_get_party_id, ":var6", ":var5"),
          (try_begin),
            (eq, ":var6", "p_main_party"),
            (val_add, ":var1", 1),
          (else_try),
            (agent_is_ally, ":var5"),
            (val_add, ":var2", 1),
          (else_try),
            (val_add, ":var3", 1),
          (try_end),
        (try_end),
      (else_try),
        (eq, "$g_option_ratio_bar_is_global", 1),
        (party_get_template_id, ":var7", "$g_encountered_party"),
        (is_between, ":var7", "pt_steppe_bandit_lair", "pt_bandit_lair_templates_end"),
        (try_for_agents, ":var5"),
          (agent_is_human, ":var5"),
          (agent_is_alive, ":var5"),
          (agent_get_party_id, ":var6", ":var5"),
          (try_begin),
            (eq, ":var6", "p_main_party"),
            (val_add, ":var1", 1),
          (else_try),
            (agent_is_ally, ":var5"),
            (val_add, ":var2", 1),
          (else_try),
            (val_add, ":var3", 1),
          (try_end),
        (try_end),
      (else_try),
        (assign, ":var1", "$player_count_alive"),
        (assign, ":var2", "$ally_count_alive"),
        (assign, ":var3", "$enemy_count_alive"),
      (try_end),
      (val_add, ":var4", ":var1"),
      (val_add, ":var4", ":var2"),
      (val_add, ":var4", ":var3"),
      (position_set_x, pos1, 12000),
      (position_set_y, pos1, 300),
      (overlay_set_size, "$g_presentation_obj_2", pos1),
      (store_add, ":var8", ":var1", ":var2"),
      (val_mul, ":var8", 12000),
      (val_div, ":var8", ":var4"),
      (position_set_x, pos1, ":var8"),
      (position_set_y, pos1, 300),
      (overlay_set_size, "$g_presentation_obj_3", pos1),
      (store_mul, ":var9", ":var1", 12000),
      (val_div, ":var9", ":var4"),
      (position_set_x, pos1, ":var9"),
      (position_set_y, pos1, 300),
      (overlay_set_size, "$g_presentation_obj_4", pos1),
      (store_add, ":var10", ":var1", ":var2"),
      (val_mul, ":var10", 240),
      (val_div, ":var10", ":var4"),
      (val_add, ":var10", 705),
      (position_set_x, pos1, ":var10"),
      (position_set_y, pos1, 700),
      (overlay_set_position, "$g_presentation_obj_7", pos1),
      (store_mul, ":var11", ":var1", 240),
      (val_div, ":var11", ":var4"),
      (val_add, ":var11", 705),
      (position_set_x, pos1, ":var11"),
      (position_set_y, pos1, 700),
      (overlay_set_position, "$g_presentation_obj_8", pos1),
      (try_begin),
        (eq, "$presentation_troop_ratio_bar_active", 1),
        (gt, ":var0", 200),
        (game_key_clicked, 22),
        (assign, "$presentation_troop_ratio_bar_active", 0),
        (presentation_set_duration, 0),
        (start_presentation, "prsnt_battle"),
      (try_end),
    ]),
  ]),

  ("killcount", prsntf_read_only, mesh_null,
  [
    (ti_on_presentation_load,
    [
      (presentation_set_duration, 999999),
      (set_fixed_point_multiplier, 1000),
      (get_player_agent_no, ":var0"),
      (agent_get_horse, ":var1", ":var0"),
      (troop_get_inventory_slot, ":var2", "trp_player", ek_horse),
      (try_begin),
        (ge, ":var2", 0),
        (neg|is_between, "$g_encountered_party", "p_town_1", "p_village_1"),
        (neq, "$g_encountered_party", "p_snake_stronghold"),
        (neq, "$g_encountered_party", "p_castle_noldor"),
        (neg|is_between, "$g_encountered_party_2", "p_town_1", "p_village_1"),
        (neq, "$g_encounter_type", 1),
        (neq, "$g_encounter_type", 2),
        (party_get_template_id, ":var3", "$g_encountered_party"),
        (neg|is_between, ":var3", "pt_steppe_bandit_lair", "pt_bandit_lair_templates_end"),
        (lt, ":var1", 0),
      (else_try),
        (assign, "$killcount_player_horse", ":var1"),
      (try_end),
      (str_store_string, s1, "@0 kills"),
      (create_text_overlay, "$g_presentation_obj_1", s1),
      (overlay_set_color, "$g_presentation_obj_1", 16777215),
      (position_set_x, pos1, 5),
      (position_set_y, pos1, 710),
      (overlay_set_position, "$g_presentation_obj_1", pos1),
      (create_mesh_overlay, "$g_presentation_killcountbg", "mesh_killcount"),
      (position_set_x, pos2, 0),
      (position_set_y, pos2, 768),
      (overlay_set_position, "$g_presentation_killcountbg", pos2),
    ]),
    (ti_on_presentation_run,
    [
      (try_begin),
        (game_key_clicked, 22),
        (presentation_set_duration, 0),
        (start_presentation, "prsnt_battle"),
      (else_try),
        (get_player_agent_no, ":var0"),
        (agent_get_kill_count, reg0, ":var0"),
        (agent_get_kill_count, reg1, ":var0", 1),
        (store_add, reg3, reg0, reg1),
        (try_begin),
          (gt, "$killcount_player_horse", 0),
          (agent_get_kill_count, reg7, "$killcount_player_horse", 1),
          (val_add, reg3, reg7),
          (agent_get_kill_count, reg8, "$killcount_player_horse"),
          (val_add, reg3, reg8),
        (else_try),
          (assign, reg7, 0),
          (assign, reg8, 0),
        (try_end),
        (try_begin),
          (eq, reg3, 1),
          (str_store_string, s1, "@{reg3} kill"),
        (else_try),
          (str_store_string, s1, "@{reg3} kills"),
        (try_end),
        (assign, "$current_killcount", reg0),
        (val_add, "$current_killcount", reg8),
        (assign, "$current_woundcount", reg1),
        (val_add, "$current_woundcount", reg7),
        (overlay_set_text, "$g_presentation_obj_1", s1),
        (assign, reg25, "$killcount_player_horse"),
        (assign, reg26, ":var0"),
      (try_end),
    ]),
  ]),

  ("killcount_and_troop_ratio_bar", prsntf_read_only, mesh_null,
  [
    (ti_on_presentation_load,
    [
      (presentation_set_duration, 999999),
      (set_fixed_point_multiplier, 1000),
      (get_player_agent_no, ":var0"),
      (agent_get_horse, ":var1", ":var0"),
      (troop_get_inventory_slot, ":var2", "trp_player", ek_horse),
      (try_begin),
        (ge, ":var2", 0),
        (neg|is_between, "$g_encountered_party", "p_town_1", "p_village_1"),
        (neq, "$g_encountered_party", "p_snake_stronghold"),
        (neq, "$g_encountered_party", "p_castle_noldor"),
        (neg|is_between, "$g_encountered_party_2", "p_town_1", "p_village_1"),
        (neq, "$g_encounter_type", 1),
        (neq, "$g_encounter_type", 2),
        (party_get_template_id, ":var3", "$g_encountered_party"),
        (neg|is_between, ":var3", "pt_steppe_bandit_lair", "pt_bandit_lair_templates_end"),
        (lt, ":var1", 0),
      (else_try),
        (assign, "$killcount_player_horse", ":var1"),
      (try_end),
      (str_store_string, s1, "@0 kills"),
      (create_text_overlay, "$g_presentation_obj_9", s1),
      (overlay_set_color, "$g_presentation_obj_9", 16777215),
      (position_set_x, pos1, 5),
      (position_set_y, pos1, 710),
      (overlay_set_position, "$g_presentation_obj_9", pos1),
      (create_mesh_overlay, "$g_presentation_killcountbg", "mesh_killcount"),
      (position_set_x, pos2, 0),
      (position_set_y, pos2, 768),
      (overlay_set_position, "$g_presentation_killcountbg", pos2),
      (assign, "$presentation_troop_ratio_bar_active", 1),
      (create_mesh_overlay, "$g_presentation_obj_1", "mesh_status_troop_ratio_bar"),
      (overlay_set_alpha, "$g_presentation_obj_1", 0x33),
      (position_set_x, pos10, 700),
      (position_set_y, pos10, 700),
      (overlay_set_position, "$g_presentation_obj_1", pos10),
      (position_set_x, pos10, 705),
      (position_set_y, pos10, 713),
      (create_mesh_overlay, "$g_presentation_obj_2", "mesh_white_plane"),
      (overlay_set_color, "$g_presentation_obj_2", 11149087),
      (overlay_set_position, "$g_presentation_obj_2", pos10),
      (create_mesh_overlay, "$g_presentation_obj_3", "mesh_white_plane"),
      (overlay_set_color, "$g_presentation_obj_3", 2039722),
      (overlay_set_position, "$g_presentation_obj_3", pos10),
      (create_mesh_overlay, "$g_presentation_obj_4", "mesh_white_plane"),
      (overlay_set_color, "$g_presentation_obj_4", 2075167),
      (overlay_set_position, "$g_presentation_obj_4", pos10),
      (create_mesh_overlay, "$g_presentation_obj_7", "mesh_status_troop_ratio_bar_button"),
      (create_mesh_overlay, "$g_presentation_obj_8", "mesh_status_troop_ratio_bar_button"),
      (call_script, "script_collect_friendly_parties"),
    ]),
    (ti_on_presentation_run,
    [
      (store_trigger_param_1, ":var0"),
      (set_fixed_point_multiplier, 1000),
      (assign, ":var1", 0),
      (assign, ":var2", 0),
      (assign, ":var3", 0),
      (assign, ":var4", 0),
      (try_begin),
        (neq, "$g_option_ratio_bar_is_global", 1),
        (try_for_agents, ":var5"),
          (agent_is_human, ":var5"),
          (agent_is_alive, ":var5"),
          (agent_get_party_id, ":var6", ":var5"),
          (try_begin),
            (eq, ":var6", "p_main_party"),
            (val_add, ":var1", 1),
          (else_try),
            (agent_is_ally, ":var5"),
            (val_add, ":var2", 1),
          (else_try),
            (val_add, ":var3", 1),
          (try_end),
        (try_end),
      (else_try),
        (eq, "$g_option_ratio_bar_is_global", 1),
        (party_get_template_id, ":var7", "$g_encountered_party"),
        (is_between, ":var7", "pt_steppe_bandit_lair", "pt_bandit_lair_templates_end"),
        (try_for_agents, ":var5"),
          (agent_is_human, ":var5"),
          (agent_is_alive, ":var5"),
          (agent_get_party_id, ":var6", ":var5"),
          (try_begin),
            (eq, ":var6", "p_main_party"),
            (val_add, ":var1", 1),
          (else_try),
            (agent_is_ally, ":var5"),
            (val_add, ":var2", 1),
          (else_try),
            (val_add, ":var3", 1),
          (try_end),
        (try_end),
      (else_try),
        (assign, ":var1", "$player_count_alive"),
        (assign, ":var2", "$ally_count_alive"),
        (assign, ":var3", "$enemy_count_alive"),
      (try_end),
      (val_add, ":var4", ":var1"),
      (val_add, ":var4", ":var2"),
      (val_add, ":var4", ":var3"),
      (position_set_x, pos10, 12000),
      (position_set_y, pos10, 300),
      (overlay_set_size, "$g_presentation_obj_2", pos10),
      (store_add, ":var8", ":var1", ":var2"),
      (val_mul, ":var8", 12000),
      (val_div, ":var8", ":var4"),
      (position_set_x, pos10, ":var8"),
      (position_set_y, pos10, 300),
      (overlay_set_size, "$g_presentation_obj_3", pos10),
      (store_mul, ":var9", ":var1", 12000),
      (val_div, ":var9", ":var4"),
      (position_set_x, pos10, ":var9"),
      (position_set_y, pos10, 300),
      (overlay_set_size, "$g_presentation_obj_4", pos10),
      (store_add, ":var10", ":var1", ":var2"),
      (val_mul, ":var10", 240),
      (val_div, ":var10", ":var4"),
      (val_add, ":var10", 705),
      (position_set_x, pos10, ":var10"),
      (position_set_y, pos10, 700),
      (overlay_set_position, "$g_presentation_obj_7", pos10),
      (store_mul, ":var11", ":var1", 240),
      (val_div, ":var11", ":var4"),
      (val_add, ":var11", 705),
      (position_set_x, pos10, ":var11"),
      (position_set_y, pos10, 700),
      (overlay_set_position, "$g_presentation_obj_8", pos10),
      (try_begin),
        (eq, "$presentation_troop_ratio_bar_active", 1),
        (gt, ":var0", 200),
        (game_key_clicked, 22),
        (assign, "$presentation_troop_ratio_bar_active", 0),
        (presentation_set_duration, 0),
        (start_presentation, "prsnt_battle"),
      (else_try),
        (get_player_agent_no, ":var12"),
        (agent_get_kill_count, reg0, ":var12"),
        (agent_get_kill_count, reg1, ":var12", 1),
        (store_add, reg3, reg0, reg1),
        (try_begin),
          (gt, "$killcount_player_horse", 0),
          (agent_get_kill_count, reg7, "$killcount_player_horse", 1),
          (val_add, reg3, reg7),
          (agent_get_kill_count, reg8, "$killcount_player_horse"),
          (val_add, reg3, reg8),
        (else_try),
          (assign, reg7, 0),
          (assign, reg8, 0),
        (try_end),
        (try_begin),
          (eq, reg3, 1),
          (str_store_string, s1, "@{reg3} kill"),
        (else_try),
          (str_store_string, s1, "@{reg3} kills"),
        (try_end),
        (assign, "$current_killcount", reg0),
        (val_add, "$current_killcount", reg8),
        (assign, "$current_woundcount", reg1),
        (val_add, "$current_woundcount", reg7),
        (overlay_set_text, "$g_presentation_obj_9", s1),
        (assign, reg25, "$killcount_player_horse"),
        (assign, reg26, ":var12"),
      (try_end),
    ]),
  ]),
#COOP BEGIN #########################################
  ] + coop_presentations 
#COOP END############################################]
